!function(e){"use strict";var a=function(){return null};function i(e,n,r,t,i,o){this.descriptor=e,this.byteCount=n,this.encode=t,this.decode=i,this.empty=r,this.fullMask=o||a,this.isBasic=!1}var f={},l=function(e,n){return 0!=(e[Math.floor(n/8)]&1<<n%8)},o=function(){return 0},s=function(e){for(var n=[],r=0;r<e;++r)n.push(0);return n},n=function(e,r,t){var n=new i(e,t,o,function(e,n){e.dataView["set"+r](e.index,n,1),e.add(t)},function(e){var n=e.dataView["get"+r](e.index,1);return e.add(t),n});return n.isBasic=!0,n};f.u8=n("u8","Uint8",1),f.u16=n("u16","Uint16",2),f.u32=n("u32","Uint32",4),f.i8=n("i8","Int8",1),f.i16=n("i16","Int16",2),f.i32=n("i32","Int32",4),f.f32=n("f32","Float32",4),f.f64=n("f64","Float64",8),f.bool=new i("bool",f.u8.byteCount,function(){return!1},function(e,n){f.u8.encode(e,n?1:0)},function(e){return 0!==f.u8.decode(e)}),f.bool.isBasic=!0,f.void=new i("void",0,function(){return!0},function(e,n){},function(){return!0}),f.void.isBasic=!0;f.string=function(o){var a=f.arrayUnmasked(o,f.u8);return new i("s"+o,o,function(){return""},function(e,n){var r,t,i;a.encode(e,(r=n,t=o,i=new Uint8Array(t),r.split("").forEach(function(e,n){i[n]=e.charCodeAt(0)}),i[t-1]=0,i))},function(e){return function(e,n){for(var r="",t=Math.min(e.length,n-1),i=0;i<t;++i){if(0===e[i])return r;r+=String.fromCharCode(e[i])}return r}(a.decode(e),o)})},f.s=new i("s",0,function(){return""},function(e,n){for(var r=Math.min(n.length,e.dataView.byteLength-e.index),t=0;t<r;++t)f.u8.encode(e,n.charCodeAt(t));e.index<e.dataView.byteLength&&f.u8.encode(e,0)},function(e){for(var n="",r=e.dataView.byteLength-e.index;0<r--;){var t=f.u8.decode(e);if(!t)return n;n+=String.fromCharCode(t)}return n}),f.s.isBasic=!0,f.arrayUnmasked=function(e,n){for(var r=[],t=0;t<e;++t)r.push(n);var i=f.tupleUnmasked(r);return i.descriptor="["+n.descriptor+":"+e+"]",i},f.tupleUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.byteCount},0);return new i("("+e.map(function(e){return e.descriptor}).join(",")+")",n,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null),e.forEach(function(e,n){e.encode(r,t[n],i&&i[n])})},function(n){return e.map(function(e){return e.decode(n)})},function(){var t=!1,i={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t=!0,i[n]=r)}),t?i:null})},f.arrayMasked=function(e,n,r){for(var t=[],i=0;i<e;++i)t.push(n);var o=f.tupleMasked(t,r),a=8*(o.byteCount-e*n.byteCount);return o.descriptor="[/"+a+"/"+n.descriptor+":"+e+"]",o},f.tupleMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=f.arrayUnmasked(u,f.u8),r=e.reduce(function(e,n){return e+n.byteCount},u),t=e.map(function(e){return e.descriptor});return new i("(/"+8*u+"/"+t.join(",")+")",r,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null);var o=s(u),a=null;i&&"MASK"in i&&(a=i.MASK),e.forEach(function(e,n){var r=t[n];a&&!a[n]||null!=r&&(o[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,o),e.forEach(function(e,n){l(o,n)&&e.encode(r,t[n],i&&i[n])})},function(r){var t=c.decode(r);return e.map(function(e,n){return l(t,n)?e.decode(r):null})},function(){var t={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t[n]=r)}),t.MASK=e.map(function(){return!0}),t})},f.mapUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.handler.byteCount},0);return new i("{"+e.map(function(e){return e.key+":"+e.handler.descriptor}).join(",")+"}",n,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(n,r,t){!0===t&&(t=null),e.forEach(function(e){e.handler.encode(n,r[e.key],t&&t[e.key])})},function(n){var r={};return e.forEach(function(e){r[e.key]=e.handler.decode(n)}),r},function(){var r=!1,t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r=!0,t[e.key]=n)}),r?t:null})},f.mapMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=f.arrayUnmasked(u,f.u8),r=e.reduce(function(e,n){return e+n.handler.byteCount},u),t=e.map(function(e){return e.key+":"+e.handler.descriptor});return new i("{/"+8*u+"/"+t.join(",")+"}",r,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(r,t,i){!0===i&&(i=null);var o=s(u),a=null;i&&"MASK"in i&&(a=i.MASK),e.forEach(function(e,n){var r=t[e.key];a&&!a[e.key]||null!=r&&(o[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,o),e.forEach(function(e,n){l(o,n)&&e.handler.encode(r,t[e.key],i&&i[e.key])})},function(r){var t=c.decode(r),i={};return e.forEach(function(e,n){l(t,n)?i[e.key]=e.handler.decode(r):i[e.key]=null}),i},function(){var r={},t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r[e.key]=n),t[e.key]=!0}),r.MASK=t,r})},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization._handlers=f}(this),function(u){"use strict";function o(e,n){this.position=e,this.value=n}var c=/^\d+$/,n=/^\w+$/,a={SYMBOL:0,NUMBER:1,NAME:2};function r(e){this.position=e.position,this.value=e.value,c.test(this.value)?(this.category=a.NUMBER,this.value=parseInt(this.value)):n.test(this.value)?this.category=a.NAME:this.category=a.SYMBOL}var f=/^[{}\[\]()\/=:,;\w\s]*$/,t=function(e){if(n=e,!f.test(n))throw new Error("Passed config contains invalid characters");for(var n,r,t=/([{}\[\]()\/=:,;]|\w+)/g,i=[];null!==(r=t.exec(e));)i.push(new o(r.index,r[0]));return i},i=function(e){return e.map(function(e){return new r(e)})},l={NAMED:0,MAP_UNMASKED:2,MAP_MASKED:3,TUPLE_UNMASKED:4,TUPLE_MASKED:5,ARRAY_UNMASKED:6,ARRAY_MASKED:7};function s(e,n,r){this.category=e,this.properties=n,this.mask=r||0}s.prototype.generateHandler=function(n){var e,r=u.FlybrixSerialization._handlers,t=this.properties,i=this.mask,o=null;switch(this.category){case l.NAMED:if(t in r)(o=r[t]).isBasic||(o=null);else if("s"===t[0]){var a=t.substring(1);c.test(a)&&(o=r.string(parseInt(a)))}else t in n&&(o=n[t]);if(!o)throw{position:-1,error:'Unrecognized type "'+t+'"'};return o;case l.MAP_UNMASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapUnmasked(e);case l.MAP_MASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapMasked(e,i);case l.TUPLE_UNMASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleUnmasked(e);case l.TUPLE_MASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleMasked(e,i);case l.ARRAY_UNMASKED:return r.arrayUnmasked(t.count,t.value.generateHandler(n));case l.ARRAY_MASKED:return r.arrayMasked(t.count,t.value.generateHandler(n),i);default:throw{position:-1,error:"Unrecognized type category"}}};var d=function(e){var n=e.dataView[e.index];if(e.add(1),!n)throw{position:-1,error:"Unexpected end of string"};return n},h=function(e){var n=d(e);if(n.category!==a.NAME)throw{position:n.position,error:'Expected name, got: "'+n.value+'"'};if("MASK"===n.value)throw{position:n.position,error:'Disallowed name "MASK" given'};return n.value},p=function(e,n){var r=d(e);if(r.value!==n)throw{position:r.position,error:'Expected "'+n+'", got: "'+r.value+'"'}},v=function(e){var n=d(e);if("/"!==n.value)return e.add(-1),{masked:!1};if("/"===(n=d(e)).value)return{masked:!0,defined:!1};if(n.category!==a.NUMBER)throw{position:n.position,error:'Expected "/" or number'};var r=n.value;if("/"!==(n=d(e)).value)throw{position:n.position,error:'Expected "/"'};return{masked:!0,defined:!0,value:r}},y=function(e){var n=v(e),r=M(e);p(e,":");var t=function(e){var n=d(e);if(n.category!==a.NUMBER)throw{position:n.position,error:'Expected number, got: "'+n.value+'"'};return n.value}(e);p(e,"]");var i={value:r,count:t};return n.masked?n.defined?new s(l.ARRAY_MASKED,i,n.value):new s(l.ARRAY_MASKED,i):new s(l.ARRAY_UNMASKED,i)},M=function(e){var n=d(e);if(!n)throw{position:-1,error:"Unexpected end of string"};if(n.category===a.NUMBER)throw{position:n.position,error:"Unexpected number, type expected"};if(n.category===a.NAME)return new s(l.NAMED,n.value);if("{"===n.value)return function(e){for(var n=v(e),r=[];;){var t=h(e);p(e,":");var i=M(e);r.push({name:t,value:i});var o=d(e);if("}"===o.value)return n.masked?n.defined?new s(l.MAP_MASKED,r,n.value):new s(l.MAP_MASKED,r):new s(l.MAP_UNMASKED,r);if(","!==o.value)throw{position:o.position,error:'Unexpected token after map element: "'+o.value+'"'}}}(e);if("["===n.value)return y(e);if("("===n.value)return function(e){for(var n=v(e),r=[];;){r.push(M(e));var t=d(e);if(")"===t.value)return n.masked?n.defined?new s(l.TUPLE_MASKED,r,n.value):new s(l.TUPLE_MASKED,r):new s(l.TUPLE_UNMASKED,r);if(","!==t.value)throw{position:t.position,error:'Unexpected token after tuple element: "'+t.value+'"'}}}(e);throw{position:n.position,error:'Unexpected token when describing type: "'+n.value+'"'}},E=function(e,n){for(var r=new u.FlybrixSerialization.Serializer(e),t=[];r.index<r.dataView.length;){var i=h(r);if(i[0]!==i[0].toUpperCase())throw{position:-1,error:"Structure names cannot start with lowercase letters"};p(r,"=");var o=M(r);p(r,";"),t.push({name:i,value:o})}return t};u.FlybrixSerialization||(u.FlybrixSerialization={}),u.FlybrixSerialization._parserSteps={tokenizer:t,lexer:i,parser:E,TokenCategories:a,TypeCategories:l,StringToken:o,Token:r,Type:s},u.FlybrixSerialization.parse=function(e){try{return n=E(i(t(e))),r={},n.forEach(function(e){r[e.name]=e.value.generateHandler(r)}),r}catch(e){throw new Error(e.error)}var n,r}}(this),function(e){"use strict";function n(e){this.index=0,this.dataView=e}n.prototype.add=function(e){this.index+=e},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization.Serializer=n}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwicGFyc2VyLmpzIiwic2VyaWFsaXplci5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJudWxsTWFzayIsIkhhbmRsZXIiLCJkZXNjcmlwdG9yIiwiYnl0ZUNvdW50IiwiZW1wdHkiLCJlbmNvZGUiLCJkZWNvZGUiLCJmdWxsTWFzayIsInRoaXMiLCJpc0Jhc2ljIiwiaGFuZGxlcnMiLCJoYXNCaXQiLCJtYXNrIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZW1wdHlOdW1lcmljIiwiemVyb0FycmF5IiwibCIsInJlc3VsdCIsInB1c2giLCJjcmVhdGVOdW1lcmljVHlwZSIsImtleVNob3J0Iiwia2V5IiwiaGFuZGxlciIsInNlcmlhbGl6ZXIiLCJkYXRhIiwiZGF0YVZpZXciLCJpbmRleCIsImFkZCIsInU4IiwidTE2IiwidTMyIiwiaTgiLCJpMTYiLCJpMzIiLCJmMzIiLCJmNjQiLCJib29sIiwidm9pZCIsInN0cmluZyIsImxlbmd0aCIsImFycmF5VW5tYXNrZWQiLCJuYW1lIiwicmVzcG9uc2UiLCJVaW50OEFycmF5Iiwic3BsaXQiLCJmb3JFYWNoIiwiYyIsImNoYXJDb2RlQXQiLCJtaW4iLCJpIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiYXNjaWlEZWNvZGUiLCJzIiwiYnl0ZUxlbmd0aCIsImNoYXJDb2RlIiwiY2hpbGRyZW4iLCJ0dXBsZVVubWFza2VkIiwicmVkdWNlIiwiYWNjdW0iLCJjaGlsZCIsIm1hcCIsImpvaW4iLCJtYXNrcyIsIm5vbk51bGxDaGlsZCIsInZhbHVlIiwiYXJyYXlNYXNrZWQiLCJtYXNrQml0Q291bnQiLCJ0dXBsZU1hc2tlZCIsIm1hc2tTaXplIiwibWFza0J5dGVzIiwiY2VpbCIsIm1heCIsIm1hc2tIYW5kbGVyIiwiY2hpbGREZXNjcmlwdG9ycyIsImV4dHJhTWFzayIsIk1BU0siLCJfIiwibWFwVW5tYXNrZWQiLCJtYXBNYXNrZWQiLCJGbHlicml4U2VyaWFsaXphdGlvbiIsIl9oYW5kbGVycyIsIlN0cmluZ1Rva2VuIiwicG9zaXRpb24iLCJudW1lcmljVGVzdCIsIm5hbWVUZXN0IiwiVG9rZW5DYXRlZ29yaWVzIiwiU1lNQk9MIiwiTlVNQkVSIiwiTkFNRSIsIlRva2VuIiwic3RyaW5nVG9rZW4iLCJ0ZXN0IiwiY2F0ZWdvcnkiLCJwYXJzZUludCIsInZhbGlkQ2hhclNldFRlc3QiLCJ0b2tlbml6ZXIiLCJ0ZXh0IiwiRXJyb3IiLCJtYXRjaCIsInJlIiwibWF0Y2hlcyIsImV4ZWMiLCJsZXhlciIsInRva2VucyIsInRva2VuIiwiVHlwZUNhdGVnb3JpZXMiLCJOQU1FRCIsIk1BUF9VTk1BU0tFRCIsIk1BUF9NQVNLRUQiLCJUVVBMRV9VTk1BU0tFRCIsIlRVUExFX01BU0tFRCIsIkFSUkFZX1VOTUFTS0VEIiwiQVJSQVlfTUFTS0VEIiwiVHlwZSIsInByb3BlcnRpZXMiLCJwcm90b3R5cGUiLCJnZW5lcmF0ZUhhbmRsZXIiLCJsaWJyYXJ5IiwicHJvcHMiLCJzdWJzdHJpbmciLCJlcnJvciIsImNvdW50IiwicmVhZFRva2VuIiwibmFtZVBhcnNlciIsImNvbnN1bWVTeW1ib2wiLCJzeW1ib2wiLCJtYXNrUGFyc2VyIiwibWFza2VkIiwiZGVmaW5lZCIsInR5cGVBcnJheVBhcnNlciIsInR5cGVQYXJzZXIiLCJudW1iZXJQYXJzZXIiLCJ0eXBlTWFwUGFyc2VyIiwidHlwZVR1cGxlUGFyc2VyIiwicGFyc2VyIiwic291cmNlIiwiU2VyaWFsaXplciIsInN0cnVjdHVyZXMiLCJ0b1VwcGVyQ2FzZSIsIl9wYXJzZXJTdGVwcyIsInBhcnNlIiwic3RydWN0dXJlIiwiZW50cnkiLCJlcnIiLCJpbmNyZW1lbnQiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEdBQ0EsYUFFQSxJQUFBQyxFQUFBLFdBQ0EsT0FBQSxNQUdBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLEtBQUFOLFdBQUFBLEVBQ0FNLEtBQUFMLFVBQUFBLEVBQ0FLLEtBQUFILE9BQUFBLEVBQ0FH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Q0F6QixFQUFBeUIsRUFBQXRHLE1BQUFzRyxFQUFBOUUsTUFBQW9ELGdCQUFBQyxLQUVBQSxFQU1BLE1BQUEwQixHQUNBLE1BQUEsSUFBQTlDLE1BQUE4QyxFQUFBdkIsT0FaQSxJQUFBcUIsRUFDQXhCLEdBL1dBLENBK1lBaEgsTUMvWUEsU0FBQVQsR0FDQSxhQUVBLFNBQUE0SSxFQUFBaEgsR0FDQW5CLEtBQUFvQixNQUFBLEVBQ0FwQixLQUFBbUIsU0FBQUEsRUFHQWdILEVBQUFyQixVQUFBekYsSUFBQSxTQUFBc0gsR0FDQTNJLEtBQUFvQixPQUFBdUgsR0FHQXBKLEVBQUFtRix1QkFDQW5GLEVBQUFtRixxQkFBQSxJQUVBbkYsRUFBQW1GLHFCQUFBeUQsV0FBQUEsRUFmQSxDQWlCQW5JIiwiZmlsZSI6ImZseWJyaXgtc2VyaWFsaXphdGlvbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBudWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spIHtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0b3IgPSBkZXNjcmlwdG9yO1xyXG4gICAgICAgIHRoaXMuYnl0ZUNvdW50ID0gYnl0ZUNvdW50O1xyXG4gICAgICAgIHRoaXMuZW5jb2RlID0gZW5jb2RlO1xyXG4gICAgICAgIHRoaXMuZGVjb2RlID0gZGVjb2RlO1xyXG4gICAgICAgIHRoaXMuZW1wdHkgPSBlbXB0eTtcclxuICAgICAgICB0aGlzLmZ1bGxNYXNrID0gZnVsbE1hc2sgfHwgbnVsbE1hc2s7XHJcbiAgICAgICAgdGhpcy5pc0Jhc2ljID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGhhbmRsZXJzID0ge307XHJcblxyXG4gICAgdmFyIGhhc0JpdCA9IGZ1bmN0aW9uIChtYXNrLCBpZHgpIHtcclxuICAgICAgICByZXR1cm4gKG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gJiAoMSA8PCAoaWR4ICUgOCkpKSAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGVtcHR5TnVtZXJpYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHplcm9BcnJheSA9IGZ1bmN0aW9uIChsKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGw7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlTnVtZXJpY1R5cGUgPSBmdW5jdGlvbiAoa2V5U2hvcnQsIGtleSwgYnl0ZUNvdW50KSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ3NldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIGRhdGEsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ2dldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBIYW5kbGVyKGtleVNob3J0LCBieXRlQ291bnQsIGVtcHR5TnVtZXJpYywgZW5jb2RlLCBkZWNvZGUpO1xyXG5cclxuICAgICAgICBoYW5kbGVyLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudTggPSBjcmVhdGVOdW1lcmljVHlwZSgndTgnLCAnVWludDgnLCAxKTtcclxuICAgIGhhbmRsZXJzLnUxNiA9IGNyZWF0ZU51bWVyaWNUeXBlKCd1MTYnLCAnVWludDE2JywgMik7XHJcbiAgICBoYW5kbGVycy51MzIgPSBjcmVhdGVOdW1lcmljVHlwZSgndTMyJywgJ1VpbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuaTggPSBjcmVhdGVOdW1lcmljVHlwZSgnaTgnLCAnSW50OCcsIDEpO1xyXG4gICAgaGFuZGxlcnMuaTE2ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kxNicsICdJbnQxNicsIDIpO1xyXG4gICAgaGFuZGxlcnMuaTMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kzMicsICdJbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuZjMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2YzMicsICdGbG9hdDMyJywgNCk7XHJcbiAgICBoYW5kbGVycy5mNjQgPSBjcmVhdGVOdW1lcmljVHlwZSgnZjY0JywgJ0Zsb2F0NjQnLCA4KTtcclxuXHJcbiAgICBoYW5kbGVycy5ib29sID0gbmV3IEhhbmRsZXIoXHJcbiAgICAgICAgJ2Jvb2wnLFxyXG4gICAgICAgIGhhbmRsZXJzLnU4LmJ5dGVDb3VudCxcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCBkYXRhID8gMSA6IDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKSAhPT0gMDtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLmJvb2wuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgaGFuZGxlcnMudm9pZCA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICd2b2lkJyxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLnZvaWQuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgdmFyIGFzY2lpRW5jb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XHJcbiAgICAgICAgbmFtZS5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbiAoYywgaWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3BvbnNlW2lkeF0gPSBjLmNoYXJDb2RlQXQoMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVzcG9uc2VbbGVuZ3RoIC0gMV0gPSAwO1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGFzY2lpRGVjb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9ICcnO1xyXG4gICAgICAgIHZhciBsID0gTWF0aC5taW4obmFtZS5sZW5ndGgsIGxlbmd0aCAtIDEpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChuYW1lW2ldID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzcG9uc2UgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShuYW1lW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5zdHJpbmcgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKGxlbmd0aCwgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICBoYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBhc2NpaUVuY29kZShkYXRhLCBsZW5ndGgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICByZXR1cm4gYXNjaWlEZWNvZGUoaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplciksIGxlbmd0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcigncycgKyBsZW5ndGgsIGxlbmd0aCwgZW1wdHksIGVuY29kZSwgZGVjb2RlKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMucyA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICdzJyxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGVDb3VudCA9IE1hdGgubWluKGRhdGEubGVuZ3RoLCBzZXJpYWxpemVyLmRhdGFWaWV3LmJ5dGVMZW5ndGggLSBzZXJpYWxpemVyLmluZGV4KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgYnl0ZUNvdW50OyArK2lkeCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcnMudTguZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGEuY2hhckNvZGVBdChpZHgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VyaWFsaXplci5pbmRleCA8IHNlcmlhbGl6ZXIuZGF0YVZpZXcuYnl0ZUxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcnMudTguZW5jb2RlKHNlcmlhbGl6ZXIsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSAnJztcclxuICAgICAgICAgICAgdmFyIGJ5dGVDb3VudCA9IHNlcmlhbGl6ZXIuZGF0YVZpZXcuYnl0ZUxlbmd0aCAtIHNlcmlhbGl6ZXIuaW5kZXg7XHJcbiAgICAgICAgICAgIHdoaWxlIChieXRlQ291bnQtLSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFyQ29kZSA9IGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIGlmICghY2hhckNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJDb2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICBoYW5kbGVycy5zLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgIGhhbmRsZXJzLmFycmF5VW5tYXNrZWQgPSBmdW5jdGlvbiAobGVuZ3RoLCBoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyArK2lkeCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVzdWx0ID0gaGFuZGxlcnMudHVwbGVVbm1hc2tlZChjaGlsZHJlbik7XHJcbiAgICAgICAgcmVzdWx0LmRlc2NyaXB0b3IgPSAnWycgKyBoYW5kbGVyLmRlc2NyaXB0b3IgKyAnOicgKyBsZW5ndGggKyAnXSc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudHVwbGVVbm1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbaWR4XSwgbWFza3MgJiYgbWFza3NbaWR4XSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG5vbk51bGxDaGlsZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBub25OdWxsQ2hpbGQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIW5vbk51bGxDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJygnICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnKSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLmFycmF5TWFza2VkID0gZnVuY3Rpb24gKGxlbmd0aCwgaGFuZGxlciwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyArK2lkeCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVzdWx0ID0gaGFuZGxlcnMudHVwbGVNYXNrZWQoY2hpbGRyZW4sIG1hc2tCaXRDb3VudCk7XHJcbiAgICAgICAgdmFyIG1hc2tTaXplID0gKHJlc3VsdC5ieXRlQ291bnQgLSAobGVuZ3RoICogaGFuZGxlci5ieXRlQ291bnQpKSAqIDg7XHJcbiAgICAgICAgcmVzdWx0LmRlc2NyaXB0b3IgPSAnWy8nICsgbWFza1NpemUgKyAnLycgKyBoYW5kbGVyLmRlc2NyaXB0b3IgKyAnOicgKyBsZW5ndGggKyAnXSc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudHVwbGVNYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4sIG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgIHZhciBtYXNrQnl0ZXMgPSBNYXRoLmNlaWwoY2hpbGRyZW4ubGVuZ3RoIC8gOCk7XHJcbiAgICAgICAgaWYgKG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgICAgICBtYXNrQnl0ZXMgPSBNYXRoLm1heChtYXNrQnl0ZXMsIE1hdGguY2VpbChtYXNrQml0Q291bnQgLyA4KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXNrSGFuZGxlciA9IGhhbmRsZXJzLmFycmF5VW5tYXNrZWQobWFza0J5dGVzLCBoYW5kbGVycy51OCk7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbWFzayA9IHplcm9BcnJheShtYXNrQnl0ZXMpO1xyXG4gICAgICAgICAgICB2YXIgZXh0cmFNYXNrID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKG1hc2tzICYmICgnTUFTSycgaW4gbWFza3MpKSB7XHJcbiAgICAgICAgICAgICAgICBleHRyYU1hc2sgPSBtYXNrcy5NQVNLO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKF8sIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtpZHhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4dHJhTWFzayAmJiAhZXh0cmFNYXNrW2lkeF0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gfD0gMSA8PCAoaWR4ICUgOCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbWFza0hhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIG1hc2spO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQml0KG1hc2ssIGlkeCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtpZHhdLCBtYXNrcyAmJiBtYXNrc1tpZHhdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIG1hc2sgPSBtYXNrSGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXN1bHQuTUFTSyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gY2hpbGRyZW4ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY2hpbGQuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIG1hc2tCeXRlcyk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJygvJyArIChtYXNrQnl0ZXMgKiA4KSArICcvJyArIGNoaWxkRGVzY3JpcHRvcnMuam9pbignLCcpICsgJyknO1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5tYXBVbm1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmhhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbY2hpbGQua2V5XSwgbWFza3MgJiYgbWFza3NbY2hpbGQua2V5XSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBub25OdWxsQ2hpbGQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuaGFuZGxlci5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9uTnVsbENoaWxkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKCFub25OdWxsQ2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gY2hpbGRyZW4ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY2hpbGQuaGFuZGxlci5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5rZXkgKyAnOicgKyBjaGlsZC5oYW5kbGVyLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAneycgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICd9JztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMubWFwTWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuLCBtYXNrQml0Q291bnQpIHtcclxuICAgICAgICB2YXIgbWFza0J5dGVzID0gTWF0aC5jZWlsKGNoaWxkcmVuLmxlbmd0aCAvIDgpO1xyXG4gICAgICAgIGlmIChtYXNrQml0Q291bnQpIHtcclxuICAgICAgICAgICAgbWFza0J5dGVzID0gTWF0aC5tYXgobWFza0J5dGVzLCBNYXRoLmNlaWwobWFza0JpdENvdW50IC8gOCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWFza0hhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKG1hc2tCeXRlcywgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1hc2sgPSB6ZXJvQXJyYXkobWFza0J5dGVzKTtcclxuICAgICAgICAgICAgdmFyIGV4dHJhTWFzayA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyAmJiAoJ01BU0snIGluIG1hc2tzKSkge1xyXG4gICAgICAgICAgICAgICAgZXh0cmFNYXNrID0gbWFza3MuTUFTSztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtjaGlsZC5rZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4dHJhTWFzayAmJiAhZXh0cmFNYXNrW2NoaWxkLmtleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gfD0gMSA8PCAoaWR4ICUgOCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbWFza0hhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIG1hc2spO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQml0KG1hc2ssIGlkeCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5oYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2NoaWxkLmtleV0sIG1hc2tzICYmIG1hc2tzW2NoaWxkLmtleV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IG1hc2tIYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQml0KG1hc2ssIGlkeCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgdmFyIG1hc2sgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmhhbmRsZXIuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtYXNrW2NoaWxkLmtleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzdWx0Lk1BU0sgPSBtYXNrO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmhhbmRsZXIuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIG1hc2tCeXRlcyk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5rZXkgKyAnOicgKyBjaGlsZC5oYW5kbGVyLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAney8nICsgKG1hc2tCeXRlcyAqIDgpICsgJy8nICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnfSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uX2hhbmRsZXJzID0gaGFuZGxlcnM7XHJcblxyXG59KHRoaXMpKTtcclxuIiwiKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBmdW5jdGlvbiBTdHJpbmdUb2tlbihwb3NpdGlvbiwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBudW1lcmljVGVzdCA9IC9eXFxkKyQvO1xyXG4gICAgdmFyIG5hbWVUZXN0ID0gL15cXHcrJC87XHJcblxyXG4gICAgdmFyIFRva2VuQ2F0ZWdvcmllcyA9IHtcclxuICAgICAgICBTWU1CT0w6IDAsXHJcbiAgICAgICAgTlVNQkVSOiAxLFxyXG4gICAgICAgIE5BTUU6IDIsXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFRva2VuKHN0cmluZ1Rva2VuKSB7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHN0cmluZ1Rva2VuLnBvc2l0aW9uO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSBzdHJpbmdUb2tlbi52YWx1ZTtcclxuICAgICAgICBpZiAobnVtZXJpY1Rlc3QudGVzdCh0aGlzLnZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUjtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHBhcnNlSW50KHRoaXMudmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmFtZVRlc3QudGVzdCh0aGlzLnZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLk5BTUU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IFRva2VuQ2F0ZWdvcmllcy5TWU1CT0w7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciB2YWxpZENoYXJTZXRUZXN0ID0gL15be31cXFtcXF0oKVxcLz06LDtcXHdcXHNdKiQvO1xyXG5cclxuICAgIHZhciBpc1ZhbGlkID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICByZXR1cm4gdmFsaWRDaGFyU2V0VGVzdC50ZXN0KHRleHQpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdG9rZW5pemVyID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICBpZiAoIWlzVmFsaWQodGV4dCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXNzZWQgY29uZmlnIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmUgPSAvKFt7fVxcW1xcXSgpXFwvPTosO118XFx3KykvZztcclxuICAgICAgICB2YXIgbWF0Y2g7XHJcbiAgICAgICAgdmFyIG1hdGNoZXMgPSBbXTtcclxuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmUuZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKG5ldyBTdHJpbmdUb2tlbihtYXRjaC5pbmRleCwgbWF0Y2hbMF0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoZXM7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBsZXhlciA9IGZ1bmN0aW9uICh0b2tlbnMpIHtcclxuICAgICAgICByZXR1cm4gdG9rZW5zLm1hcChmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUb2tlbih0b2tlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBUeXBlQ2F0ZWdvcmllcyA9IHtcclxuICAgICAgICBOQU1FRDogMCxcclxuICAgICAgICBNQVBfVU5NQVNLRUQ6IDIsXHJcbiAgICAgICAgTUFQX01BU0tFRDogMyxcclxuICAgICAgICBUVVBMRV9VTk1BU0tFRDogNCxcclxuICAgICAgICBUVVBMRV9NQVNLRUQ6IDUsXHJcbiAgICAgICAgQVJSQVlfVU5NQVNLRUQ6IDYsXHJcbiAgICAgICAgQVJSQVlfTUFTS0VEOiA3LFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBUeXBlKGNhdGVnb3J5LCBwcm9wZXJ0aWVzLCBtYXNrKSB7XHJcbiAgICAgICAgdGhpcy5jYXRlZ29yeSA9IGNhdGVnb3J5O1xyXG4gICAgICAgIHRoaXMucHJvcGVydGllcyA9IHByb3BlcnRpZXM7XHJcbiAgICAgICAgdGhpcy5tYXNrID0gbWFzayB8fCAwO1xyXG4gICAgfVxyXG5cclxuICAgIFR5cGUucHJvdG90eXBlLmdlbmVyYXRlSGFuZGxlciA9IGZ1bmN0aW9uIChsaWJyYXJ5KSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLl9oYW5kbGVycztcclxuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BlcnRpZXM7XHJcbiAgICAgICAgdmFyIG1hc2sgPSB0aGlzLm1hc2s7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbjtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuY2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5OQU1FRDpcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wcyBpbiBoYW5kbGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBoYW5kbGVyc1twcm9wc107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYW5kbGVyLmlzQmFzaWMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wc1swXSA9PT0gJ3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHByb3BzLnN1YnN0cmluZygxKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVtZXJpY1Rlc3QudGVzdChsZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBoYW5kbGVycy5zdHJpbmcocGFyc2VJbnQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wcyBpbiBsaWJyYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGxpYnJhcnlbcHJvcHNdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFoYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5yZWNvZ25pemVkIHR5cGUgXCInICsgcHJvcHMgKyAnXCInLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5NQVBfVU5NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IGNoaWxkLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXI6IGNoaWxkLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMubWFwVW5tYXNrZWQoY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk1BUF9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IGNoaWxkLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXI6IGNoaWxkLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMubWFwTWFza2VkKGNoaWxkcmVuLCBtYXNrKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5UVVBMRV9VTk1BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy50dXBsZVVubWFza2VkKGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5UVVBMRV9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMudHVwbGVNYXNrZWQoY2hpbGRyZW4sIG1hc2spO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLkFSUkFZX1VOTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLmFycmF5VW5tYXNrZWQocHJvcHMuY291bnQsIHByb3BzLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSk7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuQVJSQVlfTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLmFycmF5TWFza2VkKHByb3BzLmNvdW50LCBwcm9wcy52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSksIG1hc2spO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VucmVjb2duaXplZCB0eXBlIGNhdGVnb3J5JyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcmVhZFRva2VuID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSBzZXJpYWxpemVyLmRhdGFWaWV3W3NlcmlhbGl6ZXIuaW5kZXhdO1xyXG4gICAgICAgIHNlcmlhbGl6ZXIuYWRkKDEpO1xyXG4gICAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIGVuZCBvZiBzdHJpbmcnLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBuYW1lUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTkFNRSkge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIG5hbWUsIGdvdDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICdNQVNLJykge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Rpc2FsbG93ZWQgbmFtZSBcIk1BU0tcIiBnaXZlbicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbi52YWx1ZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG51bWJlclBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSAhPT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIG51bWJlciwgZ290OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbi52YWx1ZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNvbnN1bWVTeW1ib2wgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgc3ltYm9sKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gc3ltYm9sKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCInICsgc3ltYm9sICsgJ1wiLCBnb3Q6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBtYXNrUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyBcIi8vXCIgb3IgXCIvPE5VTUJFUj4vXCIsIG90aGVyd2lzZSB0aGVyZSBpcyBubyBtYXNrXHJcbiAgICAgICAgLy8gTGFiZWxlZCB3aXRoIDxNQVNLPiBpbiBjb21tZW50cyBiZWxvd1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcvJykge1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZCgtMSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXNrZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcvJykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbWFza2VkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZGVmaW5lZDogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSAhPT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIFwiL1wiIG9yIG51bWJlcicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRva2VuLnZhbHVlO1xyXG4gICAgICAgIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCIvXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtYXNrZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGRlZmluZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZU1hcFBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gezxNQVNLPiA8TkFNRT46PFRZUEU+LCA8TkFNRT46PFRZUEU+LCA8TkFNRT46PFRZUEU+fVxyXG4gICAgICAgIHZhciBtYXNrID0gbWFza1BhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJzonKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICd9Jykge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTUFQX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTUFQX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLCcpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIGFmdGVyIG1hcCBlbGVtZW50OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZVR1cGxlUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyAoPE1BU0s+IDxUWVBFPiwgPFRZUEU+LCA8VFlQRT4pXHJcbiAgICAgICAgdmFyIG1hc2sgPSBtYXNrUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godHlwZVBhcnNlcihzZXJpYWxpemVyKSk7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnKScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtYXNrLm1hc2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXNrLmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5UVVBMRV9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5UVVBMRV9VTk1BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJywnKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCB0b2tlbiBhZnRlciB0dXBsZSBlbGVtZW50OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZUFycmF5UGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyBbPE1BU0s+IDxUWVBFPjo8TlVNQkVSPl1cclxuICAgICAgICB2YXIgbWFzayA9IG1hc2tQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc6Jyk7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gbnVtYmVyUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJ10nKTtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgY291bnQ6IGNvdW50LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrLmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQsIGNoaWxkcmVuLCBtYXNrLnZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9VTk1BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHR5cGVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIE9wdGlvbnM6XHJcbiAgICAgICAgLy8gLSA8TkFNRT5cclxuICAgICAgICAvLyAtIFR1cGxlXHJcbiAgICAgICAgLy8gLSBBcnJheVxyXG4gICAgICAgIC8vIC0gTWFwXHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIGVuZCBvZiBzdHJpbmcnLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgPT09IFRva2VuQ2F0ZWdvcmllcy5OVU1CRVIpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIG51bWJlciwgdHlwZSBleHBlY3RlZCcsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSA9PT0gVG9rZW5DYXRlZ29yaWVzLk5BTUUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk5BTUVELCB0b2tlbi52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ3snKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlTWFwUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICdbJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZUFycmF5UGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcoJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZVR1cGxlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIHdoZW4gZGVzY3JpYmluZyB0eXBlOiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBhcnNlciA9IGZ1bmN0aW9uICh0b2tlbnMsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBzZXJpYWxpemVyID0gbmV3IGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5TZXJpYWxpemVyKHRva2Vucyk7XHJcbiAgICAgICAgdmFyIHN0cnVjdHVyZXMgPSBbXTtcclxuICAgICAgICB3aGlsZSAoc2VyaWFsaXplci5pbmRleCA8IHNlcmlhbGl6ZXIuZGF0YVZpZXcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmFtZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgaWYgKG5hbWVbMF0gIT09IG5hbWVbMF0udG9VcHBlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1N0cnVjdHVyZSBuYW1lcyBjYW5ub3Qgc3RhcnQgd2l0aCBsb3dlcmNhc2UgbGV0dGVycycsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJz0nKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnOycpO1xyXG4gICAgICAgICAgICBzdHJ1Y3R1cmVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHJ1Y3R1cmVzO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlSGFuZGxlcnMgPSBmdW5jdGlvbiAoc3RydWN0dXJlKSB7XHJcbiAgICAgICAgdmFyIGxpYnJhcnkgPSB7fTtcclxuICAgICAgICBzdHJ1Y3R1cmUuZm9yRWFjaChmdW5jdGlvbiAoZW50cnkpIHtcclxuICAgICAgICAgICAgbGlicmFyeVtlbnRyeS5uYW1lXSA9IGVudHJ5LnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlicmFyeTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBhcnNlID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSGFuZGxlcnMocGFyc2VyKGxleGVyKHRva2VuaXplcih0ZXh0KSwgdGV4dCksIHRleHQpKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVyci5lcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoIWdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbikge1xyXG4gICAgICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbiA9IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5fcGFyc2VyU3RlcHMgPSB7XHJcbiAgICAgICAgdG9rZW5pemVyOiB0b2tlbml6ZXIsXHJcbiAgICAgICAgbGV4ZXI6IGxleGVyLFxyXG4gICAgICAgIHBhcnNlcjogcGFyc2VyLFxyXG4gICAgICAgIFRva2VuQ2F0ZWdvcmllczogVG9rZW5DYXRlZ29yaWVzLFxyXG4gICAgICAgIFR5cGVDYXRlZ29yaWVzOiBUeXBlQ2F0ZWdvcmllcyxcclxuICAgICAgICBTdHJpbmdUb2tlbjogU3RyaW5nVG9rZW4sXHJcbiAgICAgICAgVG9rZW46IFRva2VuLFxyXG4gICAgICAgIFR5cGU6IFR5cGUsXHJcbiAgICB9O1xyXG5cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5wYXJzZSA9IHBhcnNlO1xyXG5cclxufSh0aGlzKSk7XHJcbiIsIihmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgZnVuY3Rpb24gU2VyaWFsaXplcihkYXRhVmlldykge1xyXG4gICAgICAgIHRoaXMuaW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuZGF0YVZpZXcgPSBkYXRhVmlldztcclxuICAgIH1cclxuXHJcbiAgICBTZXJpYWxpemVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoaW5jcmVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5pbmRleCArPSBpbmNyZW1lbnQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uU2VyaWFsaXplciA9IFNlcmlhbGl6ZXI7XHJcblxyXG59KHRoaXMpKTtcclxuIl19
