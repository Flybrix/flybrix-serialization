!function(e){"use strict";var o=function(){return null};function i(e,n,r,t,i,a){this.descriptor=e,this.byteCount=n,this.encode=t,this.decode=i,this.empty=r,this.fullMask=a||o,this.isBasic=!1}var l={},f=function(e,n){return 0!=(e[Math.floor(n/8)]&1<<n%8)},a=function(){return 0},s=function(e){for(var n=[],r=0;r<e;++r)n.push(0);return n},n=function(e,r,t){var n=new i(e,t,a,function(e,n){e.dataView["set"+r](e.index,n,1),e.add(t)},function(e){var n=e.dataView["get"+r](e.index,1);return e.add(t),n});return n.isBasic=!0,n};l.u8=n("u8","Uint8",1),l.u16=n("u16","Uint16",2),l.u32=n("u32","Uint32",4),l.i8=n("i8","Int8",1),l.i16=n("i16","Int16",2),l.i32=n("i32","Int32",4),l.f32=n("f32","Float32",4),l.f64=n("f64","Float64",8),l.bool=new i("bool",l.u8.byteCount,function(){return!1},function(e,n){l.u8.encode(e,n?1:0)},function(e){return 0!==l.u8.decode(e)}),l.bool.isBasic=!0;l.string=function(a){var o=l.arrayUnmasked(a,l.u8);return new i("s"+a,a,function(){return""},function(e,n){var r,t,i;o.encode(e,(r=n,t=a,i=new Uint8Array(t),r.split("").forEach(function(e,n){i[n]=e.charCodeAt(0)}),i[t-1]=0,i))},function(e){return function(e,n){for(var r="",t=Math.min(e.length,n-1),i=0;i<t;++i){if(0===e[i])return r;r+=String.fromCharCode(e[i])}return r}(o.decode(e),a)})},l.s=new i("s",0,function(){return""},function(e,n){for(var r=Math.min(n.length,e.dataView.byteLength-e.index),t=0;t<r;++t)l.u8.encode(e,n.charCodeAt(t));e.index<e.dataView.byteLength&&l.u8.encode(e,0)},function(e){for(var n="",r=e.dataView.byteLength-e.index;0<r--;){var t=l.u8.decode(e);if(!t)return n;n+=String.fromCharCode(t)}return n}),l.s.isBasic=!0,l.arrayUnmasked=function(e,n){for(var r=[],t=0;t<e;++t)r.push(n);var i=l.tupleUnmasked(r);return i.descriptor="["+n.descriptor+":"+e+"]",i},l.tupleUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.byteCount},0);return new i("("+e.map(function(e){return e.descriptor}).join(",")+")",n,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null),e.forEach(function(e,n){e.encode(r,t[n],i&&i[n])})},function(n){return e.map(function(e){return e.decode(n)})},function(){var t=!1,i={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t=!0,i[n]=r)}),t?i:null})},l.arrayMasked=function(e,n,r){for(var t=[],i=0;i<e;++i)t.push(n);var a=l.tupleMasked(t,r),o=8*(a.byteCount-e*n.byteCount);return a.descriptor="[/"+o+"/"+n.descriptor+":"+e+"]",a},l.tupleMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=l.arrayUnmasked(u,l.u8),r=e.reduce(function(e,n){return e+n.byteCount},u),t=e.map(function(e){return e.descriptor});return new i("(/"+8*u+"/"+t.join(",")+")",r,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null);var a=s(u),o=null;i&&"MASK"in i&&(o=i.MASK),e.forEach(function(e,n){var r=t[n];o&&!o[n]||null!=r&&(a[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,a),e.forEach(function(e,n){f(a,n)&&e.encode(r,t[n],i&&i[n])})},function(r){var t=c.decode(r);return e.map(function(e,n){return f(t,n)?e.decode(r):null})},function(){var t={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t[n]=r)}),t.MASK=e.map(function(){return!0}),t})},l.mapUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.handler.byteCount},0);return new i("{"+e.map(function(e){return e.key+":"+e.handler.descriptor}).join(",")+"}",n,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(n,r,t){!0===t&&(t=null),e.forEach(function(e){e.handler.encode(n,r[e.key],t&&t[e.key])})},function(n){var r={};return e.forEach(function(e){r[e.key]=e.handler.decode(n)}),r},function(){var r=!1,t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r=!0,t[e.key]=n)}),r?t:null})},l.mapMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=l.arrayUnmasked(u,l.u8),r=e.reduce(function(e,n){return e+n.handler.byteCount},u),t=e.map(function(e){return e.key+":"+e.handler.descriptor});return new i("{/"+8*u+"/"+t.join(",")+"}",r,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(r,t,i){!0===i&&(i=null);var a=s(u),o=null;i&&"MASK"in i&&(o=i.MASK),e.forEach(function(e,n){var r=t[e.key];o&&!o[e.key]||null!=r&&(a[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,a),e.forEach(function(e,n){f(a,n)&&e.handler.encode(r,t[e.key],i&&i[e.key])})},function(r){var t=c.decode(r),i={};return e.forEach(function(e,n){f(t,n)?i[e.key]=e.handler.decode(r):i[e.key]=null}),i},function(){var r={},t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r[e.key]=n),t[e.key]=!0}),r.MASK=t,r})},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization._handlers=l}(this),function(u){"use strict";function a(e,n){this.position=e,this.value=n}var c=/^\d+$/,n=/^\w+$/,o={SYMBOL:0,NUMBER:1,NAME:2};function r(e){this.position=e.position,this.value=e.value,c.test(this.value)?(this.category=o.NUMBER,this.value=parseInt(this.value)):n.test(this.value)?this.category=o.NAME:this.category=o.SYMBOL}var l=/^[{}\[\]()\/=:,;\w\s]*$/,t=function(e){if(n=e,!l.test(n))throw new Error("Passed config contains invalid characters");for(var n,r,t=/([{}\[\]()\/=:,;]|\w+)/g,i=[];null!==(r=t.exec(e));)i.push(new a(r.index,r[0]));return i},i=function(e){return e.map(function(e){return new r(e)})},f={NAMED:0,MAP_UNMASKED:2,MAP_MASKED:3,TUPLE_UNMASKED:4,TUPLE_MASKED:5,ARRAY_UNMASKED:6,ARRAY_MASKED:7};function s(e,n,r){this.category=e,this.properties=n,this.mask=r||0}s.prototype.generateHandler=function(n){var e,r=u.FlybrixSerialization._handlers,t=this.properties,i=this.mask,a=null;switch(this.category){case f.NAMED:if(t in r)(a=r[t]).isBasic||(a=null);else if("s"===t[0]){var o=t.substring(1);c.test(o)&&(a=r.string(parseInt(o)))}else t in n&&(a=n[t]);if(!a)throw{position:-1,error:'Unrecognized type "'+t+'"'};return a;case f.MAP_UNMASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapUnmasked(e);case f.MAP_MASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapMasked(e,i);case f.TUPLE_UNMASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleUnmasked(e);case f.TUPLE_MASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleMasked(e,i);case f.ARRAY_UNMASKED:return r.arrayUnmasked(t.count,t.value.generateHandler(n));case f.ARRAY_MASKED:return r.arrayMasked(t.count,t.value.generateHandler(n),i);default:throw{position:-1,error:"Unrecognized type category"}}};var d=function(e){var n=e.dataView[e.index];if(e.add(1),!n)throw{position:-1,error:"Unexpected end of string"};return n},h=function(e){var n=d(e);if(n.category!==o.NAME)throw{position:n.position,error:'Expected name, got: "'+n.value+'"'};if("MASK"===n.value)throw{position:n.position,error:'Disallowed name "MASK" given'};return n.value},p=function(e,n){var r=d(e);if(r.value!==n)throw{position:r.position,error:'Expected "'+n+'", got: "'+r.value+'"'}},v=function(e){var n=d(e);if("/"!==n.value)return e.add(-1),{masked:!1};if("/"===(n=d(e)).value)return{masked:!0,defined:!1};if(n.category!==o.NUMBER)throw{position:n.position,error:'Expected "/" or number'};var r=n.value;if("/"!==(n=d(e)).value)throw{position:n.position,error:'Expected "/"'};return{masked:!0,defined:!0,value:r}},y=function(e){var n=v(e),r=M(e);p(e,":");var t=function(e){var n=d(e);if(n.category!==o.NUMBER)throw{position:n.position,error:'Expected number, got: "'+n.value+'"'};return n.value}(e);p(e,"]");var i={value:r,count:t};return n.masked?n.defined?new s(f.ARRAY_MASKED,i,n.value):new s(f.ARRAY_MASKED,i):new s(f.ARRAY_UNMASKED,i)},M=function(e){var n=d(e);if(!n)throw{position:-1,error:"Unexpected end of string"};if(n.category===o.NUMBER)throw{position:n.position,error:"Unexpected number, type expected"};if(n.category===o.NAME)return new s(f.NAMED,n.value);if("{"===n.value)return function(e){for(var n=v(e),r=[];;){var t=h(e);p(e,":");var i=M(e);r.push({name:t,value:i});var a=d(e);if("}"===a.value)return n.masked?n.defined?new s(f.MAP_MASKED,r,n.value):new s(f.MAP_MASKED,r):new s(f.MAP_UNMASKED,r);if(","!==a.value)throw{position:a.position,error:'Unexpected token after map element: "'+a.value+'"'}}}(e);if("["===n.value)return y(e);if("("===n.value)return function(e){for(var n=v(e),r=[];;){r.push(M(e));var t=d(e);if(")"===t.value)return n.masked?n.defined?new s(f.TUPLE_MASKED,r,n.value):new s(f.TUPLE_MASKED,r):new s(f.TUPLE_UNMASKED,r);if(","!==t.value)throw{position:t.position,error:'Unexpected token after tuple element: "'+t.value+'"'}}}(e);throw{position:n.position,error:'Unexpected token when describing type: "'+n.value+'"'}},E=function(e,n){for(var r=new u.FlybrixSerialization.Serializer(e),t=[];r.index<r.dataView.length;){var i=h(r);if(i[0]!==i[0].toUpperCase())throw{position:-1,error:"Structure names cannot start with lowercase letters"};p(r,"=");var a=M(r);p(r,";"),t.push({name:i,value:a})}return t};u.FlybrixSerialization||(u.FlybrixSerialization={}),u.FlybrixSerialization._parserSteps={tokenizer:t,lexer:i,parser:E,TokenCategories:o,TypeCategories:f,StringToken:a,Token:r,Type:s},u.FlybrixSerialization.parse=function(e){try{return n=E(i(t(e))),r={},n.forEach(function(e){r[e.name]=e.value.generateHandler(r)}),r}catch(e){throw new Error(e.error)}var n,r}}(this),function(e){"use strict";function n(e){this.index=0,this.dataView=e}n.prototype.add=function(e){this.index+=e},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization.Serializer=n}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwicGFyc2VyLmpzIiwic2VyaWFsaXplci5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJudWxsTWFzayIsIkhhbmRsZXIiLCJkZXNjcmlwdG9yIiwiYnl0ZUNvdW50IiwiZW1wdHkiLCJlbmNvZGUiLCJkZWNvZGUiLCJmdWxsTWFzayIsInRoaXMiLCJpc0Jhc2ljIiwiaGFuZGxlcnMiLCJoYXNCaXQiLCJtYXNrIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZW1wdHlOdW1lcmljIiwiemVyb0FycmF5IiwibCIsInJlc3VsdCIsInB1c2giLCJjcmVhdGVOdW1lcmljVHlwZSIsImtleVNob3J0Iiwia2V5IiwiaGFuZGxlciIsInNlcmlhbGl6ZXIiLCJkYXRhIiwiZGF0YVZpZXciLCJpbmRleCIsImFkZCIsInU4IiwidTE2IiwidTMyIiwiaTgiLCJpMTYiLCJpMzIiLCJmMzIiLCJmNjQiLCJib29sIiwic3RyaW5nIiwibGVuZ3RoIiwiYXJyYXlVbm1hc2tlZCIsIm5hbWUiLCJyZXNwb25zZSIsIlVpbnQ4QXJyYXkiLCJzcGxpdCIsImZvckVhY2giLCJjIiwiY2hhckNvZGVBdCIsIm1pbiIsImkiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJhc2NpaURlY29kZSIsInMiLCJieXRlTGVuZ3RoIiwiY2hhckNvZGUiLCJjaGlsZHJlbiIsInR1cGxlVW5tYXNrZWQiLCJyZWR1Y2UiLCJhY2N1bSIsImNoaWxkIiwibWFwIiwiam9pbiIsIm1hc2tzIiwibm9uTnVsbENoaWxkIiwidmFsdWUiLCJhcnJheU1hc2tlZCIsIm1hc2tCaXRDb3VudCIsInR1cGxlTWFza2VkIiwibWFza1NpemUiLCJtYXNrQnl0ZXMiLCJjZWlsIiwibWF4IiwibWFza0hhbmRsZXIiLCJjaGlsZERlc2NyaXB0b3JzIiwiZXh0cmFNYXNrIiwiTUFTSyIsIl8iLCJtYXBVbm1hc2tlZCIsIm1hcE1hc2tlZCIsIkZseWJyaXhTZXJpYWxpemF0aW9uIiwiX2hhbmRsZXJzIiwiU3RyaW5nVG9rZW4iLCJwb3NpdGlvbiIsIm51bWVyaWNUZXN0IiwibmFtZVRlc3QiLCJUb2tlbkNhdGVnb3JpZXMiLCJTWU1CT0wiLCJOVU1CRVIiLCJOQU1FIiwiVG9rZW4iLCJzdHJpbmdUb2tlbiIsInRlc3QiLCJjYXRlZ29yeSIsInBhcnNlSW50IiwidmFsaWRDaGFyU2V0VGVzdCIsInRva2VuaXplciIsInRleHQiLCJFcnJvciIsIm1hdGNoIiwicmUiLCJtYXRjaGVzIiwiZXhlYyIsImxleGVyIiwidG9rZW5zIiwidG9rZW4iLCJUeXBlQ2F0ZWdvcmllcyIsIk5BTUVEIiwiTUFQX1VOTUFTS0VEIiwiTUFQX01BU0tFRCIsIlRVUExFX1VOTUFTS0VEIiwiVFVQTEVfTUFTS0VEIiwiQVJSQVlfVU5NQVNLRUQiLCJBUlJBWV9NQVNLRUQiLCJUeXBlIiwicHJvcGVydGllcyIsInByb3RvdHlwZSIsImdlbmVyYXRlSGFuZGxlciIsImxpYnJhcnkiLCJwcm9wcyIsInN1YnN0cmluZyIsImVycm9yIiwiY291bnQiLCJyZWFkVG9rZW4iLCJuYW1lUGFyc2VyIiwiY29uc3VtZVN5bWJvbCIsInN5bWJvbCIsIm1hc2tQYXJzZXIiLCJtYXNrZWQiLCJkZWZpbmVkIiwidHlwZUFycmF5UGFyc2VyIiwidHlwZVBhcnNlciIsIm51bWJlclBhcnNlciIsInR5cGVNYXBQYXJzZXIiLCJ0eXBlVHVwbGVQYXJzZXIiLCJwYXJzZXIiLCJzb3VyY2UiLCJTZXJpYWxpemVyIiwic3RydWN0dXJlcyIsInRvVXBwZXJDYXNlIiwiX3BhcnNlclN0ZXBzIiwicGFyc2UiLCJzdHJ1Y3R1cmUiLCJlbnRyeSIsImVyciIsImluY3JlbWVudCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsR0FDQSxhQUVBLElBQUFDLEVBQUEsV0FDQSxPQUFBLE1BR0EsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsS0FBQU4sV0FBQUEsRUFDQU0sS0FBQUwsVUFBQUEsRUFDQUssS0FBQUgsT0FBQUEsRUFDQUcsS0FBQUYs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QSxDQStZQS9HLE1DL1lBLFNBQUFULEdBQ0EsYUFFQSxTQUFBMkksRUFBQS9HLEdBQ0FuQixLQUFBb0IsTUFBQSxFQUNBcEIsS0FBQW1CLFNBQUFBLEVBR0ErRyxFQUFBckIsVUFBQXhGLElBQUEsU0FBQXFILEdBQ0ExSSxLQUFBb0IsT0FBQXNILEdBR0FuSixFQUFBa0YsdUJBQ0FsRixFQUFBa0YscUJBQUEsSUFFQWxGLEVBQUFrRixxQkFBQXlELFdBQUFBLEVBZkEsQ0FpQkFsSSIsImZpbGUiOiJmbHlicml4LXNlcmlhbGl6YXRpb24ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgbnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKSB7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcclxuICAgICAgICB0aGlzLmJ5dGVDb3VudCA9IGJ5dGVDb3VudDtcclxuICAgICAgICB0aGlzLmVuY29kZSA9IGVuY29kZTtcclxuICAgICAgICB0aGlzLmRlY29kZSA9IGRlY29kZTtcclxuICAgICAgICB0aGlzLmVtcHR5ID0gZW1wdHk7XHJcbiAgICAgICAgdGhpcy5mdWxsTWFzayA9IGZ1bGxNYXNrIHx8IG51bGxNYXNrO1xyXG4gICAgICAgIHRoaXMuaXNCYXNpYyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBoYW5kbGVycyA9IHt9O1xyXG5cclxuICAgIHZhciBoYXNCaXQgPSBmdW5jdGlvbiAobWFzaywgaWR4KSB7XHJcbiAgICAgICAgcmV0dXJuIChtYXNrW01hdGguZmxvb3IoaWR4IC8gOCldICYgKDEgPDwgKGlkeCAlIDgpKSkgIT09IDA7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBlbXB0eU51bWVyaWMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB6ZXJvQXJyYXkgPSBmdW5jdGlvbiAobCkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsOyArK2lkeCkge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaCgwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNyZWF0ZU51bWVyaWNUeXBlID0gZnVuY3Rpb24gKGtleVNob3J0LCBrZXksIGJ5dGVDb3VudCkge1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmRhdGFWaWV3WydzZXQnICsga2V5XShzZXJpYWxpemVyLmluZGV4LCBkYXRhLCAxKTtcclxuICAgICAgICAgICAgc2VyaWFsaXplci5hZGQoYnl0ZUNvdW50KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBzZXJpYWxpemVyLmRhdGFWaWV3WydnZXQnICsga2V5XShzZXJpYWxpemVyLmluZGV4LCAxKTtcclxuICAgICAgICAgICAgc2VyaWFsaXplci5hZGQoYnl0ZUNvdW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBuZXcgSGFuZGxlcihrZXlTaG9ydCwgYnl0ZUNvdW50LCBlbXB0eU51bWVyaWMsIGVuY29kZSwgZGVjb2RlKTtcclxuXHJcbiAgICAgICAgaGFuZGxlci5pc0Jhc2ljID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGhhbmRsZXI7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLnU4ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ3U4JywgJ1VpbnQ4JywgMSk7XHJcbiAgICBoYW5kbGVycy51MTYgPSBjcmVhdGVOdW1lcmljVHlwZSgndTE2JywgJ1VpbnQxNicsIDIpO1xyXG4gICAgaGFuZGxlcnMudTMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ3UzMicsICdVaW50MzInLCA0KTtcclxuICAgIGhhbmRsZXJzLmk4ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2k4JywgJ0ludDgnLCAxKTtcclxuICAgIGhhbmRsZXJzLmkxNiA9IGNyZWF0ZU51bWVyaWNUeXBlKCdpMTYnLCAnSW50MTYnLCAyKTtcclxuICAgIGhhbmRsZXJzLmkzMiA9IGNyZWF0ZU51bWVyaWNUeXBlKCdpMzInLCAnSW50MzInLCA0KTtcclxuICAgIGhhbmRsZXJzLmYzMiA9IGNyZWF0ZU51bWVyaWNUeXBlKCdmMzInLCAnRmxvYXQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuZjY0ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2Y2NCcsICdGbG9hdDY0JywgOCk7XHJcblxyXG4gICAgaGFuZGxlcnMuYm9vbCA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICdib29sJyxcclxuICAgICAgICBoYW5kbGVycy51OC5ieXRlQ291bnQsXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICBoYW5kbGVycy51OC5lbmNvZGUoc2VyaWFsaXplciwgZGF0YSA/IDEgOiAwKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy51OC5kZWNvZGUoc2VyaWFsaXplcikgIT09IDA7XHJcbiAgICAgICAgfSk7XHJcbiAgICBoYW5kbGVycy5ib29sLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgIHZhciBhc2NpaUVuY29kZSA9IGZ1bmN0aW9uIChuYW1lLCBsZW5ndGgpIHtcclxuICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgVWludDhBcnJheShsZW5ndGgpO1xyXG4gICAgICAgIG5hbWUuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24gKGMsIGlkeCkge1xyXG4gICAgICAgICAgICByZXNwb25zZVtpZHhdID0gYy5jaGFyQ29kZUF0KDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJlc3BvbnNlW2xlbmd0aCAtIDFdID0gMDtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBhc2NpaURlY29kZSA9IGZ1bmN0aW9uIChuYW1lLCBsZW5ndGgpIHtcclxuICAgICAgICB2YXIgcmVzcG9uc2UgPSAnJztcclxuICAgICAgICB2YXIgbCA9IE1hdGgubWluKG5hbWUubGVuZ3RoLCBsZW5ndGggLSAxKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAobmFtZVtpXSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlc3BvbnNlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUobmFtZVtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMuc3RyaW5nID0gZnVuY3Rpb24gKGxlbmd0aCkge1xyXG4gICAgICAgIHZhciBoYW5kbGVyID0gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChsZW5ndGgsIGhhbmRsZXJzLnU4KTtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgYXNjaWlFbmNvZGUoZGF0YSwgbGVuZ3RoKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFzY2lpRGVjb2RlKGhhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpLCBsZW5ndGgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoJ3MnICsgbGVuZ3RoLCBsZW5ndGgsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLnMgPSBuZXcgSGFuZGxlcihcclxuICAgICAgICAncycsXHJcbiAgICAgICAgMCxcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBieXRlQ291bnQgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCwgc2VyaWFsaXplci5kYXRhVmlldy5ieXRlTGVuZ3RoIC0gc2VyaWFsaXplci5pbmRleCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGJ5dGVDb3VudDsgKytpZHgpIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCBkYXRhLmNoYXJDb2RlQXQoaWR4KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNlcmlhbGl6ZXIuaW5kZXggPCBzZXJpYWxpemVyLmRhdGFWaWV3LmJ5dGVMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gJyc7XHJcbiAgICAgICAgICAgIHZhciBieXRlQ291bnQgPSBzZXJpYWxpemVyLmRhdGFWaWV3LmJ5dGVMZW5ndGggLSBzZXJpYWxpemVyLmluZGV4O1xyXG4gICAgICAgICAgICB3aGlsZSAoYnl0ZUNvdW50LS0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhckNvZGUgPSBoYW5kbGVycy51OC5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNoYXJDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgaGFuZGxlcnMucy5pc0Jhc2ljID0gdHJ1ZTtcclxuXHJcbiAgICBoYW5kbGVycy5hcnJheVVubWFza2VkID0gZnVuY3Rpb24gKGxlbmd0aCwgaGFuZGxlcikge1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgKytpZHgpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGhhbmRsZXJzLnR1cGxlVW5tYXNrZWQoY2hpbGRyZW4pO1xyXG4gICAgICAgIHJlc3VsdC5kZXNjcmlwdG9yID0gJ1snICsgaGFuZGxlci5kZXNjcmlwdG9yICsgJzonICsgbGVuZ3RoICsgJ10nO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLnR1cGxlVW5tYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4pIHtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2lkeF0sIG1hc2tzICYmIG1hc2tzW2lkeF0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBub25OdWxsQ2hpbGQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9uTnVsbENoaWxkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbaWR4XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKCFub25OdWxsQ2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gY2hpbGRyZW4ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY2hpbGQuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVzY3JpcHRvcjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9ICcoJyArIGNoaWxkRGVzY3JpcHRvcnMuam9pbignLCcpICsgJyknO1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5hcnJheU1hc2tlZCA9IGZ1bmN0aW9uIChsZW5ndGgsIGhhbmRsZXIsIG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgKytpZHgpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGhhbmRsZXJzLnR1cGxlTWFza2VkKGNoaWxkcmVuLCBtYXNrQml0Q291bnQpO1xyXG4gICAgICAgIHZhciBtYXNrU2l6ZSA9IChyZXN1bHQuYnl0ZUNvdW50IC0gKGxlbmd0aCAqIGhhbmRsZXIuYnl0ZUNvdW50KSkgKiA4O1xyXG4gICAgICAgIHJlc3VsdC5kZXNjcmlwdG9yID0gJ1svJyArIG1hc2tTaXplICsgJy8nICsgaGFuZGxlci5kZXNjcmlwdG9yICsgJzonICsgbGVuZ3RoICsgJ10nO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLnR1cGxlTWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuLCBtYXNrQml0Q291bnQpIHtcclxuICAgICAgICB2YXIgbWFza0J5dGVzID0gTWF0aC5jZWlsKGNoaWxkcmVuLmxlbmd0aCAvIDgpO1xyXG4gICAgICAgIGlmIChtYXNrQml0Q291bnQpIHtcclxuICAgICAgICAgICAgbWFza0J5dGVzID0gTWF0aC5tYXgobWFza0J5dGVzLCBNYXRoLmNlaWwobWFza0JpdENvdW50IC8gOCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWFza0hhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKG1hc2tCeXRlcywgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1hc2sgPSB6ZXJvQXJyYXkobWFza0J5dGVzKTtcclxuICAgICAgICAgICAgdmFyIGV4dHJhTWFzayA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyAmJiAoJ01BU0snIGluIG1hc2tzKSkge1xyXG4gICAgICAgICAgICAgICAgZXh0cmFNYXNrID0gbWFza3MuTUFTSztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChfLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFbaWR4XTtcclxuICAgICAgICAgICAgICAgIGlmIChleHRyYU1hc2sgJiYgIWV4dHJhTWFza1tpZHhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrW01hdGguZmxvb3IoaWR4IC8gOCldIHw9IDEgPDwgKGlkeCAlIDgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1hc2tIYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBtYXNrKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbaWR4XSwgbWFza3MgJiYgbWFza3NbaWR4XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0hhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQml0KG1hc2ssIGlkeCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbaWR4XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzdWx0Lk1BU0sgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCBtYXNrQnl0ZXMpO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVzY3JpcHRvcjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9ICcoLycgKyAobWFza0J5dGVzICogOCkgKyAnLycgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICcpJztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMubWFwVW5tYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4pIHtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5oYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2NoaWxkLmtleV0sIG1hc2tzICYmIG1hc2tzW2NoaWxkLmtleV0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbm9uTnVsbENoaWxkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmhhbmRsZXIuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vbk51bGxDaGlsZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghbm9uTnVsbENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmhhbmRsZXIuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQua2V5ICsgJzonICsgY2hpbGQuaGFuZGxlci5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJ3snICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnfSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLm1hcE1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbiwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIG1hc2tCeXRlcyA9IE1hdGguY2VpbChjaGlsZHJlbi5sZW5ndGggLyA4KTtcclxuICAgICAgICBpZiAobWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgICAgIG1hc2tCeXRlcyA9IE1hdGgubWF4KG1hc2tCeXRlcywgTWF0aC5jZWlsKG1hc2tCaXRDb3VudCAvIDgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hc2tIYW5kbGVyID0gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChtYXNrQnl0ZXMsIGhhbmRsZXJzLnU4KTtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gemVyb0FycmF5KG1hc2tCeXRlcyk7XHJcbiAgICAgICAgICAgIHZhciBleHRyYU1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobWFza3MgJiYgKCdNQVNLJyBpbiBtYXNrcykpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhTWFzayA9IG1hc2tzLk1BU0s7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFbY2hpbGQua2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChleHRyYU1hc2sgJiYgIWV4dHJhTWFza1tjaGlsZC5rZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrW01hdGguZmxvb3IoaWR4IC8gOCldIHw9IDEgPDwgKGlkeCAlIDgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1hc2tIYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBtYXNrKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuaGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtjaGlsZC5rZXldLCBtYXNrcyAmJiBtYXNrc1tjaGlsZC5rZXldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIG1hc2sgPSBtYXNrSGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5oYW5kbGVyLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbWFza1tjaGlsZC5rZXldID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5NQVNLID0gbWFzaztcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5oYW5kbGVyLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCBtYXNrQnl0ZXMpO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQua2V5ICsgJzonICsgY2hpbGQuaGFuZGxlci5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJ3svJyArIChtYXNrQnl0ZXMgKiA4KSArICcvJyArIGNoaWxkRGVzY3JpcHRvcnMuam9pbignLCcpICsgJ30nO1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spO1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoIWdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbikge1xyXG4gICAgICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbiA9IHt9O1xyXG4gICAgfVxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLl9oYW5kbGVycyA9IGhhbmRsZXJzO1xyXG5cclxufSh0aGlzKSk7XHJcbiIsIihmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgZnVuY3Rpb24gU3RyaW5nVG9rZW4ocG9zaXRpb24sIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgbnVtZXJpY1Rlc3QgPSAvXlxcZCskLztcclxuICAgIHZhciBuYW1lVGVzdCA9IC9eXFx3KyQvO1xyXG5cclxuICAgIHZhciBUb2tlbkNhdGVnb3JpZXMgPSB7XHJcbiAgICAgICAgU1lNQk9MOiAwLFxyXG4gICAgICAgIE5VTUJFUjogMSxcclxuICAgICAgICBOQU1FOiAyLFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBUb2tlbihzdHJpbmdUb2tlbikge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBzdHJpbmdUb2tlbi5wb3NpdGlvbjtcclxuICAgICAgICB0aGlzLnZhbHVlID0gc3RyaW5nVG9rZW4udmFsdWU7XHJcbiAgICAgICAgaWYgKG51bWVyaWNUZXN0LnRlc3QodGhpcy52YWx1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IFRva2VuQ2F0ZWdvcmllcy5OVU1CRVI7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBwYXJzZUludCh0aGlzLnZhbHVlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5hbWVUZXN0LnRlc3QodGhpcy52YWx1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IFRva2VuQ2F0ZWdvcmllcy5OQU1FO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBUb2tlbkNhdGVnb3JpZXMuU1lNQk9MO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgdmFsaWRDaGFyU2V0VGVzdCA9IC9eW3t9XFxbXFxdKClcXC89Oiw7XFx3XFxzXSokLztcclxuXHJcbiAgICB2YXIgaXNWYWxpZCA9IGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbGlkQ2hhclNldFRlc3QudGVzdCh0ZXh0KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHRva2VuaXplciA9IGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFpc1ZhbGlkKHRleHQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGFzc2VkIGNvbmZpZyBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlID0gLyhbe31cXFtcXF0oKVxcLz06LDtdfFxcdyspL2c7XHJcbiAgICAgICAgdmFyIG1hdGNoO1xyXG4gICAgICAgIHZhciBtYXRjaGVzID0gW107XHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlLmV4ZWModGV4dCkpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIG1hdGNoZXMucHVzaChuZXcgU3RyaW5nVG9rZW4obWF0Y2guaW5kZXgsIG1hdGNoWzBdKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXRjaGVzO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbGV4ZXIgPSBmdW5jdGlvbiAodG9rZW5zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRva2Vucy5tYXAoZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVG9rZW4odG9rZW4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgVHlwZUNhdGVnb3JpZXMgPSB7XHJcbiAgICAgICAgTkFNRUQ6IDAsXHJcbiAgICAgICAgTUFQX1VOTUFTS0VEOiAyLFxyXG4gICAgICAgIE1BUF9NQVNLRUQ6IDMsXHJcbiAgICAgICAgVFVQTEVfVU5NQVNLRUQ6IDQsXHJcbiAgICAgICAgVFVQTEVfTUFTS0VEOiA1LFxyXG4gICAgICAgIEFSUkFZX1VOTUFTS0VEOiA2LFxyXG4gICAgICAgIEFSUkFZX01BU0tFRDogNyxcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gVHlwZShjYXRlZ29yeSwgcHJvcGVydGllcywgbWFzaykge1xyXG4gICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcclxuICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzO1xyXG4gICAgICAgIHRoaXMubWFzayA9IG1hc2sgfHwgMDtcclxuICAgIH1cclxuXHJcbiAgICBUeXBlLnByb3RvdHlwZS5nZW5lcmF0ZUhhbmRsZXIgPSBmdW5jdGlvbiAobGlicmFyeSkge1xyXG4gICAgICAgIHZhciBoYW5kbGVycyA9IGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5faGFuZGxlcnM7XHJcbiAgICAgICAgdmFyIHByb3BzID0gdGhpcy5wcm9wZXJ0aWVzO1xyXG4gICAgICAgIHZhciBtYXNrID0gdGhpcy5tYXNrO1xyXG4gICAgICAgIHZhciBoYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB2YXIgY2hpbGRyZW47XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLmNhdGVnb3J5KSB7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuTkFNRUQ6XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcHMgaW4gaGFuZGxlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gaGFuZGxlcnNbcHJvcHNdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaGFuZGxlci5pc0Jhc2ljKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcHNbMF0gPT09ICdzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBwcm9wcy5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bWVyaWNUZXN0LnRlc3QobGVuZ3RoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gaGFuZGxlcnMuc3RyaW5nKHBhcnNlSW50KGxlbmd0aCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcHMgaW4gbGlicmFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBsaWJyYXJ5W3Byb3BzXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghaGFuZGxlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VucmVjb2duaXplZCB0eXBlIFwiJyArIHByb3BzICsgJ1wiJyxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXI7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuTUFQX1VOTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBjaGlsZC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyOiBjaGlsZC52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSksXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLm1hcFVubWFza2VkKGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5NQVBfTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBjaGlsZC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyOiBjaGlsZC52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSksXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLm1hcE1hc2tlZChjaGlsZHJlbiwgbWFzayk7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuVFVQTEVfVU5NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMudHVwbGVVbm1hc2tlZChjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuVFVQTEVfTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnR1cGxlTWFza2VkKGNoaWxkcmVuLCBtYXNrKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5BUlJBWV9VTk1BU0tFRDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5hcnJheVVubWFza2VkKHByb3BzLmNvdW50LCBwcm9wcy52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSkpO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLkFSUkFZX01BU0tFRDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5hcnJheU1hc2tlZChwcm9wcy5jb3VudCwgcHJvcHMudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpLCBtYXNrKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbnJlY29nbml6ZWQgdHlwZSBjYXRlZ29yeScsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHJlYWRUb2tlbiA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gc2VyaWFsaXplci5kYXRhVmlld1tzZXJpYWxpemVyLmluZGV4XTtcclxuICAgICAgICBzZXJpYWxpemVyLmFkZCgxKTtcclxuICAgICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCBlbmQgb2Ygc3RyaW5nJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbmFtZVBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSAhPT0gVG9rZW5DYXRlZ29yaWVzLk5BTUUpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBuYW1lLCBnb3Q6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnTUFTSycpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdEaXNhbGxvd2VkIG5hbWUgXCJNQVNLXCIgZ2l2ZW4nLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG9rZW4udmFsdWU7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBudW1iZXJQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgIT09IFRva2VuQ2F0ZWdvcmllcy5OVU1CRVIpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBudW1iZXIsIGdvdDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG9rZW4udmFsdWU7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBjb25zdW1lU3ltYm9sID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIHN5bWJvbCkge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09IHN5bWJvbCkge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIFwiJyArIHN5bWJvbCArICdcIiwgZ290OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbWFza1BhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gXCIvL1wiIG9yIFwiLzxOVU1CRVI+L1wiLCBvdGhlcndpc2UgdGhlcmUgaXMgbm8gbWFza1xyXG4gICAgICAgIC8vIExhYmVsZWQgd2l0aCA8TUFTSz4gaW4gY29tbWVudHMgYmVsb3dcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLycpIHtcclxuICAgICAgICAgICAgc2VyaWFsaXplci5hZGQoLTEpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbWFza2VkOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnLycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG1hc2tlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRlZmluZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgIT09IFRva2VuQ2F0ZWdvcmllcy5OVU1CRVIpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBcIi9cIiBvciBudW1iZXInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmFsdWUgPSB0b2tlbi52YWx1ZTtcclxuICAgICAgICB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcvJykge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIFwiL1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbWFza2VkOiB0cnVlLFxyXG4gICAgICAgICAgICBkZWZpbmVkOiB0cnVlLFxyXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHR5cGVNYXBQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIHs8TUFTSz4gPE5BTUU+OjxUWVBFPiwgPE5BTUU+OjxUWVBFPiwgPE5BTUU+OjxUWVBFPn1cclxuICAgICAgICB2YXIgbWFzayA9IG1hc2tQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc6Jyk7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHR5cGVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnfScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtYXNrLm1hc2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXNrLmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk1BUF9NQVNLRUQsIGNoaWxkcmVuLCBtYXNrLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTUFQX01BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk1BUF9VTk1BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJywnKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCB0b2tlbiBhZnRlciBtYXAgZWxlbWVudDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHR5cGVUdXBsZVBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gKDxNQVNLPiA8VFlQRT4sIDxUWVBFPiwgPFRZUEU+KVxyXG4gICAgICAgIHZhciBtYXNrID0gbWFza1BhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHR5cGVQYXJzZXIoc2VyaWFsaXplcikpO1xyXG4gICAgICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJyknKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWFzay5tYXNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFzay5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5UVVBMRV9NQVNLRUQsIGNoaWxkcmVuLCBtYXNrLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuVFVQTEVfTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuVFVQTEVfVU5NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcsJykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgdG9rZW4gYWZ0ZXIgdHVwbGUgZWxlbWVudDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHR5cGVBcnJheVBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gWzxNQVNLPiA8VFlQRT46PE5VTUJFUj5dXHJcbiAgICAgICAgdmFyIG1hc2sgPSBtYXNrUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHR5cGVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnOicpO1xyXG4gICAgICAgIHZhciBjb3VudCA9IG51bWJlclBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICddJyk7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgICAgIGNvdW50OiBjb3VudCxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChtYXNrLm1hc2tlZCkge1xyXG4gICAgICAgICAgICBpZiAobWFzay5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuQVJSQVlfTUFTS0VELCBjaGlsZHJlbiwgbWFzay52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuQVJSQVlfTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuQVJSQVlfVU5NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyBPcHRpb25zOlxyXG4gICAgICAgIC8vIC0gPE5BTUU+XHJcbiAgICAgICAgLy8gLSBUdXBsZVxyXG4gICAgICAgIC8vIC0gQXJyYXlcclxuICAgICAgICAvLyAtIE1hcFxyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCBlbmQgb2Ygc3RyaW5nJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ID09PSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCBudW1iZXIsIHR5cGUgZXhwZWN0ZWQnLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgPT09IFRva2VuQ2F0ZWdvcmllcy5OQU1FKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5OQU1FRCwgdG9rZW4udmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICd7Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZU1hcFBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnWycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVBcnJheVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnKCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVUdXBsZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCB0b2tlbiB3aGVuIGRlc2NyaWJpbmcgdHlwZTogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwYXJzZXIgPSBmdW5jdGlvbiAodG9rZW5zLCBzb3VyY2UpIHtcclxuICAgICAgICB2YXIgc2VyaWFsaXplciA9IG5ldyBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uU2VyaWFsaXplcih0b2tlbnMpO1xyXG4gICAgICAgIHZhciBzdHJ1Y3R1cmVzID0gW107XHJcbiAgICAgICAgd2hpbGUgKHNlcmlhbGl6ZXIuaW5kZXggPCBzZXJpYWxpemVyLmRhdGFWaWV3Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGlmIChuYW1lWzBdICE9PSBuYW1lWzBdLnRvVXBwZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdTdHJ1Y3R1cmUgbmFtZXMgY2Fubm90IHN0YXJ0IHdpdGggbG93ZXJjYXNlIGxldHRlcnMnLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc9Jyk7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHR5cGVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJzsnKTtcclxuICAgICAgICAgICAgc3RydWN0dXJlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RydWN0dXJlcztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNyZWF0ZUhhbmRsZXJzID0gZnVuY3Rpb24gKHN0cnVjdHVyZSkge1xyXG4gICAgICAgIHZhciBsaWJyYXJ5ID0ge307XHJcbiAgICAgICAgc3RydWN0dXJlLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7XHJcbiAgICAgICAgICAgIGxpYnJhcnlbZW50cnkubmFtZV0gPSBlbnRyeS52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGxpYnJhcnk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwYXJzZSA9IGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUhhbmRsZXJzKHBhcnNlcihsZXhlcih0b2tlbml6ZXIodGV4dCksIHRleHQpLCB0ZXh0KSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnIuZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24pIHtcclxuICAgICAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24gPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uX3BhcnNlclN0ZXBzID0ge1xyXG4gICAgICAgIHRva2VuaXplcjogdG9rZW5pemVyLFxyXG4gICAgICAgIGxleGVyOiBsZXhlcixcclxuICAgICAgICBwYXJzZXI6IHBhcnNlcixcclxuICAgICAgICBUb2tlbkNhdGVnb3JpZXM6IFRva2VuQ2F0ZWdvcmllcyxcclxuICAgICAgICBUeXBlQ2F0ZWdvcmllczogVHlwZUNhdGVnb3JpZXMsXHJcbiAgICAgICAgU3RyaW5nVG9rZW46IFN0cmluZ1Rva2VuLFxyXG4gICAgICAgIFRva2VuOiBUb2tlbixcclxuICAgICAgICBUeXBlOiBUeXBlLFxyXG4gICAgfTtcclxuXHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24ucGFyc2UgPSBwYXJzZTtcclxuXHJcbn0odGhpcykpO1xyXG4iLCIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGZ1bmN0aW9uIFNlcmlhbGl6ZXIoZGF0YVZpZXcpIHtcclxuICAgICAgICB0aGlzLmluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmRhdGFWaWV3ID0gZGF0YVZpZXc7XHJcbiAgICB9XHJcblxyXG4gICAgU2VyaWFsaXplci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGluY3JlbWVudCkge1xyXG4gICAgICAgIHRoaXMuaW5kZXggKz0gaW5jcmVtZW50O1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoIWdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbikge1xyXG4gICAgICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbiA9IHt9O1xyXG4gICAgfVxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLlNlcmlhbGl6ZXIgPSBTZXJpYWxpemVyO1xyXG5cclxufSh0aGlzKSk7XHJcbiJdfQ==
