!function(e){"use strict";var o=function(){return null};function i(e,n,r,t,i,a){this.descriptor=e,this.byteCount=n,this.encode=t,this.decode=i,this.empty=r,this.fullMask=a||o,this.isBasic=!1}var l={},f=function(e,n){return 0!=(e[Math.floor(n/8)]&1<<n%8)},a=function(){return 0},s=function(e){for(var n=[],r=0;r<e;++r)n.push(0);return n},n=function(e,r,t){var n=new i(e,t,a,function(e,n){e.dataView["set"+r](e.index,n,1),e.add(t)},function(e){var n=e.dataView["get"+r](e.index,1);return e.add(t),n});return n.isBasic=!0,n};l.u8=n("u8","Uint8",1),l.u16=n("u16","Uint16",2),l.u32=n("u32","Uint32",4),l.i8=n("i8","Int8",1),l.i16=n("i16","Int16",2),l.i32=n("i32","Int32",4),l.f32=n("f32","Float32",4),l.f64=n("f64","Float64",8),l.bool=new i("bool",l.u8.byteCount,function(){return!1},function(e,n){l.u8.encode(e,n?1:0)},function(e){return 0!==l.u8.decode(e)}),l.bool.isBasic=!0;l.string=function(a){var o=l.arrayUnmasked(a,l.u8);return new i("s"+a,a,function(){return""},function(e,n){var r,t,i;o.encode(e,(r=n,t=a,i=new Uint8Array(t),r.split("").forEach(function(e,n){i[n]=e.charCodeAt(0)}),i[t-1]=0,i))},function(e){return function(e,n){for(var r="",t=Math.min(e.length,n-1),i=0;i<t;++i){if(0===e[i])return r;r+=String.fromCharCode(e[i])}return r}(o.decode(e),a)})},l.arrayUnmasked=function(e,n){for(var r=[],t=0;t<e;++t)r.push(n);var i=l.tupleUnmasked(r);return i.descriptor="["+n.descriptor+":"+e+"]",i},l.tupleUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.byteCount},0);return new i("("+e.map(function(e){return e.descriptor}).join(",")+")",n,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null),e.forEach(function(e,n){e.encode(r,t[n],i&&i[n])})},function(n){return e.map(function(e){return e.decode(n)})},function(){var t=!1,i={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t=!0,i[n]=r)}),t?i:null})},l.arrayMasked=function(e,n,r){for(var t=[],i=0;i<e;++i)t.push(n);var a=l.tupleMasked(t,r),o=8*(a.byteCount-e*n.byteCount);return a.descriptor="[/"+o+"/"+n.descriptor+":"+e+"]",a},l.tupleMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=l.arrayUnmasked(u,l.u8),r=e.reduce(function(e,n){return e+n.byteCount},u),t=e.map(function(e){return e.descriptor});return new i("(/"+8*u+"/"+t.join(",")+")",r,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null);var a=s(u),o=null;i&&"MASK"in i&&(o=i.MASK),e.forEach(function(e,n){var r=t[n];o&&!o[n]||null!=r&&(a[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,a),e.forEach(function(e,n){f(a,n)&&e.encode(r,t[n],i&&i[n])})},function(r){var t=c.decode(r);return e.map(function(e,n){return f(t,n)?e.decode(r):null})},function(){var t={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t[n]=r)}),t.MASK=e.map(function(){return!0}),t})},l.mapUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.handler.byteCount},0);return new i("{"+e.map(function(e){return e.key+":"+e.handler.descriptor}).join(",")+"}",n,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(n,r,t){!0===t&&(t=null),e.forEach(function(e){e.handler.encode(n,r[e.key],t&&t[e.key])})},function(n){var r={};return e.forEach(function(e){r[e.key]=e.handler.decode(n)}),r},function(){var r=!1,t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r=!0,t[e.key]=n)}),r?t:null})},l.mapMasked=function(e,n){var u=Math.ceil(e.length/8);n&&(u=Math.max(u,Math.ceil(n/8)));var c=l.arrayUnmasked(u,l.u8),r=e.reduce(function(e,n){return e+n.handler.byteCount},u),t=e.map(function(e){return e.key+":"+e.handler.descriptor});return new i("{/"+8*u+"/"+t.join(",")+"}",r,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(r,t,i){!0===i&&(i=null);var a=s(u),o=null;i&&"MASK"in i&&(o=i.MASK),e.forEach(function(e,n){var r=t[e.key];o&&!o[e.key]||null!=r&&(a[Math.floor(n/8)]|=1<<n%8)}),c.encode(r,a),e.forEach(function(e,n){f(a,n)&&e.handler.encode(r,t[e.key],i&&i[e.key])})},function(r){var t=c.decode(r),i={};return e.forEach(function(e,n){f(t,n)?i[e.key]=e.handler.decode(r):i[e.key]=null}),i},function(){var r={},t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r[e.key]=n),t[e.key]=!0}),r.MASK=t,r})},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization._handlers=l}(this),function(u){"use strict";function a(e,n){this.position=e,this.value=n}var c=/^\d+$/,n=/^\w+$/,o={SYMBOL:0,NUMBER:1,NAME:2};function r(e){this.position=e.position,this.value=e.value,c.test(this.value)?(this.category=o.NUMBER,this.value=parseInt(this.value)):n.test(this.value)?this.category=o.NAME:this.category=o.SYMBOL}var l=/^[{}\[\]()\/=:,;\w\s]*$/,t=function(e){if(n=e,!l.test(n))throw new Error("Passed config contains invalid characters");for(var n,r,t=/([{}\[\]()\/=:,;]|\w+)/g,i=[];null!==(r=t.exec(e));)i.push(new a(r.index,r[0]));return i},i=function(e){return e.map(function(e){return new r(e)})},f={NAMED:0,MAP_UNMASKED:2,MAP_MASKED:3,TUPLE_UNMASKED:4,TUPLE_MASKED:5,ARRAY_UNMASKED:6,ARRAY_MASKED:7};function s(e,n,r){this.category=e,this.properties=n,this.mask=r||0}s.prototype.generateHandler=function(n){var e,r=u.FlybrixSerialization._handlers,t=this.properties,i=this.mask,a=null;switch(this.category){case f.NAMED:if("s"===t[0]){var o=t.substring(1);c.test(o)&&(a=r.string(parseInt(o)))}else t in r?(a=r[t]).isBasic||(a=null):t in n&&(a=n[t]);if(!a)throw{position:-1,error:'Unrecognized type "'+t+'"'};return a;case f.MAP_UNMASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapUnmasked(e);case f.MAP_MASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapMasked(e,i);case f.TUPLE_UNMASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleUnmasked(e);case f.TUPLE_MASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleMasked(e,i);case f.ARRAY_UNMASKED:return r.arrayUnmasked(t.count,t.value.generateHandler(n));case f.ARRAY_MASKED:return r.arrayMasked(t.count,t.value.generateHandler(n),i);default:throw{position:-1,error:"Unrecognized type category"}}};var d=function(e){var n=e.dataView[e.index];if(e.add(1),!n)throw{position:-1,error:"Unexpected end of string"};return n},p=function(e){var n=d(e);if(n.category!==o.NAME)throw{position:n.position,error:'Expected name, got: "'+n.value+'"'};if("MASK"===n.value)throw{position:n.position,error:'Disallowed name "MASK" given'};return n.value},h=function(e,n){var r=d(e);if(r.value!==n)throw{position:r.position,error:'Expected "'+n+'", got: "'+r.value+'"'}},v=function(e){var n=d(e);if("/"!==n.value)return e.add(-1),{masked:!1};if("/"===(n=d(e)).value)return{masked:!0,defined:!1};if(n.category!==o.NUMBER)throw{position:n.position,error:'Expected "/" or number'};var r=n.value;if("/"!==(n=d(e)).value)throw{position:n.position,error:'Expected "/"'};return{masked:!0,defined:!0,value:r}},M=function(e){var n=v(e),r=y(e);h(e,":");var t=function(e){var n=d(e);if(n.category!==o.NUMBER)throw{position:n.position,error:'Expected number, got: "'+n.value+'"'};return n.value}(e);h(e,"]");var i={value:r,count:t};return n.masked?n.defined?new s(f.ARRAY_MASKED,i,n.value):new s(f.ARRAY_MASKED,i):new s(f.ARRAY_UNMASKED,i)},y=function(e){var n=d(e);if(!n)throw{position:-1,error:"Unexpected end of string"};if(n.category===o.NUMBER)throw{position:n.position,error:"Unexpected number, type expected"};if(n.category===o.NAME)return new s(f.NAMED,n.value);if("{"===n.value)return function(e){for(var n=v(e),r=[];;){var t=p(e);h(e,":");var i=y(e);r.push({name:t,value:i});var a=d(e);if("}"===a.value)return n.masked?n.defined?new s(f.MAP_MASKED,r,n.value):new s(f.MAP_MASKED,r):new s(f.MAP_UNMASKED,r);if(","!==a.value)throw{position:a.position,error:'Unexpected token after map element: "'+a.value+'"'}}}(e);if("["===n.value)return M(e);if("("===n.value)return function(e){for(var n=v(e),r=[];;){r.push(y(e));var t=d(e);if(")"===t.value)return n.masked?n.defined?new s(f.TUPLE_MASKED,r,n.value):new s(f.TUPLE_MASKED,r):new s(f.TUPLE_UNMASKED,r);if(","!==t.value)throw{position:t.position,error:'Unexpected token after tuple element: "'+t.value+'"'}}}(e);throw{position:n.position,error:'Unexpected token when describing type: "'+n.value+'"'}},E=function(e,n){for(var r=new u.FlybrixSerialization.Serializer(e),t=[];r.index<r.dataView.length;){var i=p(r);if(i[0]!==i[0].toUpperCase())throw{position:-1,error:"Structure names cannot start with lowercase letters"};h(r,"=");var a=y(r);h(r,";"),t.push({name:i,value:a})}return t};u.FlybrixSerialization||(u.FlybrixSerialization={}),u.FlybrixSerialization._parserSteps={tokenizer:t,lexer:i,parser:E,TokenCategories:o,TypeCategories:f,StringToken:a,Token:r,Type:s},u.FlybrixSerialization.parse=function(e){try{return n=E(i(t(e))),r={},n.forEach(function(e){r[e.name]=e.value.generateHandler(r)}),r}catch(e){throw new Error(e.error)}var n,r}}(this),function(e){"use strict";function n(e){this.index=0,this.dataView=e}n.prototype.add=function(e){this.index+=e},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization.Serializer=n}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwicGFyc2VyLmpzIiwic2VyaWFsaXplci5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJudWxsTWFzayIsIkhhbmRsZXIiLCJkZXNjcmlwdG9yIiwiYnl0ZUNvdW50IiwiZW1wdHkiLCJlbmNvZGUiLCJkZWNvZGUiLCJmdWxsTWFzayIsInRoaXMiLCJpc0Jhc2ljIiwiaGFuZGxlcnMiLCJoYXNCaXQiLCJtYXNrIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZW1wdHlOdW1lcmljIiwiemVyb0FycmF5IiwibCIsInJlc3VsdCIsInB1c2giLCJjcmVhdGVOdW1lcmljVHlwZSIsImtleVNob3J0Iiwia2V5IiwiaGFuZGxlciIsInNlcmlhbGl6ZXIiLCJkYXRhIiwiZGF0YVZpZXciLCJpbmRleCIsImFkZCIsInU4IiwidTE2IiwidTMyIiwiaTgiLCJpMTYiLCJpMzIiLCJmMzIiLCJmNjQiLCJib29sIiwic3RyaW5nIiwibGVuZ3RoIiwiYXJyYXlVbm1hc2tlZCIsIm5hbWUiLCJyZXNwb25zZSIsIlVpbnQ4QXJyYXkiLCJzcGxpdCIsImZvckVhY2giLCJjIiwiY2hhckNvZGVBdCIsIm1pbiIsImkiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJhc2NpaURlY29kZSIsImNoaWxkcmVuIiwidHVwbGVVbm1hc2tlZCIsInJlZHVjZSIsImFjY3VtIiwiY2hpbGQiLCJtYXAiLCJqb2luIiwibWFza3MiLCJub25OdWxsQ2hpbGQiLCJ2YWx1ZSIsImFycmF5TWFza2VkIiwibWFza0JpdENvdW50IiwidHVwbGVNYXNrZWQiLCJtYXNrU2l6ZSIsIm1hc2tCeXRlcyIsImNlaWwiLCJtYXgiLCJtYXNrSGFuZGxlciIsImNoaWxkRGVzY3JpcHRvcnMiLCJleHRyYU1hc2siLCJNQVNLIiwiXyIsIm1hcFVubWFza2VkIiwibWFwTWFza2VkIiwiRmx5YnJpeFNlcmlhbGl6YXRpb24iLCJfaGFuZGxlcnMiLCJTdHJpbmdUb2tlbiIsInBvc2l0aW9uIiwibnVtZXJpY1Rlc3QiLCJuYW1lVGVzdCIsIlRva2VuQ2F0ZWdvcmllcyIsIlNZTUJPTCIsIk5VTUJFUiIsIk5BTUUiLCJUb2tlbiIsInN0cmluZ1Rva2VuIiwidGVzdCIsImNhdGVnb3J5IiwicGFyc2VJbnQiLCJ2YWxpZENoYXJTZXRUZXN0IiwidG9rZW5pemVyIiwidGV4dCIsIkVycm9yIiwibWF0Y2giLCJyZSIsIm1hdGNoZXMiLCJleGVjIiwibGV4ZXIiLCJ0b2tlbnMiLCJ0b2tlbiIsIlR5cGVDYXRlZ29yaWVzIiwiTkFNRUQiLCJNQVBfVU5NQVNLRUQiLCJNQVBfTUFTS0VEIiwiVFVQTEVfVU5NQVNLRUQiLCJUVVBMRV9NQVNLRUQiLCJBUlJBWV9VTk1BU0tFRCIsIkFSUkFZX01BU0tFRCIsIlR5cGUiLCJwcm9wZXJ0aWVzIiwicHJvdG90eXBlIiwiZ2VuZXJhdGVIYW5kbGVyIiwibGlicmFyeSIsInByb3BzIiwic3Vic3RyaW5nIiwiZXJyb3IiLCJjb3VudCIsInJlYWRUb2tlbiIsIm5hbWVQYXJzZXIiLCJjb25zdW1lU3ltYm9sIiwic3ltYm9sIiwibWFza1BhcnNlciIsIm1hc2tlZCIsImRlZmluZWQiLCJ0eXBlQXJyYXlQYXJzZXIiLCJ0eXBlUGFyc2VyIiwibnVtYmVyUGFyc2VyIiwidHlwZU1hcFBhcnNlciIsInR5cGVUdXBsZVBhcnNlciIsInBhcnNlciIsInNvdXJjZSIsIlNlcmlhbGl6ZXIiLCJzdHJ1Y3R1cmVzIiwidG9VcHBlckNhc2UiLCJfcGFyc2VyU3RlcHMiLCJwYXJzZSIsInN0cnVjdHVyZSIsImVudHJ5IiwiZXJyIiwiaW5jcmVtZW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLGFBRUEsSUFBQUMsRUFBQSxXQUNBLE9BQUEsTUFHQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBQyxLQUFBTixXQUFBQSxFQUNBTSxLQUFBTCxVQUFBQSxFQUNBSyxLQUFBSCxPQUFBQSxFQUNBRyxLQUFBRixPQUFBQSxFQUNBRSxLQUFBSixNQUFBQSxFQUNB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QSxJQUdBL0UsRUFBQStFLHFCQUFBNEQsYUFBQSxDQUNBNUMsVUFBQUEsRUFDQU8sTUFBQUEsRUFDQWdDLE9BQUFBLEVBQ0FqRCxnQkFBQUEsRUFDQW9CLGVBQUFBLEVBQ0F4QixZQUFBQSxFQUNBUSxNQUFBQSxFQUNBd0IsS0FBQUEsR0FHQWpILEVBQUErRSxxQkFBQTZELE1BdkJBLFNBQUE1QyxHQUNBLElBQ0EsT0FWQTZDLEVBVUFQLEVBQUFoQyxFQUFBUCxFQUFBQyxLQVRBcUIsRUFBQSxHQUNBd0IsRUFBQTlGLFFBQUEsU0FBQStGLEdBQ0F6QixFQUFBeUIsRUFBQW5HLE1BQUFtRyxFQUFBOUUsTUFBQW9ELGdCQUFBQyxLQUVBQSxFQU1BLE1BQUEwQixHQUNBLE1BQUEsSUFBQTlDLE1BQUE4QyxFQUFBdkIsT0FaQSxJQUFBcUIsRUFDQXhCLEdBL1dBLENBK1lBNUcsTUMvWUEsU0FBQVQsR0FDQSxhQUVBLFNBQUF3SSxFQUFBNUcsR0FDQW5CLEtBQUFvQixNQUFBLEVBQ0FwQixLQUFBbUIsU0FBQUEsRUFHQTRHLEVBQUFyQixVQUFBckYsSUFBQSxTQUFBa0gsR0FDQXZJLEtBQUFvQixPQUFBbUgsR0FHQWhKLEVBQUErRSx1QkFDQS9FLEVBQUErRSxxQkFBQSxJQUVBL0UsRUFBQStFLHFCQUFBeUQsV0FBQUEsRUFmQSxDQWlCQS9IIiwiZmlsZSI6ImZseWJyaXgtc2VyaWFsaXphdGlvbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBudWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spIHtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0b3IgPSBkZXNjcmlwdG9yO1xyXG4gICAgICAgIHRoaXMuYnl0ZUNvdW50ID0gYnl0ZUNvdW50O1xyXG4gICAgICAgIHRoaXMuZW5jb2RlID0gZW5jb2RlO1xyXG4gICAgICAgIHRoaXMuZGVjb2RlID0gZGVjb2RlO1xyXG4gICAgICAgIHRoaXMuZW1wdHkgPSBlbXB0eTtcclxuICAgICAgICB0aGlzLmZ1bGxNYXNrID0gZnVsbE1hc2sgfHwgbnVsbE1hc2s7XHJcbiAgICAgICAgdGhpcy5pc0Jhc2ljID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGhhbmRsZXJzID0ge307XHJcblxyXG4gICAgdmFyIGhhc0JpdCA9IGZ1bmN0aW9uIChtYXNrLCBpZHgpIHtcclxuICAgICAgICByZXR1cm4gKG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gJiAoMSA8PCAoaWR4ICUgOCkpKSAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGVtcHR5TnVtZXJpYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHplcm9BcnJheSA9IGZ1bmN0aW9uIChsKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGw7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlTnVtZXJpY1R5cGUgPSBmdW5jdGlvbiAoa2V5U2hvcnQsIGtleSwgYnl0ZUNvdW50KSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ3NldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIGRhdGEsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ2dldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBIYW5kbGVyKGtleVNob3J0LCBieXRlQ291bnQsIGVtcHR5TnVtZXJpYywgZW5jb2RlLCBkZWNvZGUpO1xyXG5cclxuICAgICAgICBoYW5kbGVyLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudTggPSBjcmVhdGVOdW1lcmljVHlwZSgndTgnLCAnVWludDgnLCAxKTtcclxuICAgIGhhbmRsZXJzLnUxNiA9IGNyZWF0ZU51bWVyaWNUeXBlKCd1MTYnLCAnVWludDE2JywgMik7XHJcbiAgICBoYW5kbGVycy51MzIgPSBjcmVhdGVOdW1lcmljVHlwZSgndTMyJywgJ1VpbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuaTggPSBjcmVhdGVOdW1lcmljVHlwZSgnaTgnLCAnSW50OCcsIDEpO1xyXG4gICAgaGFuZGxlcnMuaTE2ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kxNicsICdJbnQxNicsIDIpO1xyXG4gICAgaGFuZGxlcnMuaTMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kzMicsICdJbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuZjMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2YzMicsICdGbG9hdDMyJywgNCk7XHJcbiAgICBoYW5kbGVycy5mNjQgPSBjcmVhdGVOdW1lcmljVHlwZSgnZjY0JywgJ0Zsb2F0NjQnLCA4KTtcclxuXHJcbiAgICBoYW5kbGVycy5ib29sID0gbmV3IEhhbmRsZXIoXHJcbiAgICAgICAgJ2Jvb2wnLFxyXG4gICAgICAgIGhhbmRsZXJzLnU4LmJ5dGVDb3VudCxcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCBkYXRhID8gMSA6IDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKSAhPT0gMDtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLmJvb2wuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgdmFyIGFzY2lpRW5jb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XHJcbiAgICAgICAgbmFtZS5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbiAoYywgaWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3BvbnNlW2lkeF0gPSBjLmNoYXJDb2RlQXQoMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVzcG9uc2VbbGVuZ3RoIC0gMV0gPSAwO1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGFzY2lpRGVjb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9ICcnO1xyXG4gICAgICAgIHZhciBsID0gTWF0aC5taW4obmFtZS5sZW5ndGgsIGxlbmd0aCAtIDEpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChuYW1lW2ldID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzcG9uc2UgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShuYW1lW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5zdHJpbmcgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKGxlbmd0aCwgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICBoYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBhc2NpaUVuY29kZShkYXRhLCBsZW5ndGgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICByZXR1cm4gYXNjaWlEZWNvZGUoaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplciksIGxlbmd0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcigncycgKyBsZW5ndGgsIGxlbmd0aCwgZW1wdHksIGVuY29kZSwgZGVjb2RlKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMuYXJyYXlVbm1hc2tlZCA9IGZ1bmN0aW9uIChsZW5ndGgsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBoYW5kbGVycy50dXBsZVVubWFza2VkKGNoaWxkcmVuKTtcclxuICAgICAgICByZXN1bHQuZGVzY3JpcHRvciA9ICdbJyArIGhhbmRsZXIuZGVzY3JpcHRvciArICc6JyArIGxlbmd0aCArICddJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy50dXBsZVVubWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtpZHhdLCBtYXNrcyAmJiBtYXNrc1tpZHhdKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbm9uTnVsbENoaWxkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vbk51bGxDaGlsZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghbm9uTnVsbENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAnKCcgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICcpJztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMuYXJyYXlNYXNrZWQgPSBmdW5jdGlvbiAobGVuZ3RoLCBoYW5kbGVyLCBtYXNrQml0Q291bnQpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBoYW5kbGVycy50dXBsZU1hc2tlZChjaGlsZHJlbiwgbWFza0JpdENvdW50KTtcclxuICAgICAgICB2YXIgbWFza1NpemUgPSAocmVzdWx0LmJ5dGVDb3VudCAtIChsZW5ndGggKiBoYW5kbGVyLmJ5dGVDb3VudCkpICogODtcclxuICAgICAgICByZXN1bHQuZGVzY3JpcHRvciA9ICdbLycgKyBtYXNrU2l6ZSArICcvJyArIGhhbmRsZXIuZGVzY3JpcHRvciArICc6JyArIGxlbmd0aCArICddJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy50dXBsZU1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbiwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIG1hc2tCeXRlcyA9IE1hdGguY2VpbChjaGlsZHJlbi5sZW5ndGggLyA4KTtcclxuICAgICAgICBpZiAobWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgICAgIG1hc2tCeXRlcyA9IE1hdGgubWF4KG1hc2tCeXRlcywgTWF0aC5jZWlsKG1hc2tCaXRDb3VudCAvIDgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hc2tIYW5kbGVyID0gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChtYXNrQnl0ZXMsIGhhbmRsZXJzLnU4KTtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gemVyb0FycmF5KG1hc2tCeXRlcyk7XHJcbiAgICAgICAgICAgIHZhciBleHRyYU1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobWFza3MgJiYgKCdNQVNLJyBpbiBtYXNrcykpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhTWFzayA9IG1hc2tzLk1BU0s7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoXywgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhW2lkeF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZXh0cmFNYXNrICYmICFleHRyYU1hc2tbaWR4XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFza1tNYXRoLmZsb29yKGlkeCAvIDgpXSB8PSAxIDw8IChpZHggJSA4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtYXNrSGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgbWFzayk7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2lkeF0sIG1hc2tzICYmIG1hc2tzW2lkeF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IG1hc2tIYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5NQVNLID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgbWFza0J5dGVzKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAnKC8nICsgKG1hc2tCeXRlcyAqIDgpICsgJy8nICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnKSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLm1hcFVubWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQuaGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtjaGlsZC5rZXldLCBtYXNrcyAmJiBtYXNrc1tjaGlsZC5rZXldKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG5vbk51bGxDaGlsZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5oYW5kbGVyLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBub25OdWxsQ2hpbGQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIW5vbk51bGxDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5oYW5kbGVyLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmtleSArICc6JyArIGNoaWxkLmhhbmRsZXIuZGVzY3JpcHRvcjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9ICd7JyArIGNoaWxkRGVzY3JpcHRvcnMuam9pbignLCcpICsgJ30nO1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2spO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5tYXBNYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4sIG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgIHZhciBtYXNrQnl0ZXMgPSBNYXRoLmNlaWwoY2hpbGRyZW4ubGVuZ3RoIC8gOCk7XHJcbiAgICAgICAgaWYgKG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgICAgICBtYXNrQnl0ZXMgPSBNYXRoLm1heChtYXNrQnl0ZXMsIE1hdGguY2VpbChtYXNrQml0Q291bnQgLyA4KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXNrSGFuZGxlciA9IGhhbmRsZXJzLmFycmF5VW5tYXNrZWQobWFza0J5dGVzLCBoYW5kbGVycy51OCk7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbWFzayA9IHplcm9BcnJheShtYXNrQnl0ZXMpO1xyXG4gICAgICAgICAgICB2YXIgZXh0cmFNYXNrID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKG1hc2tzICYmICgnTUFTSycgaW4gbWFza3MpKSB7XHJcbiAgICAgICAgICAgICAgICBleHRyYU1hc2sgPSBtYXNrcy5NQVNLO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhW2NoaWxkLmtleV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZXh0cmFNYXNrICYmICFleHRyYU1hc2tbY2hpbGQua2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFza1tNYXRoLmZsb29yKGlkeCAvIDgpXSB8PSAxIDw8IChpZHggJSA4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtYXNrSGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgbWFzayk7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmhhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbY2hpbGQua2V5XSwgbWFza3MgJiYgbWFza3NbY2hpbGQua2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0hhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuaGFuZGxlci5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG1hc2tbY2hpbGQua2V5XSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXN1bHQuTUFTSyA9IG1hc2s7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gY2hpbGRyZW4ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY2hpbGQuaGFuZGxlci5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgbWFza0J5dGVzKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmtleSArICc6JyArIGNoaWxkLmhhbmRsZXIuZGVzY3JpcHRvcjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9ICd7LycgKyAobWFza0J5dGVzICogOCkgKyAnLycgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICd9JztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24pIHtcclxuICAgICAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24gPSB7fTtcclxuICAgIH1cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5faGFuZGxlcnMgPSBoYW5kbGVycztcclxuXHJcbn0odGhpcykpO1xyXG4iLCIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGZ1bmN0aW9uIFN0cmluZ1Rva2VuKHBvc2l0aW9uLCB2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG51bWVyaWNUZXN0ID0gL15cXGQrJC87XHJcbiAgICB2YXIgbmFtZVRlc3QgPSAvXlxcdyskLztcclxuXHJcbiAgICB2YXIgVG9rZW5DYXRlZ29yaWVzID0ge1xyXG4gICAgICAgIFNZTUJPTDogMCxcclxuICAgICAgICBOVU1CRVI6IDEsXHJcbiAgICAgICAgTkFNRTogMixcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gVG9rZW4oc3RyaW5nVG9rZW4pIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gc3RyaW5nVG9rZW4ucG9zaXRpb247XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHN0cmluZ1Rva2VuLnZhbHVlO1xyXG4gICAgICAgIGlmIChudW1lcmljVGVzdC50ZXN0KHRoaXMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSO1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gcGFyc2VJbnQodGhpcy52YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lVGVzdC50ZXN0KHRoaXMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBUb2tlbkNhdGVnb3JpZXMuTkFNRTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLlNZTUJPTDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHZhbGlkQ2hhclNldFRlc3QgPSAvXlt7fVxcW1xcXSgpXFwvPTosO1xcd1xcc10qJC87XHJcblxyXG4gICAgdmFyIGlzVmFsaWQgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHJldHVybiB2YWxpZENoYXJTZXRUZXN0LnRlc3QodGV4dCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0b2tlbml6ZXIgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIGlmICghaXNWYWxpZCh0ZXh0KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3NlZCBjb25maWcgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZSA9IC8oW3t9XFxbXFxdKClcXC89Oiw7XXxcXHcrKS9nO1xyXG4gICAgICAgIHZhciBtYXRjaDtcclxuICAgICAgICB2YXIgbWF0Y2hlcyA9IFtdO1xyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZS5leGVjKHRleHQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtYXRjaGVzLnB1c2gobmV3IFN0cmluZ1Rva2VuKG1hdGNoLmluZGV4LCBtYXRjaFswXSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF0Y2hlcztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGxleGVyID0gZnVuY3Rpb24gKHRva2Vucykge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMubWFwKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRva2VuKHRva2VuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIFR5cGVDYXRlZ29yaWVzID0ge1xyXG4gICAgICAgIE5BTUVEOiAwLFxyXG4gICAgICAgIE1BUF9VTk1BU0tFRDogMixcclxuICAgICAgICBNQVBfTUFTS0VEOiAzLFxyXG4gICAgICAgIFRVUExFX1VOTUFTS0VEOiA0LFxyXG4gICAgICAgIFRVUExFX01BU0tFRDogNSxcclxuICAgICAgICBBUlJBWV9VTk1BU0tFRDogNixcclxuICAgICAgICBBUlJBWV9NQVNLRUQ6IDcsXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFR5cGUoY2F0ZWdvcnksIHByb3BlcnRpZXMsIG1hc2spIHtcclxuICAgICAgICB0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcclxuICAgICAgICB0aGlzLm1hc2sgPSBtYXNrIHx8IDA7XHJcbiAgICB9XHJcblxyXG4gICAgVHlwZS5wcm90b3R5cGUuZ2VuZXJhdGVIYW5kbGVyID0gZnVuY3Rpb24gKGxpYnJhcnkpIHtcclxuICAgICAgICB2YXIgaGFuZGxlcnMgPSBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uX2hhbmRsZXJzO1xyXG4gICAgICAgIHZhciBwcm9wcyA9IHRoaXMucHJvcGVydGllcztcclxuICAgICAgICB2YXIgbWFzayA9IHRoaXMubWFzaztcclxuICAgICAgICB2YXIgaGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5jYXRlZ29yeSkge1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk5BTUVEOlxyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BzWzBdID09PSAncycpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gcHJvcHMuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudW1lcmljVGVzdC50ZXN0KGxlbmd0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJzLnN0cmluZyhwYXJzZUludChsZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzIGluIGhhbmRsZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJzW3Byb3BzXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIuaXNCYXNpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzIGluIGxpYnJhcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gbGlicmFyeVtwcm9wc107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbnJlY29nbml6ZWQgdHlwZSBcIicgKyBwcm9wcyArICdcIicsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVyO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk1BUF9VTk1BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogY2hpbGQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogY2hpbGQudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5tYXBVbm1hc2tlZChjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuTUFQX01BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogY2hpbGQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogY2hpbGQudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5tYXBNYXNrZWQoY2hpbGRyZW4sIG1hc2spO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLlRVUExFX1VOTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnR1cGxlVW5tYXNrZWQoY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy50dXBsZU1hc2tlZChjaGlsZHJlbiwgbWFzayk7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuQVJSQVlfVU5NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChwcm9wcy5jb3VudCwgcHJvcHMudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMuYXJyYXlNYXNrZWQocHJvcHMuY291bnQsIHByb3BzLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSwgbWFzayk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5yZWNvZ25pemVkIHR5cGUgY2F0ZWdvcnknLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciByZWFkVG9rZW4gPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbc2VyaWFsaXplci5pbmRleF07XHJcbiAgICAgICAgc2VyaWFsaXplci5hZGQoMSk7XHJcbiAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgZW5kIG9mIHN0cmluZycsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbjtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG5hbWVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgIT09IFRva2VuQ2F0ZWdvcmllcy5OQU1FKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgbmFtZSwgZ290OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ01BU0snKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRGlzYWxsb3dlZCBuYW1lIFwiTUFTS1wiIGdpdmVuJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuLnZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbnVtYmVyUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgbnVtYmVyLCBnb3Q6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuLnZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY29uc3VtZVN5bWJvbCA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBzeW1ib2wpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSBzeW1ib2wpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBcIicgKyBzeW1ib2wgKyAnXCIsIGdvdDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIG1hc2tQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIFwiLy9cIiBvciBcIi88TlVNQkVSPi9cIiwgb3RoZXJ3aXNlIHRoZXJlIGlzIG5vIG1hc2tcclxuICAgICAgICAvLyBMYWJlbGVkIHdpdGggPE1BU0s+IGluIGNvbW1lbnRzIGJlbG93XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuYWRkKC0xKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG1hc2tlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXNrZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBkZWZpbmVkOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCIvXCIgb3IgbnVtYmVyJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdG9rZW4udmFsdWU7XHJcbiAgICAgICAgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLycpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBcIi9cIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG1hc2tlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZGVmaW5lZDogdHJ1ZSxcclxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlTWFwUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyB7PE1BU0s+IDxOQU1FPjo8VFlQRT4sIDxOQU1FPjo8VFlQRT4sIDxOQU1FPjo8VFlQRT59XHJcbiAgICAgICAgdmFyIG1hc2sgPSBtYXNrUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmFtZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnOicpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ30nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWFzay5tYXNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFzay5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfTUFTS0VELCBjaGlsZHJlbiwgbWFzay52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk1BUF9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfVU5NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcsJykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgdG9rZW4gYWZ0ZXIgbWFwIGVsZW1lbnQ6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlVHVwbGVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vICg8TUFTSz4gPFRZUEU+LCA8VFlQRT4sIDxUWVBFPilcclxuICAgICAgICB2YXIgbWFzayA9IG1hc2tQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpKTtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcpJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuVFVQTEVfTUFTS0VELCBjaGlsZHJlbiwgbWFzay52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLCcpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIGFmdGVyIHR1cGxlIGVsZW1lbnQ6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlQXJyYXlQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIFs8TUFTSz4gPFRZUEU+OjxOVU1CRVI+XVxyXG4gICAgICAgIHZhciBtYXNrID0gbWFza1BhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJzonKTtcclxuICAgICAgICB2YXIgY291bnQgPSBudW1iZXJQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnXScpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICBjb3VudDogY291bnQsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAobWFzay5tYXNrZWQpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX01BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZVBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gT3B0aW9uczpcclxuICAgICAgICAvLyAtIDxOQU1FPlxyXG4gICAgICAgIC8vIC0gVHVwbGVcclxuICAgICAgICAvLyAtIEFycmF5XHJcbiAgICAgICAgLy8gLSBNYXBcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgZW5kIG9mIHN0cmluZycsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSA9PT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgbnVtYmVyLCB0eXBlIGV4cGVjdGVkJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ID09PSBUb2tlbkNhdGVnb3JpZXMuTkFNRSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTkFNRUQsIHRva2VuLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAneycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVNYXBQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ1snKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlQXJyYXlQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJygnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlVHVwbGVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgdG9rZW4gd2hlbiBkZXNjcmliaW5nIHR5cGU6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGFyc2VyID0gZnVuY3Rpb24gKHRva2Vucywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLlNlcmlhbGl6ZXIodG9rZW5zKTtcclxuICAgICAgICB2YXIgc3RydWN0dXJlcyA9IFtdO1xyXG4gICAgICAgIHdoaWxlIChzZXJpYWxpemVyLmluZGV4IDwgc2VyaWFsaXplci5kYXRhVmlldy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAobmFtZVswXSAhPT0gbmFtZVswXS50b1VwcGVyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnU3RydWN0dXJlIG5hbWVzIGNhbm5vdCBzdGFydCB3aXRoIGxvd2VyY2FzZSBsZXR0ZXJzJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnPScpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc7Jyk7XHJcbiAgICAgICAgICAgIHN0cnVjdHVyZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cnVjdHVyZXM7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBjcmVhdGVIYW5kbGVycyA9IGZ1bmN0aW9uIChzdHJ1Y3R1cmUpIHtcclxuICAgICAgICB2YXIgbGlicmFyeSA9IHt9O1xyXG4gICAgICAgIHN0cnVjdHVyZS5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkge1xyXG4gICAgICAgICAgICBsaWJyYXJ5W2VudHJ5Lm5hbWVdID0gZW50cnkudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBsaWJyYXJ5O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGFyc2UgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVIYW5kbGVycyhwYXJzZXIobGV4ZXIodG9rZW5pemVyKHRleHQpLCB0ZXh0KSwgdGV4dCkpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyLmVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLl9wYXJzZXJTdGVwcyA9IHtcclxuICAgICAgICB0b2tlbml6ZXI6IHRva2VuaXplcixcclxuICAgICAgICBsZXhlcjogbGV4ZXIsXHJcbiAgICAgICAgcGFyc2VyOiBwYXJzZXIsXHJcbiAgICAgICAgVG9rZW5DYXRlZ29yaWVzOiBUb2tlbkNhdGVnb3JpZXMsXHJcbiAgICAgICAgVHlwZUNhdGVnb3JpZXM6IFR5cGVDYXRlZ29yaWVzLFxyXG4gICAgICAgIFN0cmluZ1Rva2VuOiBTdHJpbmdUb2tlbixcclxuICAgICAgICBUb2tlbjogVG9rZW4sXHJcbiAgICAgICAgVHlwZTogVHlwZSxcclxuICAgIH07XHJcblxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLnBhcnNlID0gcGFyc2U7XHJcblxyXG59KHRoaXMpKTtcclxuIiwiKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBmdW5jdGlvbiBTZXJpYWxpemVyKGRhdGFWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5pbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5kYXRhVmlldyA9IGRhdGFWaWV3O1xyXG4gICAgfVxyXG5cclxuICAgIFNlcmlhbGl6ZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChpbmNyZW1lbnQpIHtcclxuICAgICAgICB0aGlzLmluZGV4ICs9IGluY3JlbWVudDtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24pIHtcclxuICAgICAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24gPSB7fTtcclxuICAgIH1cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5TZXJpYWxpemVyID0gU2VyaWFsaXplcjtcclxuXHJcbn0odGhpcykpO1xyXG4iXX0=
