!function(n){"use strict";var c=function(){return null},l=function(){return[]},f=function(n){return null==n};function s(n,e,r,t,i,o,a,u){this.descriptor=n,this.byteCount=e,this.encode=t,this.decode=i,this.empty=r,this.fullMask=o||c,this.maskArray=a||l,this.isNull=u||f}var d={},h=function(n,e){return 0!=(n[Math.floor(e/8)]&1<<e%8)},i=function(){return 0},v=function(n){for(var e=[],r=0;r<n;++r)e.push(0);return e},e=function(n,r,t){var e=new s(n,t,i,function(n,e){n.dataView["set"+r](n.index,e,1),n.add(t)},function(n){var e=n.dataView["get"+r](n.index,1);return n.add(t),e});return e.isBasic=!0,e};d.u8=e("u8","Uint8",1),d.u16=e("u16","Uint16",2),d.u32=e("u32","Uint32",4),d.i8=e("i8","Int8",1),d.i16=e("i16","Int16",2),d.i32=e("i32","Int32",4),d.f32=e("f32","Float32",4),d.f64=e("f64","Float64",8),d.bool=new s("bool",d.u8.byteCount,function(){return!1},function(n,e){d.u8.encode(n,e?1:0)},function(n){return 0!==d.u8.decode(n)}),d.bool.isBasic=!0,d.void=new s("void",0,function(){return!0},function(n,e){},function(){return!0},null,null,function(n){return!n}),d.void.isBasic=!0;d.string=function(o){var a=d.arrayUnmasked(o,d.u8);return new s("s"+o,o,function(){return""},function(n,e){var r,t,i;a.encode(n,(r=e,t=o,i=new Uint8Array(t),r.split("").forEach(function(n,e){i[e]=n.charCodeAt(0)}),i[t-1]=0,i))},function(n){return function(n,e){for(var r="",t=Math.min(n.length,e-1),i=0;i<t;++i){if(0===n[i])return r;r+=String.fromCharCode(n[i])}return r}(a.decode(n),o)})},d.s=new s("s",0,function(){return""},function(n,e){for(var r=Math.min(e.length,n.dataView.byteLength-n.index),t=0;t<r;++t)d.u8.encode(n,e.charCodeAt(t));n.index<n.dataView.byteLength&&d.u8.encode(n,0)},function(n){for(var e="",r=n.dataView.byteLength-n.index;0<r--;){var t=d.u8.decode(n);if(!t)return e;e+=String.fromCharCode(t)}return e}),d.s.isBasic=!0,d.arrayUnmasked=function(n,e){for(var r=[],t=0;t<n;++t)r.push(e);var i=d.tupleUnmasked(r);return i.descriptor="["+e.descriptor+":"+n+"]",i},d.tupleUnmasked=function(n){var e=n.reduce(function(n,e){return n+e.byteCount},0);return new s("("+n.map(function(n){return n.descriptor}).join(",")+")",e,function(){return n.map(function(n){return n.empty()})},function(r,t,i){!0===i&&(i=null),n.forEach(function(n,e){n.encode(r,t[e],i&&i[e])})},function(e){return n.map(function(n){return n.decode(e)})},function(){var t=!1,i={};return n.forEach(function(n,e){var r=n.fullMask();null!==r&&(t=!0,i[e]=r)}),t?i:null})},d.arrayMasked=function(n,e,r){for(var t=[],i=0;i<n;++i)t.push(e);var o=d.tupleMasked(t,r),a=8*(o.byteCount-n*e.byteCount);return o.descriptor="[/"+a+"/"+e.descriptor+":"+n+"]",o},d.tupleMasked=function(e,n){var r=Math.ceil(e.length/8);n&&(r=Math.max(r,Math.ceil(n/8)));var a=d.arrayUnmasked(r,d.u8),u=function(t,n){!0===n&&(n=null);var i=v(r),o=null;return n&&"MASK"in n&&(o=n.MASK),e.forEach(function(n,e){var r=t[e];o&&!o[e]||n.isNull(r)||(i[Math.floor(e/8)]|=1<<e%8)}),i},t=e.reduce(function(n,e){return n+e.byteCount},r),i=e.map(function(n){return n.descriptor});return new s("(/"+8*r+"/"+i.join(",")+")",t,function(){return e.map(function(n){return n.empty()})},function(r,t,i){var o=u(t,i);a.encode(r,o),e.forEach(function(n,e){h(o,e)&&n.encode(r,t[e],i&&i[e])})},function(r){var t=a.decode(r);return e.map(function(n,e){return h(t,e)?n.decode(r):null})},function(){var t={};return e.forEach(function(n,e){var r=n.fullMask();null!==r&&(t[e]=r)}),t.MASK=e.map(function(){return!0}),t},u)},d.mapUnmasked=function(n){var e=n.reduce(function(n,e){return n+e.handler.byteCount},0);return new s("{"+n.map(function(n){return n.key+":"+n.handler.descriptor}).join(",")+"}",e,function(){var e={};return n.forEach(function(n){e[n.key]=n.handler.empty()}),e},function(e,r,t){!0===t&&(t=null),n.forEach(function(n){n.handler.encode(e,r[n.key],t&&t[n.key])})},function(e){var r={};return n.forEach(function(n){r[n.key]=n.handler.decode(e)}),r},function(){var r=!1,t={};return n.forEach(function(n){var e=n.handler.fullMask();null!==e&&(r=!0,t[n.key]=e)}),r?t:null})},d.mapMasked=function(a,n){var e=Math.ceil(a.length/8);n&&(e=Math.max(e,Math.ceil(n/8)));var u=d.arrayUnmasked(e,d.u8),c=function(t,n){!0===n&&(n=null);var i=v(e),o=null;return n&&"MASK"in n&&(o=n.MASK),a.forEach(function(n,e){var r=t[n.key];o&&!o[n.key]||n.handler.isNull(r)||(i[Math.floor(e/8)]|=1<<e%8)}),i},r=a.reduce(function(n,e){return n+e.handler.byteCount},e),t=a.map(function(n){return n.key+":"+n.handler.descriptor});return new s("{/"+8*e+"/"+t.join(",")+"}",r,function(){var e={};return a.forEach(function(n){e[n.key]=n.handler.empty()}),e},function(r,t,i){var o=c(t,i);u.encode(r,o),a.forEach(function(n,e){h(o,e)&&n.handler.encode(r,t[n.key],i&&i[n.key])})},function(r){var t=u.decode(r),i={};return a.forEach(function(n,e){h(t,e)&&(i[n.key]=n.handler.decode(r))}),i},function(){var r={},t={};return a.forEach(function(n){var e=n.handler.fullMask();null!==e&&(r[n.key]=e),t[n.key]=!0}),r.MASK=t,r},c)},n.FlybrixSerialization||(n.FlybrixSerialization={}),n.FlybrixSerialization._handlers=d}(this),function(u){"use strict";function o(n,e){this.position=n,this.value=e}var c=/^\d+$/,e=/^\w+$/,a={SYMBOL:0,NUMBER:1,NAME:2};function r(n){this.position=n.position,this.value=n.value,c.test(this.value)?(this.category=a.NUMBER,this.value=parseInt(this.value)):e.test(this.value)?this.category=a.NAME:this.category=a.SYMBOL}var l=/^[{}\[\]()\/=:,;\w\s]*$/,t=function(n){if(e=n,!l.test(e))throw new Error("Passed config contains invalid characters");for(var e,r,t=/([{}\[\]()\/=:,;]|\w+)/g,i=[];null!==(r=t.exec(n));)i.push(new o(r.index,r[0]));return i},i=function(n){return n.map(function(n){return new r(n)})},f={NAMED:0,MAP_UNMASKED:2,MAP_MASKED:3,TUPLE_UNMASKED:4,TUPLE_MASKED:5,ARRAY_UNMASKED:6,ARRAY_MASKED:7};function s(n,e,r){this.category=n,this.properties=e,this.mask=r||0}s.prototype.generateHandler=function(e){var n,r=u.FlybrixSerialization._handlers,t=this.properties,i=this.mask,o=null;switch(this.category){case f.NAMED:if(t in r)(o=r[t]).isBasic||(o=null);else if("s"===t[0]){var a=t.substring(1);c.test(a)&&(o=r.string(parseInt(a)))}else t in e&&(o=e[t]);if(!o)throw{position:-1,error:'Unrecognized type "'+t+'"'};return o;case f.MAP_UNMASKED:return n=t.map(function(n){return{key:n.name,handler:n.value.generateHandler(e)}}),r.mapUnmasked(n);case f.MAP_MASKED:return n=t.map(function(n){return{key:n.name,handler:n.value.generateHandler(e)}}),r.mapMasked(n,i);case f.TUPLE_UNMASKED:return n=t.map(function(n){return n.generateHandler(e)}),r.tupleUnmasked(n);case f.TUPLE_MASKED:return n=t.map(function(n){return n.generateHandler(e)}),r.tupleMasked(n,i);case f.ARRAY_UNMASKED:return r.arrayUnmasked(t.count,t.value.generateHandler(e));case f.ARRAY_MASKED:return r.arrayMasked(t.count,t.value.generateHandler(e),i);default:throw{position:-1,error:"Unrecognized type category"}}};var d=function(n){var e=n.dataView[n.index];if(n.add(1),!e)throw{position:-1,error:"Unexpected end of string"};return e},h=function(n){var e=d(n);if(e.category!==a.NAME)throw{position:e.position,error:'Expected name, got: "'+e.value+'"'};if("MASK"===e.value)throw{position:e.position,error:'Disallowed name "MASK" given'};return e.value},v=function(n,e){var r=d(n);if(r.value!==e)throw{position:r.position,error:'Expected "'+e+'", got: "'+r.value+'"'}},p=function(n){var e=d(n);if("/"!==e.value)return n.add(-1),{masked:!1};if("/"===(e=d(n)).value)return{masked:!0,defined:!1};if(e.category!==a.NUMBER)throw{position:e.position,error:'Expected "/" or number'};var r=e.value;if("/"!==(e=d(n)).value)throw{position:e.position,error:'Expected "/"'};return{masked:!0,defined:!0,value:r}},y=function(n){var e=p(n),r=M(n);v(n,":");var t=function(n){var e=d(n);if(e.category!==a.NUMBER)throw{position:e.position,error:'Expected number, got: "'+e.value+'"'};return e.value}(n);v(n,"]");var i={value:r,count:t};return e.masked?e.defined?new s(f.ARRAY_MASKED,i,e.value):new s(f.ARRAY_MASKED,i):new s(f.ARRAY_UNMASKED,i)},M=function(n){var e=d(n);if(!e)throw{position:-1,error:"Unexpected end of string"};if(e.category===a.NUMBER)throw{position:e.position,error:"Unexpected number, type expected"};if(e.category===a.NAME)return new s(f.NAMED,e.value);if("{"===e.value)return function(n){for(var e=p(n),r=[];;){var t=h(n);v(n,":");var i=M(n);r.push({name:t,value:i});var o=d(n);if("}"===o.value)return e.masked?e.defined?new s(f.MAP_MASKED,r,e.value):new s(f.MAP_MASKED,r):new s(f.MAP_UNMASKED,r);if(","!==o.value)throw{position:o.position,error:'Unexpected token after map element: "'+o.value+'"'}}}(n);if("["===e.value)return y(n);if("("===e.value)return function(n){for(var e=p(n),r=[];;){r.push(M(n));var t=d(n);if(")"===t.value)return e.masked?e.defined?new s(f.TUPLE_MASKED,r,e.value):new s(f.TUPLE_MASKED,r):new s(f.TUPLE_UNMASKED,r);if(","!==t.value)throw{position:t.position,error:'Unexpected token after tuple element: "'+t.value+'"'}}}(n);throw{position:e.position,error:'Unexpected token when describing type: "'+e.value+'"'}},E=function(n,e){for(var r=new u.FlybrixSerialization.Serializer(n),t=[];r.index<r.dataView.length;){var i=h(r);if(i[0]!==i[0].toUpperCase())throw{position:-1,error:"Structure names cannot start with lowercase letters"};v(r,"=");var o=M(r);v(r,";"),t.push({name:i,value:o})}return t};u.FlybrixSerialization||(u.FlybrixSerialization={}),u.FlybrixSerialization._parserSteps={tokenizer:t,lexer:i,parser:E,TokenCategories:a,TypeCategories:f,StringToken:o,Token:r,Type:s},u.FlybrixSerialization.parse=function(n){try{return e=E(i(t(n))),r={},e.forEach(function(n){r[n.name]=n.value.generateHandler(r)}),r}catch(n){throw new Error(n.error)}var e,r}}(this),function(n){"use strict";function e(n){this.index=0,this.dataView=n}e.prototype.add=function(n){this.index+=n},n.FlybrixSerialization||(n.FlybrixSerialization={}),n.FlybrixSerialization.Serializer=e}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwicGFyc2VyLmpzIiwic2VyaWFsaXplci5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJudWxsTWFzayIsIm51bGxNYXNrQXJyYXkiLCJkZWZhdWx0SXNOdWxsIiwidmFsIiwiSGFuZGxlciIsImRlc2NyaXB0b3IiLCJieXRlQ291bnQiLCJlbXB0eSIsImVuY29kZSIsImRlY29kZSIsImZ1bGxNYXNrIiwibWFza0FycmF5IiwiaXNOdWxsIiwidGhpcyIsImhhbmRsZXJzIiwiaGFzQml0IiwibWFzayIsImlkeCIsIk1hdGgiLCJmbG9vciIsImVtcHR5TnVtZXJpYyIsInplcm9BcnJheSIsImwiLCJyZXN1bHQiLCJwdXNoIiwiY3JlYXRlTnVtZXJpY1R5cGUiLCJrZXlTaG9ydCIsImtleSIsImhhbmRsZXIiLCJzZXJpYWxpemVyIiwiZGF0YSIsImRhdGFWaWV3IiwiaW5kZXgiLCJhZGQiLCJpc0Jhc2ljIiwidTgiLCJ1MTYiLCJ1MzIiLCJpOCIsImkxNiIsImkzMiIsImYzMiIsImY2NCIsImJvb2wiLCJ2b2lkIiwic3RyaW5nIiwibGVuZ3RoIiwiYXJyYXlVbm1hc2tlZCIsIm5hbWUiLCJyZXNwb25zZSIsIlVpbnQ4QXJyYXkiLCJzcGxpdCIsImZvckVhY2giLCJjIiwiY2hhckNvZGVBdCIsIm1pbiIsImkiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJhc2NpaURlY29kZSIsInMiLCJieXRlTGVuZ3RoIiwiY2hhckNvZGUiLCJjaGlsZHJlbiIsInR1cGxlVW5tYXNrZWQiLCJyZWR1Y2UiLCJhY2N1bSIsImNoaWxkIiwibWFwIiwiam9pbiIsIm1hc2tzIiwibm9uTnVsbENoaWxkIiwidmFsdWUiLCJhcnJheU1hc2tlZCIsIm1hc2tCaXRDb3VudCIsInR1cGxlTWFza2VkIiwibWFza1NpemUiLCJtYXNrQnl0ZXMiLCJjZWlsIiwibWF4IiwibWFza0hhbmRsZXIiLCJleHRyYU1hc2siLCJNQVNLIiwiY2hpbGREZXNjcmlwdG9ycyIsIm1hcFVubWFza2VkIiwibWFwTWFza2VkIiwiRmx5YnJpeFNlcmlhbGl6YXRpb24iLCJfaGFuZGxlcnMiLCJTdHJpbmdUb2tlbiIsInBvc2l0aW9uIiwibnVtZXJpY1Rlc3QiLCJuYW1lVGVzdCIsIlRva2VuQ2F0ZWdvcmllcyIsIlNZTUJPTCIsIk5VTUJFUiIsIk5BTUUiLCJUb2tlbiIsInN0cmluZ1Rva2VuIiwidGVzdCIsImNhdGVnb3J5IiwicGFyc2VJbnQiLCJ2YWxpZENoYXJTZXRUZXN0IiwidG9rZW5pemVyIiwidGV4dCIsIkVycm9yIiwibWF0Y2giLCJyZSIsIm1hdGNoZXMiLCJleGVjIiwibGV4ZXIiLCJ0b2tlbnMiLCJ0b2tlbiIsIlR5cGVDYXRlZ29yaWVzIiwiTkFNRUQiLCJNQVBfVU5NQVNLRUQiLCJNQVBfTUFTS0VEIiwiVFVQTEVfVU5NQVNLRUQiLCJUVVBMRV9NQVNLRUQiLCJBUlJBWV9VTk1BU0tFRCIsIkFSUkFZX01BU0tFRCIsIlR5cGUiLCJwcm9wZXJ0aWVzIiwicHJvdG90eXBlIiwiZ2VuZXJhdGVIYW5kbGVyIiwibGlicmFyeSIsInByb3BzIiwic3Vic3RyaW5nIiwiZXJyb3IiLCJjb3VudCIsInJlYWRUb2tlbiIsIm5hbWVQYXJzZXIiLCJjb25zdW1lU3ltYm9sIiwic3ltYm9sIiwibWFza1BhcnNlciIsIm1hc2tlZCIsImRlZmluZWQiLCJ0eXBlQXJyYXlQYXJzZXIiLCJ0eXBlUGFyc2VyIiwibnVtYmVyUGFyc2VyIiwidHlwZU1hcFBhcnNlciIsInR5cGVUdXBsZVBhcnNlciIsInBhcnNlciIsInNvdXJjZSIsIlNlcmlhbGl6ZXIiLCJzdHJ1Y3R1cmVzIiwidG9VcHBlckNhc2UiLCJfcGFyc2VyU3RlcHMiLCJwYXJzZSIsInN0cnVjdHVyZSIsImVudHJ5IiwiZXJyIiwiaW5jcmVtZW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLGFBRUEsSUFBQUMsRUFBQSxXQUNBLE9BQUEsTUFHQUMsRUFBQSxXQUNBLE1BQUEsSUFHQUMsRUFBQSxTQUFBQyxHQUNBLE9BQUFBLE1B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QUFBeEgsS0FBQSxDQUNBd0IsS0FBQUEsRUFDQXdCLE1BQUFBLElBR0EsT0FBQXdFLEdBbUJBakosRUFBQXVGLHVCQUNBdkYsRUFBQXVGLHFCQUFBLElBR0F2RixFQUFBdUYscUJBQUE0RCxhQUFBLENBQ0E1QyxVQUFBQSxFQUNBTyxNQUFBQSxFQUNBZ0MsT0FBQUEsRUFDQWpELGdCQUFBQSxFQUNBb0IsZUFBQUEsRUFDQXhCLFlBQUFBLEVBQ0FRLE1BQUFBLEVBQ0F3QixLQUFBQSxHQUdBekgsRUFBQXVGLHFCQUFBNkQsTUF2QkEsU0FBQTVDLEdBQ0EsSUFDQSxPQVZBNkMsRUFVQVAsRUFBQWhDLEVBQUFQLEVBQUFDLEtBVEFxQixFQUFBLEdBQ0F3QixFQUFBaEcsUUFBQSxTQUFBaUcsR0FDQXpCLEVBQUF5QixFQUFBckcsTUFBQXFHLEVBQUE3RSxNQUFBbUQsZ0JBQUFDLEtBRUFBLEVBTUEsTUFBQTBCLEdBQ0EsTUFBQSxJQUFBOUMsTUFBQThDLEVBQUF2QixPQVpBLElBQUFxQixFQUNBeEIsR0EvV0EsQ0ErWUEvRyxNQy9ZQSxTQUFBZCxHQUNBLGFBRUEsU0FBQWdKLEVBQUFoSCxHQUNBbEIsS0FBQW1CLE1BQUEsRUFDQW5CLEtBQUFrQixTQUFBQSxFQUdBZ0gsRUFBQXJCLFVBQUF6RixJQUFBLFNBQUFzSCxHQUNBMUksS0FBQW1CLE9BQUF1SCxHQUdBeEosRUFBQXVGLHVCQUNBdkYsRUFBQXVGLHFCQUFBLElBRUF2RixFQUFBdUYscUJBQUF5RCxXQUFBQSxFQWZBLENBaUJBbEkiLCJmaWxlIjoiZmx5YnJpeC1zZXJpYWxpemF0aW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIG51bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbnVsbE1hc2tBcnJheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBkZWZhdWx0SXNOdWxsID0gZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgIHJldHVybiB2YWwgPT09IG51bGwgfHwgdmFsID09PSB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrLCBtYXNrQXJyYXksIGlzTnVsbCkge1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRvciA9IGRlc2NyaXB0b3I7XHJcbiAgICAgICAgdGhpcy5ieXRlQ291bnQgPSBieXRlQ291bnQ7XHJcbiAgICAgICAgdGhpcy5lbmNvZGUgPSBlbmNvZGU7XHJcbiAgICAgICAgdGhpcy5kZWNvZGUgPSBkZWNvZGU7XHJcbiAgICAgICAgdGhpcy5lbXB0eSA9IGVtcHR5O1xyXG4gICAgICAgIHRoaXMuZnVsbE1hc2sgPSBmdWxsTWFzayB8fCBudWxsTWFzaztcclxuICAgICAgICB0aGlzLm1hc2tBcnJheSA9IG1hc2tBcnJheSB8fCBudWxsTWFza0FycmF5O1xyXG4gICAgICAgIHRoaXMuaXNOdWxsID0gaXNOdWxsIHx8IGRlZmF1bHRJc051bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGhhbmRsZXJzID0ge307XHJcblxyXG4gICAgdmFyIGhhc0JpdCA9IGZ1bmN0aW9uIChtYXNrLCBpZHgpIHtcclxuICAgICAgICByZXR1cm4gKG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gJiAoMSA8PCAoaWR4ICUgOCkpKSAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGVtcHR5TnVtZXJpYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHplcm9BcnJheSA9IGZ1bmN0aW9uIChsKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGw7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlTnVtZXJpY1R5cGUgPSBmdW5jdGlvbiAoa2V5U2hvcnQsIGtleSwgYnl0ZUNvdW50KSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ3NldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIGRhdGEsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ2dldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBIYW5kbGVyKGtleVNob3J0LCBieXRlQ291bnQsIGVtcHR5TnVtZXJpYywgZW5jb2RlLCBkZWNvZGUpO1xyXG5cclxuICAgICAgICBoYW5kbGVyLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudTggPSBjcmVhdGVOdW1lcmljVHlwZSgndTgnLCAnVWludDgnLCAxKTtcclxuICAgIGhhbmRsZXJzLnUxNiA9IGNyZWF0ZU51bWVyaWNUeXBlKCd1MTYnLCAnVWludDE2JywgMik7XHJcbiAgICBoYW5kbGVycy51MzIgPSBjcmVhdGVOdW1lcmljVHlwZSgndTMyJywgJ1VpbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuaTggPSBjcmVhdGVOdW1lcmljVHlwZSgnaTgnLCAnSW50OCcsIDEpO1xyXG4gICAgaGFuZGxlcnMuaTE2ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kxNicsICdJbnQxNicsIDIpO1xyXG4gICAgaGFuZGxlcnMuaTMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kzMicsICdJbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuZjMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2YzMicsICdGbG9hdDMyJywgNCk7XHJcbiAgICBoYW5kbGVycy5mNjQgPSBjcmVhdGVOdW1lcmljVHlwZSgnZjY0JywgJ0Zsb2F0NjQnLCA4KTtcclxuXHJcbiAgICBoYW5kbGVycy5ib29sID0gbmV3IEhhbmRsZXIoXHJcbiAgICAgICAgJ2Jvb2wnLFxyXG4gICAgICAgIGhhbmRsZXJzLnU4LmJ5dGVDb3VudCxcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCBkYXRhID8gMSA6IDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKSAhPT0gMDtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLmJvb2wuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgaGFuZGxlcnMudm9pZCA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICd2b2lkJyxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG51bGwsXHJcbiAgICAgICAgbnVsbCxcclxuICAgICAgICBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhdmFsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgaGFuZGxlcnMudm9pZC5pc0Jhc2ljID0gdHJ1ZTtcclxuXHJcbiAgICB2YXIgYXNjaWlFbmNvZGUgPSBmdW5jdGlvbiAobmFtZSwgbGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTtcclxuICAgICAgICBuYW1lLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uIChjLCBpZHgpIHtcclxuICAgICAgICAgICAgcmVzcG9uc2VbaWR4XSA9IGMuY2hhckNvZGVBdCgwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXNwb25zZVtsZW5ndGggLSAxXSA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgYXNjaWlEZWNvZGUgPSBmdW5jdGlvbiAobmFtZSwgbGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlID0gJyc7XHJcbiAgICAgICAgdmFyIGwgPSBNYXRoLm1pbihuYW1lLmxlbmd0aCwgbGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKG5hbWVbaV0gPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXNwb25zZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKG5hbWVbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLnN0cmluZyA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcclxuICAgICAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJzLmFycmF5VW5tYXNrZWQobGVuZ3RoLCBoYW5kbGVycy51OCk7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIGFzY2lpRW5jb2RlKGRhdGEsIGxlbmd0aCkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhc2NpaURlY29kZShoYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKSwgbGVuZ3RoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKCdzJyArIGxlbmd0aCwgbGVuZ3RoLCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUpO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5zID0gbmV3IEhhbmRsZXIoXHJcbiAgICAgICAgJ3MnLFxyXG4gICAgICAgIDAsXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZUNvdW50ID0gTWF0aC5taW4oZGF0YS5sZW5ndGgsIHNlcmlhbGl6ZXIuZGF0YVZpZXcuYnl0ZUxlbmd0aCAtIHNlcmlhbGl6ZXIuaW5kZXgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBieXRlQ291bnQ7ICsraWR4KSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVycy51OC5lbmNvZGUoc2VyaWFsaXplciwgZGF0YS5jaGFyQ29kZUF0KGlkeCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZXJpYWxpemVyLmluZGV4IDwgc2VyaWFsaXplci5kYXRhVmlldy5ieXRlTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVycy51OC5lbmNvZGUoc2VyaWFsaXplciwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciByZXNwb25zZSA9ICcnO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZUNvdW50ID0gc2VyaWFsaXplci5kYXRhVmlldy5ieXRlTGVuZ3RoIC0gc2VyaWFsaXplci5pbmRleDtcclxuICAgICAgICAgICAgd2hpbGUgKGJ5dGVDb3VudC0tID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoYXJDb2RlID0gaGFuZGxlcnMudTguZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjaGFyQ29kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLnMuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgaGFuZGxlcnMuYXJyYXlVbm1hc2tlZCA9IGZ1bmN0aW9uIChsZW5ndGgsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBoYW5kbGVycy50dXBsZVVubWFza2VkKGNoaWxkcmVuKTtcclxuICAgICAgICByZXN1bHQuZGVzY3JpcHRvciA9ICdbJyArIGhhbmRsZXIuZGVzY3JpcHRvciArICc6JyArIGxlbmd0aCArICddJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy50dXBsZVVubWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtpZHhdLCBtYXNrcyAmJiBtYXNrc1tpZHhdKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbm9uTnVsbENoaWxkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vbk51bGxDaGlsZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghbm9uTnVsbENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAnKCcgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICcpJztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMuYXJyYXlNYXNrZWQgPSBmdW5jdGlvbiAobGVuZ3RoLCBoYW5kbGVyLCBtYXNrQml0Q291bnQpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBoYW5kbGVycy50dXBsZU1hc2tlZChjaGlsZHJlbiwgbWFza0JpdENvdW50KTtcclxuICAgICAgICB2YXIgbWFza1NpemUgPSAocmVzdWx0LmJ5dGVDb3VudCAtIChsZW5ndGggKiBoYW5kbGVyLmJ5dGVDb3VudCkpICogODtcclxuICAgICAgICByZXN1bHQuZGVzY3JpcHRvciA9ICdbLycgKyBtYXNrU2l6ZSArICcvJyArIGhhbmRsZXIuZGVzY3JpcHRvciArICc6JyArIGxlbmd0aCArICddJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy50dXBsZU1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbiwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIG1hc2tCeXRlcyA9IE1hdGguY2VpbChjaGlsZHJlbi5sZW5ndGggLyA4KTtcclxuICAgICAgICBpZiAobWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgICAgIG1hc2tCeXRlcyA9IE1hdGgubWF4KG1hc2tCeXRlcywgTWF0aC5jZWlsKG1hc2tCaXRDb3VudCAvIDgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hc2tIYW5kbGVyID0gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChtYXNrQnl0ZXMsIGhhbmRsZXJzLnU4KTtcclxuICAgICAgICB2YXIgbWFza0FycmF5ID0gZnVuY3Rpb24gKGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gemVyb0FycmF5KG1hc2tCeXRlcyk7XHJcbiAgICAgICAgICAgIHZhciBleHRyYU1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobWFza3MgJiYgKCdNQVNLJyBpbiBtYXNrcykpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhTWFzayA9IG1hc2tzLk1BU0s7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtpZHhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4dHJhTWFzayAmJiAhZXh0cmFNYXNrW2lkeF0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNoaWxkLmlzTnVsbCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrW01hdGguZmxvb3IoaWR4IC8gOCldIHw9IDEgPDwgKGlkeCAlIDgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtYXNrO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IG1hc2tBcnJheShkYXRhLCBtYXNrcyk7XHJcblxyXG4gICAgICAgICAgICBtYXNrSGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgbWFzayk7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2lkeF0sIG1hc2tzICYmIG1hc2tzW2lkeF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IG1hc2tIYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5NQVNLID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgbWFza0J5dGVzKTtcclxuICAgICAgICB2YXIgY2hpbGREZXNjcmlwdG9ycyA9IGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAnKC8nICsgKG1hc2tCeXRlcyAqIDgpICsgJy8nICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnKSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzaywgbWFza0FycmF5KTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMubWFwVW5tYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4pIHtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5oYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBkYXRhW2NoaWxkLmtleV0sIG1hc2tzICYmIG1hc2tzW2NoaWxkLmtleV0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbm9uTnVsbENoaWxkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmhhbmRsZXIuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vbk51bGxDaGlsZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghbm9uTnVsbENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmhhbmRsZXIuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQua2V5ICsgJzonICsgY2hpbGQuaGFuZGxlci5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJ3snICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnfSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLm1hcE1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbiwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIG1hc2tCeXRlcyA9IE1hdGguY2VpbChjaGlsZHJlbi5sZW5ndGggLyA4KTtcclxuICAgICAgICBpZiAobWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgICAgIG1hc2tCeXRlcyA9IE1hdGgubWF4KG1hc2tCeXRlcywgTWF0aC5jZWlsKG1hc2tCaXRDb3VudCAvIDgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hc2tIYW5kbGVyID0gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChtYXNrQnl0ZXMsIGhhbmRsZXJzLnU4KTtcclxuICAgICAgICB2YXIgbWFza0FycmF5ID0gZnVuY3Rpb24gKGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgbWFza3MgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gemVyb0FycmF5KG1hc2tCeXRlcyk7XHJcbiAgICAgICAgICAgIHZhciBleHRyYU1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAobWFza3MgJiYgKCdNQVNLJyBpbiBtYXNrcykpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhTWFzayA9IG1hc2tzLk1BU0s7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFbY2hpbGQua2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChleHRyYU1hc2sgJiYgIWV4dHJhTWFza1tjaGlsZC5rZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFjaGlsZC5oYW5kbGVyLmlzTnVsbCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrW01hdGguZmxvb3IoaWR4IC8gOCldIHw9IDEgPDwgKGlkeCAlIDgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtYXNrO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICB2YXIgbWFzayA9IG1hc2tBcnJheShkYXRhLCBtYXNrcyk7XHJcblxyXG4gICAgICAgICAgICBtYXNrSGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgbWFzayk7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmhhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbY2hpbGQua2V5XSwgbWFza3MgJiYgbWFza3NbY2hpbGQua2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0hhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoYXNCaXQobWFzaywgaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgdmFyIG1hc2sgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmhhbmRsZXIuZnVsbE1hc2soKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtYXNrW2NoaWxkLmtleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzdWx0Lk1BU0sgPSBtYXNrO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmhhbmRsZXIuYnl0ZUNvdW50O1xyXG4gICAgICAgIH0sIG1hc2tCeXRlcyk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5rZXkgKyAnOicgKyBjaGlsZC5oYW5kbGVyLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAney8nICsgKG1hc2tCeXRlcyAqIDgpICsgJy8nICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnfSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzaywgbWFza0FycmF5KTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24pIHtcclxuICAgICAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24gPSB7fTtcclxuICAgIH1cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5faGFuZGxlcnMgPSBoYW5kbGVycztcclxuXHJcbn0odGhpcykpO1xyXG4iLCIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGZ1bmN0aW9uIFN0cmluZ1Rva2VuKHBvc2l0aW9uLCB2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG51bWVyaWNUZXN0ID0gL15cXGQrJC87XHJcbiAgICB2YXIgbmFtZVRlc3QgPSAvXlxcdyskLztcclxuXHJcbiAgICB2YXIgVG9rZW5DYXRlZ29yaWVzID0ge1xyXG4gICAgICAgIFNZTUJPTDogMCxcclxuICAgICAgICBOVU1CRVI6IDEsXHJcbiAgICAgICAgTkFNRTogMixcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gVG9rZW4oc3RyaW5nVG9rZW4pIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gc3RyaW5nVG9rZW4ucG9zaXRpb247XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHN0cmluZ1Rva2VuLnZhbHVlO1xyXG4gICAgICAgIGlmIChudW1lcmljVGVzdC50ZXN0KHRoaXMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSO1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gcGFyc2VJbnQodGhpcy52YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lVGVzdC50ZXN0KHRoaXMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBUb2tlbkNhdGVnb3JpZXMuTkFNRTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLlNZTUJPTDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHZhbGlkQ2hhclNldFRlc3QgPSAvXlt7fVxcW1xcXSgpXFwvPTosO1xcd1xcc10qJC87XHJcblxyXG4gICAgdmFyIGlzVmFsaWQgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHJldHVybiB2YWxpZENoYXJTZXRUZXN0LnRlc3QodGV4dCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0b2tlbml6ZXIgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIGlmICghaXNWYWxpZCh0ZXh0KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3NlZCBjb25maWcgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZSA9IC8oW3t9XFxbXFxdKClcXC89Oiw7XXxcXHcrKS9nO1xyXG4gICAgICAgIHZhciBtYXRjaDtcclxuICAgICAgICB2YXIgbWF0Y2hlcyA9IFtdO1xyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZS5leGVjKHRleHQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtYXRjaGVzLnB1c2gobmV3IFN0cmluZ1Rva2VuKG1hdGNoLmluZGV4LCBtYXRjaFswXSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF0Y2hlcztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGxleGVyID0gZnVuY3Rpb24gKHRva2Vucykge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMubWFwKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRva2VuKHRva2VuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIFR5cGVDYXRlZ29yaWVzID0ge1xyXG4gICAgICAgIE5BTUVEOiAwLFxyXG4gICAgICAgIE1BUF9VTk1BU0tFRDogMixcclxuICAgICAgICBNQVBfTUFTS0VEOiAzLFxyXG4gICAgICAgIFRVUExFX1VOTUFTS0VEOiA0LFxyXG4gICAgICAgIFRVUExFX01BU0tFRDogNSxcclxuICAgICAgICBBUlJBWV9VTk1BU0tFRDogNixcclxuICAgICAgICBBUlJBWV9NQVNLRUQ6IDcsXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFR5cGUoY2F0ZWdvcnksIHByb3BlcnRpZXMsIG1hc2spIHtcclxuICAgICAgICB0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcclxuICAgICAgICB0aGlzLm1hc2sgPSBtYXNrIHx8IDA7XHJcbiAgICB9XHJcblxyXG4gICAgVHlwZS5wcm90b3R5cGUuZ2VuZXJhdGVIYW5kbGVyID0gZnVuY3Rpb24gKGxpYnJhcnkpIHtcclxuICAgICAgICB2YXIgaGFuZGxlcnMgPSBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uX2hhbmRsZXJzO1xyXG4gICAgICAgIHZhciBwcm9wcyA9IHRoaXMucHJvcGVydGllcztcclxuICAgICAgICB2YXIgbWFzayA9IHRoaXMubWFzaztcclxuICAgICAgICB2YXIgaGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5jYXRlZ29yeSkge1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk5BTUVEOlxyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BzIGluIGhhbmRsZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJzW3Byb3BzXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIuaXNCYXNpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzWzBdID09PSAncycpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gcHJvcHMuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudW1lcmljVGVzdC50ZXN0KGxlbmd0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJzLnN0cmluZyhwYXJzZUludChsZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzIGluIGxpYnJhcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyID0gbGlicmFyeVtwcm9wc107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbnJlY29nbml6ZWQgdHlwZSBcIicgKyBwcm9wcyArICdcIicsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVyO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk1BUF9VTk1BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogY2hpbGQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogY2hpbGQudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5tYXBVbm1hc2tlZChjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuTUFQX01BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogY2hpbGQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogY2hpbGQudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy5tYXBNYXNrZWQoY2hpbGRyZW4sIG1hc2spO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLlRVUExFX1VOTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnR1cGxlVW5tYXNrZWQoY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy50dXBsZU1hc2tlZChjaGlsZHJlbiwgbWFzayk7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuQVJSQVlfVU5NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMuYXJyYXlVbm1hc2tlZChwcm9wcy5jb3VudCwgcHJvcHMudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMuYXJyYXlNYXNrZWQocHJvcHMuY291bnQsIHByb3BzLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSwgbWFzayk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5yZWNvZ25pemVkIHR5cGUgY2F0ZWdvcnknLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciByZWFkVG9rZW4gPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbc2VyaWFsaXplci5pbmRleF07XHJcbiAgICAgICAgc2VyaWFsaXplci5hZGQoMSk7XHJcbiAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgZW5kIG9mIHN0cmluZycsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbjtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG5hbWVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgIT09IFRva2VuQ2F0ZWdvcmllcy5OQU1FKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgbmFtZSwgZ290OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ01BU0snKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRGlzYWxsb3dlZCBuYW1lIFwiTUFTS1wiIGdpdmVuJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuLnZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbnVtYmVyUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgbnVtYmVyLCBnb3Q6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuLnZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY29uc3VtZVN5bWJvbCA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBzeW1ib2wpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSBzeW1ib2wpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBcIicgKyBzeW1ib2wgKyAnXCIsIGdvdDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIG1hc2tQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIFwiLy9cIiBvciBcIi88TlVNQkVSPi9cIiwgb3RoZXJ3aXNlIHRoZXJlIGlzIG5vIG1hc2tcclxuICAgICAgICAvLyBMYWJlbGVkIHdpdGggPE1BU0s+IGluIGNvbW1lbnRzIGJlbG93XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuYWRkKC0xKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG1hc2tlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXNrZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBkZWZpbmVkOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTlVNQkVSKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCIvXCIgb3IgbnVtYmVyJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdG9rZW4udmFsdWU7XHJcbiAgICAgICAgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLycpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFeHBlY3RlZCBcIi9cIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG1hc2tlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZGVmaW5lZDogdHJ1ZSxcclxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlTWFwUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyB7PE1BU0s+IDxOQU1FPjo8VFlQRT4sIDxOQU1FPjo8VFlQRT4sIDxOQU1FPjo8VFlQRT59XHJcbiAgICAgICAgdmFyIG1hc2sgPSBtYXNrUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmFtZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnOicpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ30nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWFzay5tYXNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFzay5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfTUFTS0VELCBjaGlsZHJlbiwgbWFzay52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk1BUF9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfVU5NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcsJykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgdG9rZW4gYWZ0ZXIgbWFwIGVsZW1lbnQ6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlVHVwbGVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vICg8TUFTSz4gPFRZUEU+LCA8VFlQRT4sIDxUWVBFPilcclxuICAgICAgICB2YXIgbWFzayA9IG1hc2tQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpKTtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcpJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuVFVQTEVfTUFTS0VELCBjaGlsZHJlbiwgbWFzay52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLCcpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIGFmdGVyIHR1cGxlIGVsZW1lbnQ6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0eXBlQXJyYXlQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIFs8TUFTSz4gPFRZUEU+OjxOVU1CRVI+XVxyXG4gICAgICAgIHZhciBtYXNrID0gbWFza1BhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJzonKTtcclxuICAgICAgICB2YXIgY291bnQgPSBudW1iZXJQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnXScpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICBjb3VudDogY291bnQsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAobWFzay5tYXNrZWQpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX01BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLkFSUkFZX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZVBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gT3B0aW9uczpcclxuICAgICAgICAvLyAtIDxOQU1FPlxyXG4gICAgICAgIC8vIC0gVHVwbGVcclxuICAgICAgICAvLyAtIEFycmF5XHJcbiAgICAgICAgLy8gLSBNYXBcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgZW5kIG9mIHN0cmluZycsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSA9PT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgbnVtYmVyLCB0eXBlIGV4cGVjdGVkJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ID09PSBUb2tlbkNhdGVnb3JpZXMuTkFNRSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTkFNRUQsIHRva2VuLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAneycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVNYXBQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ1snKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlQXJyYXlQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJygnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlVHVwbGVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICBlcnJvcjogJ1VuZXhwZWN0ZWQgdG9rZW4gd2hlbiBkZXNjcmliaW5nIHR5cGU6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGFyc2VyID0gZnVuY3Rpb24gKHRva2Vucywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLlNlcmlhbGl6ZXIodG9rZW5zKTtcclxuICAgICAgICB2YXIgc3RydWN0dXJlcyA9IFtdO1xyXG4gICAgICAgIHdoaWxlIChzZXJpYWxpemVyLmluZGV4IDwgc2VyaWFsaXplci5kYXRhVmlldy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAobmFtZVswXSAhPT0gbmFtZVswXS50b1VwcGVyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnU3RydWN0dXJlIG5hbWVzIGNhbm5vdCBzdGFydCB3aXRoIGxvd2VyY2FzZSBsZXR0ZXJzJyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnPScpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0eXBlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc7Jyk7XHJcbiAgICAgICAgICAgIHN0cnVjdHVyZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cnVjdHVyZXM7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBjcmVhdGVIYW5kbGVycyA9IGZ1bmN0aW9uIChzdHJ1Y3R1cmUpIHtcclxuICAgICAgICB2YXIgbGlicmFyeSA9IHt9O1xyXG4gICAgICAgIHN0cnVjdHVyZS5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkge1xyXG4gICAgICAgICAgICBsaWJyYXJ5W2VudHJ5Lm5hbWVdID0gZW50cnkudmFsdWUuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBsaWJyYXJ5O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcGFyc2UgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVIYW5kbGVycyhwYXJzZXIobGV4ZXIodG9rZW5pemVyKHRleHQpLCB0ZXh0KSwgdGV4dCkpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyLmVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLl9wYXJzZXJTdGVwcyA9IHtcclxuICAgICAgICB0b2tlbml6ZXI6IHRva2VuaXplcixcclxuICAgICAgICBsZXhlcjogbGV4ZXIsXHJcbiAgICAgICAgcGFyc2VyOiBwYXJzZXIsXHJcbiAgICAgICAgVG9rZW5DYXRlZ29yaWVzOiBUb2tlbkNhdGVnb3JpZXMsXHJcbiAgICAgICAgVHlwZUNhdGVnb3JpZXM6IFR5cGVDYXRlZ29yaWVzLFxyXG4gICAgICAgIFN0cmluZ1Rva2VuOiBTdHJpbmdUb2tlbixcclxuICAgICAgICBUb2tlbjogVG9rZW4sXHJcbiAgICAgICAgVHlwZTogVHlwZSxcclxuICAgIH07XHJcblxyXG4gICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLnBhcnNlID0gcGFyc2U7XHJcblxyXG59KHRoaXMpKTtcclxuIiwiKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBmdW5jdGlvbiBTZXJpYWxpemVyKGRhdGFWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5pbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5kYXRhVmlldyA9IGRhdGFWaWV3O1xyXG4gICAgfVxyXG5cclxuICAgIFNlcmlhbGl6ZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChpbmNyZW1lbnQpIHtcclxuICAgICAgICB0aGlzLmluZGV4ICs9IGluY3JlbWVudDtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24pIHtcclxuICAgICAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24gPSB7fTtcclxuICAgIH1cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5TZXJpYWxpemVyID0gU2VyaWFsaXplcjtcclxuXHJcbn0odGhpcykpO1xyXG4iXX0=
