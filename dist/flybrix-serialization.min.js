!function(e){"use strict";var u=function(){return null},c=function(){return[]};function f(e,n,r,t,i,o,a){this.descriptor=e,this.byteCount=n,this.encode=t,this.decode=i,this.empty=r,this.fullMask=o||u,this.maskArray=a||c}var l={},s=function(e,n){return 0!=(e[Math.floor(n/8)]&1<<n%8)},i=function(){return 0},d=function(e){for(var n=[],r=0;r<e;++r)n.push(0);return n},n=function(e,r,t){var n=new f(e,t,i,function(e,n){e.dataView["set"+r](e.index,n,1),e.add(t)},function(e){var n=e.dataView["get"+r](e.index,1);return e.add(t),n});return n.isBasic=!0,n};l.u8=n("u8","Uint8",1),l.u16=n("u16","Uint16",2),l.u32=n("u32","Uint32",4),l.i8=n("i8","Int8",1),l.i16=n("i16","Int16",2),l.i32=n("i32","Int32",4),l.f32=n("f32","Float32",4),l.f64=n("f64","Float64",8),l.bool=new f("bool",l.u8.byteCount,function(){return!1},function(e,n){l.u8.encode(e,n?1:0)},function(e){return 0!==l.u8.decode(e)}),l.bool.isBasic=!0,l.void=new f("void",0,function(){return!0},function(e,n){},function(){return!0}),l.void.isBasic=!0;l.string=function(o){var a=l.arrayUnmasked(o,l.u8);return new f("s"+o,o,function(){return""},function(e,n){var r,t,i;a.encode(e,(r=n,t=o,i=new Uint8Array(t),r.split("").forEach(function(e,n){i[n]=e.charCodeAt(0)}),i[t-1]=0,i))},function(e){return function(e,n){for(var r="",t=Math.min(e.length,n-1),i=0;i<t;++i){if(0===e[i])return r;r+=String.fromCharCode(e[i])}return r}(a.decode(e),o)})},l.s=new f("s",0,function(){return""},function(e,n){for(var r=Math.min(n.length,e.dataView.byteLength-e.index),t=0;t<r;++t)l.u8.encode(e,n.charCodeAt(t));e.index<e.dataView.byteLength&&l.u8.encode(e,0)},function(e){for(var n="",r=e.dataView.byteLength-e.index;0<r--;){var t=l.u8.decode(e);if(!t)return n;n+=String.fromCharCode(t)}return n}),l.s.isBasic=!0,l.arrayUnmasked=function(e,n){for(var r=[],t=0;t<e;++t)r.push(n);var i=l.tupleUnmasked(r);return i.descriptor="["+n.descriptor+":"+e+"]",i},l.tupleUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.byteCount},0);return new f("("+e.map(function(e){return e.descriptor}).join(",")+")",n,function(){return e.map(function(e){return e.empty()})},function(r,t,i){!0===i&&(i=null),e.forEach(function(e,n){e.encode(r,t[n],i&&i[n])})},function(n){return e.map(function(e){return e.decode(n)})},function(){var t=!1,i={};return e.forEach(function(e,n){var r=e.fullMask();null!==r&&(t=!0,i[n]=r)}),t?i:null})},l.arrayMasked=function(e,n,r){for(var t=[],i=0;i<e;++i)t.push(n);var o=l.tupleMasked(t,r),a=8*(o.byteCount-e*n.byteCount);return o.descriptor="[/"+a+"/"+n.descriptor+":"+e+"]",o},l.tupleMasked=function(n,e){var r=Math.ceil(n.length/8);e&&(r=Math.max(r,Math.ceil(e/8)));var a=l.arrayUnmasked(r,l.u8),u=function(t,e){!0===e&&(e=null);var i=d(r),o=null;return e&&"MASK"in e&&(o=e.MASK),n.forEach(function(e,n){var r=t[n];o&&!o[n]||null!=r&&(i[Math.floor(n/8)]|=1<<n%8)}),i},t=n.reduce(function(e,n){return e+n.byteCount},r),i=n.map(function(e){return e.descriptor});return new f("(/"+8*r+"/"+i.join(",")+")",t,function(){return n.map(function(e){return e.empty()})},function(r,t,i){var o=u(t,i);a.encode(r,o),n.forEach(function(e,n){s(o,n)&&e.encode(r,t[n],i&&i[n])})},function(r){var t=a.decode(r);return n.map(function(e,n){return s(t,n)?e.decode(r):null})},function(){var t={};return n.forEach(function(e,n){var r=e.fullMask();null!==r&&(t[n]=r)}),t.MASK=n.map(function(){return!0}),t},u)},l.mapUnmasked=function(e){var n=e.reduce(function(e,n){return e+n.handler.byteCount},0);return new f("{"+e.map(function(e){return e.key+":"+e.handler.descriptor}).join(",")+"}",n,function(){var n={};return e.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(n,r,t){!0===t&&(t=null),e.forEach(function(e){e.handler.encode(n,r[e.key],t&&t[e.key])})},function(n){var r={};return e.forEach(function(e){r[e.key]=e.handler.decode(n)}),r},function(){var r=!1,t={};return e.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r=!0,t[e.key]=n)}),r?t:null})},l.mapMasked=function(a,e){var n=Math.ceil(a.length/8);e&&(n=Math.max(n,Math.ceil(e/8)));var u=l.arrayUnmasked(n,l.u8),c=function(t,e){!0===e&&(e=null);var i=d(n),o=null;return e&&"MASK"in e&&(o=e.MASK),a.forEach(function(e,n){var r=t[e.key];o&&!o[e.key]||null!=r&&(i[Math.floor(n/8)]|=1<<n%8)}),i},r=a.reduce(function(e,n){return e+n.handler.byteCount},n),t=a.map(function(e){return e.key+":"+e.handler.descriptor});return new f("{/"+8*n+"/"+t.join(",")+"}",r,function(){var n={};return a.forEach(function(e){n[e.key]=e.handler.empty()}),n},function(r,t,i){var o=c(t,i);u.encode(r,o),a.forEach(function(e,n){s(o,n)&&e.handler.encode(r,t[e.key],i&&i[e.key])})},function(r){var t=u.decode(r),i={};return a.forEach(function(e,n){s(t,n)?i[e.key]=e.handler.decode(r):i[e.key]=null}),i},function(){var r={},t={};return a.forEach(function(e){var n=e.handler.fullMask();null!==n&&(r[e.key]=n),t[e.key]=!0}),r.MASK=t,r},c)},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization._handlers=l}(this),function(u){"use strict";function o(e,n){this.position=e,this.value=n}var c=/^\d+$/,n=/^\w+$/,a={SYMBOL:0,NUMBER:1,NAME:2};function r(e){this.position=e.position,this.value=e.value,c.test(this.value)?(this.category=a.NUMBER,this.value=parseInt(this.value)):n.test(this.value)?this.category=a.NAME:this.category=a.SYMBOL}var f=/^[{}\[\]()\/=:,;\w\s]*$/,t=function(e){if(n=e,!f.test(n))throw new Error("Passed config contains invalid characters");for(var n,r,t=/([{}\[\]()\/=:,;]|\w+)/g,i=[];null!==(r=t.exec(e));)i.push(new o(r.index,r[0]));return i},i=function(e){return e.map(function(e){return new r(e)})},l={NAMED:0,MAP_UNMASKED:2,MAP_MASKED:3,TUPLE_UNMASKED:4,TUPLE_MASKED:5,ARRAY_UNMASKED:6,ARRAY_MASKED:7};function s(e,n,r){this.category=e,this.properties=n,this.mask=r||0}s.prototype.generateHandler=function(n){var e,r=u.FlybrixSerialization._handlers,t=this.properties,i=this.mask,o=null;switch(this.category){case l.NAMED:if(t in r)(o=r[t]).isBasic||(o=null);else if("s"===t[0]){var a=t.substring(1);c.test(a)&&(o=r.string(parseInt(a)))}else t in n&&(o=n[t]);if(!o)throw{position:-1,error:'Unrecognized type "'+t+'"'};return o;case l.MAP_UNMASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapUnmasked(e);case l.MAP_MASKED:return e=t.map(function(e){return{key:e.name,handler:e.value.generateHandler(n)}}),r.mapMasked(e,i);case l.TUPLE_UNMASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleUnmasked(e);case l.TUPLE_MASKED:return e=t.map(function(e){return e.generateHandler(n)}),r.tupleMasked(e,i);case l.ARRAY_UNMASKED:return r.arrayUnmasked(t.count,t.value.generateHandler(n));case l.ARRAY_MASKED:return r.arrayMasked(t.count,t.value.generateHandler(n),i);default:throw{position:-1,error:"Unrecognized type category"}}};var d=function(e){var n=e.dataView[e.index];if(e.add(1),!n)throw{position:-1,error:"Unexpected end of string"};return n},h=function(e){var n=d(e);if(n.category!==a.NAME)throw{position:n.position,error:'Expected name, got: "'+n.value+'"'};if("MASK"===n.value)throw{position:n.position,error:'Disallowed name "MASK" given'};return n.value},v=function(e,n){var r=d(e);if(r.value!==n)throw{position:r.position,error:'Expected "'+n+'", got: "'+r.value+'"'}},p=function(e){var n=d(e);if("/"!==n.value)return e.add(-1),{masked:!1};if("/"===(n=d(e)).value)return{masked:!0,defined:!1};if(n.category!==a.NUMBER)throw{position:n.position,error:'Expected "/" or number'};var r=n.value;if("/"!==(n=d(e)).value)throw{position:n.position,error:'Expected "/"'};return{masked:!0,defined:!0,value:r}},y=function(e){var n=p(e),r=M(e);v(e,":");var t=function(e){var n=d(e);if(n.category!==a.NUMBER)throw{position:n.position,error:'Expected number, got: "'+n.value+'"'};return n.value}(e);v(e,"]");var i={value:r,count:t};return n.masked?n.defined?new s(l.ARRAY_MASKED,i,n.value):new s(l.ARRAY_MASKED,i):new s(l.ARRAY_UNMASKED,i)},M=function(e){var n=d(e);if(!n)throw{position:-1,error:"Unexpected end of string"};if(n.category===a.NUMBER)throw{position:n.position,error:"Unexpected number, type expected"};if(n.category===a.NAME)return new s(l.NAMED,n.value);if("{"===n.value)return function(e){for(var n=p(e),r=[];;){var t=h(e);v(e,":");var i=M(e);r.push({name:t,value:i});var o=d(e);if("}"===o.value)return n.masked?n.defined?new s(l.MAP_MASKED,r,n.value):new s(l.MAP_MASKED,r):new s(l.MAP_UNMASKED,r);if(","!==o.value)throw{position:o.position,error:'Unexpected token after map element: "'+o.value+'"'}}}(e);if("["===n.value)return y(e);if("("===n.value)return function(e){for(var n=p(e),r=[];;){r.push(M(e));var t=d(e);if(")"===t.value)return n.masked?n.defined?new s(l.TUPLE_MASKED,r,n.value):new s(l.TUPLE_MASKED,r):new s(l.TUPLE_UNMASKED,r);if(","!==t.value)throw{position:t.position,error:'Unexpected token after tuple element: "'+t.value+'"'}}}(e);throw{position:n.position,error:'Unexpected token when describing type: "'+n.value+'"'}},E=function(e,n){for(var r=new u.FlybrixSerialization.Serializer(e),t=[];r.index<r.dataView.length;){var i=h(r);if(i[0]!==i[0].toUpperCase())throw{position:-1,error:"Structure names cannot start with lowercase letters"};v(r,"=");var o=M(r);v(r,";"),t.push({name:i,value:o})}return t};u.FlybrixSerialization||(u.FlybrixSerialization={}),u.FlybrixSerialization._parserSteps={tokenizer:t,lexer:i,parser:E,TokenCategories:a,TypeCategories:l,StringToken:o,Token:r,Type:s},u.FlybrixSerialization.parse=function(e){try{return n=E(i(t(e))),r={},n.forEach(function(e){r[e.name]=e.value.generateHandler(r)}),r}catch(e){throw new Error(e.error)}var n,r}}(this),function(e){"use strict";function n(e){this.index=0,this.dataView=e}n.prototype.add=function(e){this.index+=e},e.FlybrixSerialization||(e.FlybrixSerialization={}),e.FlybrixSerialization.Serializer=n}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwicGFyc2VyLmpzIiwic2VyaWFsaXplci5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJudWxsTWFzayIsIm51bGxNYXNrQXJyYXkiLCJIYW5kbGVyIiwiZGVzY3JpcHRvciIsImJ5dGVDb3VudCIsImVtcHR5IiwiZW5jb2RlIiwiZGVjb2RlIiwiZnVsbE1hc2siLCJtYXNrQXJyYXkiLCJ0aGlzIiwiaGFuZGxlcnMiLCJoYXNCaXQiLCJtYXNrIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZW1wdHlOdW1lcmljIiwiemVyb0FycmF5IiwibCIsInJlc3VsdCIsInB1c2giLCJjcmVhdGVOdW1lcmljVHlwZSIsImtleVNob3J0Iiwia2V5IiwiaGFuZGxlciIsInNlcmlhbGl6ZXIiLCJkYXRhIiwiZGF0YVZpZXciLCJpbmRleCIsImFkZCIsImlzQmFzaWMiLCJ1OCIsInUxNiIsInUzMiIsImk4IiwiaTE2IiwiaTMyIiwiZjMyIiwiZjY0IiwiYm9vbCIsInZvaWQiLCJzdHJpbmciLCJsZW5ndGgiLCJhcnJheVVubWFza2VkIiwibmFtZSIsInJlc3BvbnNlIiwiVWludDhBcnJheSIsInNwbGl0IiwiZm9yRWFjaCIsImMiLCJjaGFyQ29kZUF0IiwibWluIiwiaSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImFzY2lpRGVjb2RlIiwicyIsImJ5dGVMZW5ndGgiLCJjaGFyQ29kZSIsImNoaWxkcmVuIiwidHVwbGVVbm1hc2tlZCIsInJlZHVjZSIsImFjY3VtIiwiY2hpbGQiLCJtYXAiLCJqb2luIiwibWFza3MiLCJub25OdWxsQ2hpbGQiLCJ2YWx1ZSIsImFycmF5TWFza2VkIiwibWFza0JpdENvdW50IiwidHVwbGVNYXNrZWQiLCJtYXNrU2l6ZSIsIm1hc2tCeXRlcyIsImNlaWwiLCJtYXgiLCJtYXNrSGFuZGxlciIsImV4dHJhTWFzayIsIk1BU0siLCJfIiwiY2hpbGREZXNjcmlwdG9ycyIsIm1hcFVubWFza2VkIiwibWFwTWFza2VkIiwiRmx5YnJpeFNlcmlhbGl6YXRpb24iLCJfaGFuZGxlcnMiLCJTdHJpbmdUb2tlbiIsInBvc2l0aW9uIiwibnVtZXJpY1Rlc3QiLCJuYW1lVGVzdCIsIlRva2VuQ2F0ZWdvcmllcyIsIlNZTUJPTCIsIk5VTUJFUiIsIk5BTUUiLCJUb2tlbiIsInN0cmluZ1Rva2VuIiwidGVzdCIsImNhdGVnb3J5IiwicGFyc2VJbnQiLCJ2YWxpZENoYXJTZXRUZXN0IiwidG9rZW5pemVyIiwidGV4dCIsIkVycm9yIiwibWF0Y2giLCJyZSIsIm1hdGNoZXMiLCJleGVjIiwibGV4ZXIiLCJ0b2tlbnMiLCJ0b2tlbiIsIlR5cGVDYXRlZ29yaWVzIiwiTkFNRUQiLCJNQVBfVU5NQVNLRUQiLCJNQVBfTUFTS0VEIiwiVFVQTEVfVU5NQVNLRUQiLCJUVVBMRV9NQVNLRUQiLCJBUlJBWV9VTk1BU0tFRCIsIkFSUkFZX01BU0tFRCIsIlR5cGUiLCJwcm9wZXJ0aWVzIiwicHJvdG90eXBlIiwiZ2VuZXJhdGVIYW5kbGVyIiwibGlicmFyeSIsInByb3BzIiwic3Vic3RyaW5nIiwiZXJyb3IiLCJjb3VudCIsInJlYWRUb2tlbiIsIm5hbWVQYXJzZXIiLCJjb25zdW1lU3ltYm9sIiwic3ltYm9sIiwibWFza1BhcnNlciIsIm1hc2tlZCIsImRlZmluZWQiLCJ0eXBlQXJyYXlQYXJzZXIiLCJ0eXBlUGFyc2VyIiwibnVtYmVyUGFyc2VyIiwidHlwZU1hcFBhcnNlciIsInR5cGVUdXBsZVBhcnNlciIsInBhcnNlciIsInNvdXJjZSIsIlNlcmlhbGl6ZXIiLCJzdHJ1Y3R1cmVzIiwidG9VcHBlckNhc2UiLCJfcGFyc2VyU3RlcHMiLCJwYXJzZSIsInN0cnVjdHVyZSIsImVudHJ5IiwiZXJyIiwiaW5jcmVtZW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLGFBRUEsSUFBQUMsRUFBQSxXQUNBLE9BQUEsTUFHQUMsRUFBQSxXQUNBLE1BQUEsSUFHQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNB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QUEsRUFDQU8sTUFBQUEsRUFDQWdDLE9BQUFBLEVBQ0FqRCxnQkFBQUEsRUFDQW9CLGVBQUFBLEVBQ0F4QixZQUFBQSxFQUNBUSxNQUFBQSxFQUNBd0IsS0FBQUEsR0FHQXZILEVBQUFxRixxQkFBQTZELE1BdkJBLFNBQUE1QyxHQUNBLElBQ0EsT0FWQTZDLEVBVUFQLEVBQUFoQyxFQUFBUCxFQUFBQyxLQVRBcUIsRUFBQSxHQUNBd0IsRUFBQWpHLFFBQUEsU0FBQWtHLEdBQ0F6QixFQUFBeUIsRUFBQXRHLE1BQUFzRyxFQUFBOUUsTUFBQW9ELGdCQUFBQyxLQUVBQSxFQU1BLE1BQUEwQixHQUNBLE1BQUEsSUFBQTlDLE1BQUE4QyxFQUFBdkIsT0FaQSxJQUFBcUIsRUFDQXhCLEdBL1dBLENBK1lBaEgsTUMvWUEsU0FBQVgsR0FDQSxhQUVBLFNBQUE4SSxFQUFBakgsR0FDQWxCLEtBQUFtQixNQUFBLEVBQ0FuQixLQUFBa0IsU0FBQUEsRUFHQWlILEVBQUFyQixVQUFBMUYsSUFBQSxTQUFBdUgsR0FDQTNJLEtBQUFtQixPQUFBd0gsR0FHQXRKLEVBQUFxRix1QkFDQXJGLEVBQUFxRixxQkFBQSxJQUVBckYsRUFBQXFGLHFCQUFBeUQsV0FBQUEsRUFmQSxDQWlCQW5JIiwiZmlsZSI6ImZseWJyaXgtc2VyaWFsaXphdGlvbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBudWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG51bGxNYXNrQXJyYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzaywgbWFza0FycmF5KSB7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcclxuICAgICAgICB0aGlzLmJ5dGVDb3VudCA9IGJ5dGVDb3VudDtcclxuICAgICAgICB0aGlzLmVuY29kZSA9IGVuY29kZTtcclxuICAgICAgICB0aGlzLmRlY29kZSA9IGRlY29kZTtcclxuICAgICAgICB0aGlzLmVtcHR5ID0gZW1wdHk7XHJcbiAgICAgICAgdGhpcy5mdWxsTWFzayA9IGZ1bGxNYXNrIHx8IG51bGxNYXNrO1xyXG4gICAgICAgIHRoaXMubWFza0FycmF5ID0gbWFza0FycmF5IHx8IG51bGxNYXNrQXJyYXk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGhhbmRsZXJzID0ge307XHJcblxyXG4gICAgdmFyIGhhc0JpdCA9IGZ1bmN0aW9uIChtYXNrLCBpZHgpIHtcclxuICAgICAgICByZXR1cm4gKG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gJiAoMSA8PCAoaWR4ICUgOCkpKSAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGVtcHR5TnVtZXJpYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHplcm9BcnJheSA9IGZ1bmN0aW9uIChsKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGw7ICsraWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlTnVtZXJpY1R5cGUgPSBmdW5jdGlvbiAoa2V5U2hvcnQsIGtleSwgYnl0ZUNvdW50KSB7XHJcbiAgICAgICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ3NldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIGRhdGEsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHNlcmlhbGl6ZXIuZGF0YVZpZXdbJ2dldCcgKyBrZXldKHNlcmlhbGl6ZXIuaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZChieXRlQ291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBIYW5kbGVyKGtleVNob3J0LCBieXRlQ291bnQsIGVtcHR5TnVtZXJpYywgZW5jb2RlLCBkZWNvZGUpO1xyXG5cclxuICAgICAgICBoYW5kbGVyLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudTggPSBjcmVhdGVOdW1lcmljVHlwZSgndTgnLCAnVWludDgnLCAxKTtcclxuICAgIGhhbmRsZXJzLnUxNiA9IGNyZWF0ZU51bWVyaWNUeXBlKCd1MTYnLCAnVWludDE2JywgMik7XHJcbiAgICBoYW5kbGVycy51MzIgPSBjcmVhdGVOdW1lcmljVHlwZSgndTMyJywgJ1VpbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuaTggPSBjcmVhdGVOdW1lcmljVHlwZSgnaTgnLCAnSW50OCcsIDEpO1xyXG4gICAgaGFuZGxlcnMuaTE2ID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kxNicsICdJbnQxNicsIDIpO1xyXG4gICAgaGFuZGxlcnMuaTMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2kzMicsICdJbnQzMicsIDQpO1xyXG4gICAgaGFuZGxlcnMuZjMyID0gY3JlYXRlTnVtZXJpY1R5cGUoJ2YzMicsICdGbG9hdDMyJywgNCk7XHJcbiAgICBoYW5kbGVycy5mNjQgPSBjcmVhdGVOdW1lcmljVHlwZSgnZjY0JywgJ0Zsb2F0NjQnLCA4KTtcclxuXHJcbiAgICBoYW5kbGVycy5ib29sID0gbmV3IEhhbmRsZXIoXHJcbiAgICAgICAgJ2Jvb2wnLFxyXG4gICAgICAgIGhhbmRsZXJzLnU4LmJ5dGVDb3VudCxcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChzZXJpYWxpemVyLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXJzLnU4LmVuY29kZShzZXJpYWxpemVyLCBkYXRhID8gMSA6IDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKSAhPT0gMDtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLmJvb2wuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgaGFuZGxlcnMudm9pZCA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICd2b2lkJyxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIGhhbmRsZXJzLnZvaWQuaXNCYXNpYyA9IHRydWU7XHJcblxyXG4gICAgdmFyIGFzY2lpRW5jb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XHJcbiAgICAgICAgbmFtZS5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbiAoYywgaWR4KSB7XHJcbiAgICAgICAgICAgIHJlc3BvbnNlW2lkeF0gPSBjLmNoYXJDb2RlQXQoMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVzcG9uc2VbbGVuZ3RoIC0gMV0gPSAwO1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGFzY2lpRGVjb2RlID0gZnVuY3Rpb24gKG5hbWUsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9ICcnO1xyXG4gICAgICAgIHZhciBsID0gTWF0aC5taW4obmFtZS5sZW5ndGgsIGxlbmd0aCAtIDEpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChuYW1lW2ldID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzcG9uc2UgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShuYW1lW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5zdHJpbmcgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKGxlbmd0aCwgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSkge1xyXG4gICAgICAgICAgICBoYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBhc2NpaUVuY29kZShkYXRhLCBsZW5ndGgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICByZXR1cm4gYXNjaWlEZWNvZGUoaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplciksIGxlbmd0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcigncycgKyBsZW5ndGgsIGxlbmd0aCwgZW1wdHksIGVuY29kZSwgZGVjb2RlKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMucyA9IG5ldyBIYW5kbGVyKFxyXG4gICAgICAgICdzJyxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGVDb3VudCA9IE1hdGgubWluKGRhdGEubGVuZ3RoLCBzZXJpYWxpemVyLmRhdGFWaWV3LmJ5dGVMZW5ndGggLSBzZXJpYWxpemVyLmluZGV4KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgYnl0ZUNvdW50OyArK2lkeCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcnMudTguZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGEuY2hhckNvZGVBdChpZHgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VyaWFsaXplci5pbmRleCA8IHNlcmlhbGl6ZXIuZGF0YVZpZXcuYnl0ZUxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcnMudTguZW5jb2RlKHNlcmlhbGl6ZXIsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSAnJztcclxuICAgICAgICAgICAgdmFyIGJ5dGVDb3VudCA9IHNlcmlhbGl6ZXIuZGF0YVZpZXcuYnl0ZUxlbmd0aCAtIHNlcmlhbGl6ZXIuaW5kZXg7XHJcbiAgICAgICAgICAgIHdoaWxlIChieXRlQ291bnQtLSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFyQ29kZSA9IGhhbmRsZXJzLnU4LmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIGlmICghY2hhckNvZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJDb2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICBoYW5kbGVycy5zLmlzQmFzaWMgPSB0cnVlO1xyXG5cclxuICAgIGhhbmRsZXJzLmFycmF5VW5tYXNrZWQgPSBmdW5jdGlvbiAobGVuZ3RoLCBoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyArK2lkeCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVzdWx0ID0gaGFuZGxlcnMudHVwbGVVbm1hc2tlZChjaGlsZHJlbik7XHJcbiAgICAgICAgcmVzdWx0LmRlc2NyaXB0b3IgPSAnWycgKyBoYW5kbGVyLmRlc2NyaXB0b3IgKyAnOicgKyBsZW5ndGggKyAnXSc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudHVwbGVVbm1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbaWR4XSwgbWFza3MgJiYgbWFza3NbaWR4XSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5lbXB0eSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBmdWxsTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG5vbk51bGxDaGlsZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBub25OdWxsQ2hpbGQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIW5vbk51bGxDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJygnICsgY2hpbGREZXNjcmlwdG9ycy5qb2luKCcsJykgKyAnKSc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyKGRlc2NyaXB0b3IsIGJ5dGVDb3VudCwgZW1wdHksIGVuY29kZSwgZGVjb2RlLCBmdWxsTWFzayk7XHJcbiAgICB9O1xyXG5cclxuICAgIGhhbmRsZXJzLmFycmF5TWFza2VkID0gZnVuY3Rpb24gKGxlbmd0aCwgaGFuZGxlciwgbWFza0JpdENvdW50KSB7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyArK2lkeCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVzdWx0ID0gaGFuZGxlcnMudHVwbGVNYXNrZWQoY2hpbGRyZW4sIG1hc2tCaXRDb3VudCk7XHJcbiAgICAgICAgdmFyIG1hc2tTaXplID0gKHJlc3VsdC5ieXRlQ291bnQgLSAobGVuZ3RoICogaGFuZGxlci5ieXRlQ291bnQpKSAqIDg7XHJcbiAgICAgICAgcmVzdWx0LmRlc2NyaXB0b3IgPSAnWy8nICsgbWFza1NpemUgKyAnLycgKyBoYW5kbGVyLmRlc2NyaXB0b3IgKyAnOicgKyBsZW5ndGggKyAnXSc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMudHVwbGVNYXNrZWQgPSBmdW5jdGlvbiAoY2hpbGRyZW4sIG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgIHZhciBtYXNrQnl0ZXMgPSBNYXRoLmNlaWwoY2hpbGRyZW4ubGVuZ3RoIC8gOCk7XHJcbiAgICAgICAgaWYgKG1hc2tCaXRDb3VudCkge1xyXG4gICAgICAgICAgICBtYXNrQnl0ZXMgPSBNYXRoLm1heChtYXNrQnl0ZXMsIE1hdGguY2VpbChtYXNrQml0Q291bnQgLyA4KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXNrSGFuZGxlciA9IGhhbmRsZXJzLmFycmF5VW5tYXNrZWQobWFza0J5dGVzLCBoYW5kbGVycy51OCk7XHJcbiAgICAgICAgdmFyIG1hc2tBcnJheSA9IGZ1bmN0aW9uIChkYXRhLCBtYXNrcykge1xyXG4gICAgICAgICAgICBpZiAobWFza3MgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIG1hc2tzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbWFzayA9IHplcm9BcnJheShtYXNrQnl0ZXMpO1xyXG4gICAgICAgICAgICB2YXIgZXh0cmFNYXNrID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKG1hc2tzICYmICgnTUFTSycgaW4gbWFza3MpKSB7XHJcbiAgICAgICAgICAgICAgICBleHRyYU1hc2sgPSBtYXNrcy5NQVNLO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKF8sIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtpZHhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4dHJhTWFzayAmJiAhZXh0cmFNYXNrW2lkeF0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gfD0gMSA8PCAoaWR4ICUgOCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hc2s7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0FycmF5KGRhdGEsIG1hc2tzKTtcclxuXHJcbiAgICAgICAgICAgIG1hc2tIYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBtYXNrKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbaWR4XSwgbWFza3MgJiYgbWFza3NbaWR4XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0hhbmRsZXIuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCwgaWR4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQml0KG1hc2ssIGlkeCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVjb2RlKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpZHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNoaWxkLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbaWR4XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzdWx0Lk1BU0sgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IGNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bSArIGNoaWxkLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCBtYXNrQnl0ZXMpO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQuZGVzY3JpcHRvcjtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9ICcoLycgKyAobWFza0J5dGVzICogOCkgKyAnLycgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICcpJztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrLCBtYXNrQXJyYXkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBoYW5kbGVycy5tYXBVbm1hc2tlZCA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xyXG4gICAgICAgIHZhciBlbmNvZGUgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmhhbmRsZXIuZW5jb2RlKHNlcmlhbGl6ZXIsIGRhdGFbY2hpbGQua2V5XSwgbWFza3MgJiYgbWFza3NbY2hpbGQua2V5XSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRlY29kZSA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtjaGlsZC5rZXldID0gY2hpbGQuaGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IGNoaWxkLmhhbmRsZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZnVsbE1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBub25OdWxsQ2hpbGQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gY2hpbGQuaGFuZGxlci5mdWxsTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9uTnVsbENoaWxkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKCFub25OdWxsQ2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gY2hpbGRyZW4ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY2hpbGQuaGFuZGxlci5ieXRlQ291bnQ7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgdmFyIGNoaWxkRGVzY3JpcHRvcnMgPSBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZC5rZXkgKyAnOicgKyBjaGlsZC5oYW5kbGVyLmRlc2NyaXB0b3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSAneycgKyBjaGlsZERlc2NyaXB0b3JzLmpvaW4oJywnKSArICd9JztcclxuICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXIoZGVzY3JpcHRvciwgYnl0ZUNvdW50LCBlbXB0eSwgZW5jb2RlLCBkZWNvZGUsIGZ1bGxNYXNrKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnMubWFwTWFza2VkID0gZnVuY3Rpb24gKGNoaWxkcmVuLCBtYXNrQml0Q291bnQpIHtcclxuICAgICAgICB2YXIgbWFza0J5dGVzID0gTWF0aC5jZWlsKGNoaWxkcmVuLmxlbmd0aCAvIDgpO1xyXG4gICAgICAgIGlmIChtYXNrQml0Q291bnQpIHtcclxuICAgICAgICAgICAgbWFza0J5dGVzID0gTWF0aC5tYXgobWFza0J5dGVzLCBNYXRoLmNlaWwobWFza0JpdENvdW50IC8gOCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWFza0hhbmRsZXIgPSBoYW5kbGVycy5hcnJheVVubWFza2VkKG1hc2tCeXRlcywgaGFuZGxlcnMudTgpO1xyXG4gICAgICAgIHZhciBtYXNrQXJyYXkgPSBmdW5jdGlvbiAoZGF0YSwgbWFza3MpIHtcclxuICAgICAgICAgICAgaWYgKG1hc2tzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXNrcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1hc2sgPSB6ZXJvQXJyYXkobWFza0J5dGVzKTtcclxuICAgICAgICAgICAgdmFyIGV4dHJhTWFzayA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChtYXNrcyAmJiAoJ01BU0snIGluIG1hc2tzKSkge1xyXG4gICAgICAgICAgICAgICAgZXh0cmFNYXNrID0gbWFza3MuTUFTSztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtjaGlsZC5rZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4dHJhTWFzayAmJiAhZXh0cmFNYXNrW2NoaWxkLmtleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hc2tbTWF0aC5mbG9vcihpZHggLyA4KV0gfD0gMSA8PCAoaWR4ICUgOCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hc2s7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIsIGRhdGEsIG1hc2tzKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0FycmF5KGRhdGEsIG1hc2tzKTtcclxuXHJcbiAgICAgICAgICAgIG1hc2tIYW5kbGVyLmVuY29kZShzZXJpYWxpemVyLCBtYXNrKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuaGFuZGxlci5lbmNvZGUoc2VyaWFsaXplciwgZGF0YVtjaGlsZC5rZXldLCBtYXNrcyAmJiBtYXNrc1tjaGlsZC5rZXldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAgICAgdmFyIG1hc2sgPSBtYXNrSGFuZGxlci5kZWNvZGUoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0JpdChtYXNrLCBpZHgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmRlY29kZShzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2NoaWxkLmtleV0gPSBjaGlsZC5oYW5kbGVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIHZhciBtYXNrID0ge307XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBjaGlsZC5oYW5kbGVyLmZ1bGxNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbY2hpbGQua2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbWFza1tjaGlsZC5rZXldID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5NQVNLID0gbWFzaztcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSBjaGlsZHJlbi5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW0gKyBjaGlsZC5oYW5kbGVyLmJ5dGVDb3VudDtcclxuICAgICAgICB9LCBtYXNrQnl0ZXMpO1xyXG4gICAgICAgIHZhciBjaGlsZERlc2NyaXB0b3JzID0gY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGQua2V5ICsgJzonICsgY2hpbGQuaGFuZGxlci5kZXNjcmlwdG9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gJ3svJyArIChtYXNrQnl0ZXMgKiA4KSArICcvJyArIGNoaWxkRGVzY3JpcHRvcnMuam9pbignLCcpICsgJ30nO1xyXG4gICAgICAgIHJldHVybiBuZXcgSGFuZGxlcihkZXNjcmlwdG9yLCBieXRlQ291bnQsIGVtcHR5LCBlbmNvZGUsIGRlY29kZSwgZnVsbE1hc2ssIG1hc2tBcnJheSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uX2hhbmRsZXJzID0gaGFuZGxlcnM7XHJcblxyXG59KHRoaXMpKTtcclxuIiwiKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBmdW5jdGlvbiBTdHJpbmdUb2tlbihwb3NpdGlvbiwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBudW1lcmljVGVzdCA9IC9eXFxkKyQvO1xyXG4gICAgdmFyIG5hbWVUZXN0ID0gL15cXHcrJC87XHJcblxyXG4gICAgdmFyIFRva2VuQ2F0ZWdvcmllcyA9IHtcclxuICAgICAgICBTWU1CT0w6IDAsXHJcbiAgICAgICAgTlVNQkVSOiAxLFxyXG4gICAgICAgIE5BTUU6IDIsXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFRva2VuKHN0cmluZ1Rva2VuKSB7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHN0cmluZ1Rva2VuLnBvc2l0aW9uO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSBzdHJpbmdUb2tlbi52YWx1ZTtcclxuICAgICAgICBpZiAobnVtZXJpY1Rlc3QudGVzdCh0aGlzLnZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUjtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHBhcnNlSW50KHRoaXMudmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmFtZVRlc3QudGVzdCh0aGlzLnZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhdGVnb3J5ID0gVG9rZW5DYXRlZ29yaWVzLk5BTUU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IFRva2VuQ2F0ZWdvcmllcy5TWU1CT0w7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciB2YWxpZENoYXJTZXRUZXN0ID0gL15be31cXFtcXF0oKVxcLz06LDtcXHdcXHNdKiQvO1xyXG5cclxuICAgIHZhciBpc1ZhbGlkID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICByZXR1cm4gdmFsaWRDaGFyU2V0VGVzdC50ZXN0KHRleHQpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdG9rZW5pemVyID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICBpZiAoIWlzVmFsaWQodGV4dCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXNzZWQgY29uZmlnIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmUgPSAvKFt7fVxcW1xcXSgpXFwvPTosO118XFx3KykvZztcclxuICAgICAgICB2YXIgbWF0Y2g7XHJcbiAgICAgICAgdmFyIG1hdGNoZXMgPSBbXTtcclxuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmUuZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKG5ldyBTdHJpbmdUb2tlbihtYXRjaC5pbmRleCwgbWF0Y2hbMF0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoZXM7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBsZXhlciA9IGZ1bmN0aW9uICh0b2tlbnMpIHtcclxuICAgICAgICByZXR1cm4gdG9rZW5zLm1hcChmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUb2tlbih0b2tlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBUeXBlQ2F0ZWdvcmllcyA9IHtcclxuICAgICAgICBOQU1FRDogMCxcclxuICAgICAgICBNQVBfVU5NQVNLRUQ6IDIsXHJcbiAgICAgICAgTUFQX01BU0tFRDogMyxcclxuICAgICAgICBUVVBMRV9VTk1BU0tFRDogNCxcclxuICAgICAgICBUVVBMRV9NQVNLRUQ6IDUsXHJcbiAgICAgICAgQVJSQVlfVU5NQVNLRUQ6IDYsXHJcbiAgICAgICAgQVJSQVlfTUFTS0VEOiA3LFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBUeXBlKGNhdGVnb3J5LCBwcm9wZXJ0aWVzLCBtYXNrKSB7XHJcbiAgICAgICAgdGhpcy5jYXRlZ29yeSA9IGNhdGVnb3J5O1xyXG4gICAgICAgIHRoaXMucHJvcGVydGllcyA9IHByb3BlcnRpZXM7XHJcbiAgICAgICAgdGhpcy5tYXNrID0gbWFzayB8fCAwO1xyXG4gICAgfVxyXG5cclxuICAgIFR5cGUucHJvdG90eXBlLmdlbmVyYXRlSGFuZGxlciA9IGZ1bmN0aW9uIChsaWJyYXJ5KSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uLl9oYW5kbGVycztcclxuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BlcnRpZXM7XHJcbiAgICAgICAgdmFyIG1hc2sgPSB0aGlzLm1hc2s7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbjtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuY2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5OQU1FRDpcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wcyBpbiBoYW5kbGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBoYW5kbGVyc1twcm9wc107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYW5kbGVyLmlzQmFzaWMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wc1swXSA9PT0gJ3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHByb3BzLnN1YnN0cmluZygxKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobnVtZXJpY1Rlc3QudGVzdChsZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIgPSBoYW5kbGVycy5zdHJpbmcocGFyc2VJbnQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wcyBpbiBsaWJyYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IGxpYnJhcnlbcHJvcHNdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFoYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5yZWNvZ25pemVkIHR5cGUgXCInICsgcHJvcHMgKyAnXCInLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcjtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5NQVBfVU5NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IGNoaWxkLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXI6IGNoaWxkLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMubWFwVW5tYXNrZWQoY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLk1BUF9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IGNoaWxkLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXI6IGNoaWxkLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMubWFwTWFza2VkKGNoaWxkcmVuLCBtYXNrKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5UVVBMRV9VTk1BU0tFRDpcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVycy50dXBsZVVubWFza2VkKGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgY2FzZSBUeXBlQ2F0ZWdvcmllcy5UVVBMRV9NQVNLRUQ6XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHByb3BzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuZ2VuZXJhdGVIYW5kbGVyKGxpYnJhcnkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnMudHVwbGVNYXNrZWQoY2hpbGRyZW4sIG1hc2spO1xyXG4gICAgICAgICAgICBjYXNlIFR5cGVDYXRlZ29yaWVzLkFSUkFZX1VOTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLmFycmF5VW5tYXNrZWQocHJvcHMuY291bnQsIHByb3BzLnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KSk7XHJcbiAgICAgICAgICAgIGNhc2UgVHlwZUNhdGVnb3JpZXMuQVJSQVlfTUFTS0VEOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzLmFycmF5TWFza2VkKHByb3BzLmNvdW50LCBwcm9wcy52YWx1ZS5nZW5lcmF0ZUhhbmRsZXIobGlicmFyeSksIG1hc2spO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1VucmVjb2duaXplZCB0eXBlIGNhdGVnb3J5JyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcmVhZFRva2VuID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSBzZXJpYWxpemVyLmRhdGFWaWV3W3NlcmlhbGl6ZXIuaW5kZXhdO1xyXG4gICAgICAgIHNlcmlhbGl6ZXIuYWRkKDEpO1xyXG4gICAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIGVuZCBvZiBzdHJpbmcnLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBuYW1lUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZWFkVG9rZW4oc2VyaWFsaXplcik7XHJcbiAgICAgICAgaWYgKHRva2VuLmNhdGVnb3J5ICE9PSBUb2tlbkNhdGVnb3JpZXMuTkFNRSkge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIG5hbWUsIGdvdDogXCInICsgdG9rZW4udmFsdWUgKyAnXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICdNQVNLJykge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Rpc2FsbG93ZWQgbmFtZSBcIk1BU0tcIiBnaXZlbicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbi52YWx1ZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG51bWJlclBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSAhPT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIG51bWJlciwgZ290OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlbi52YWx1ZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNvbnN1bWVTeW1ib2wgPSBmdW5jdGlvbiAoc2VyaWFsaXplciwgc3ltYm9sKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gc3ltYm9sKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCInICsgc3ltYm9sICsgJ1wiLCBnb3Q6IFwiJyArIHRva2VuLnZhbHVlICsgJ1wiJyxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBtYXNrUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyBcIi8vXCIgb3IgXCIvPE5VTUJFUj4vXCIsIG90aGVyd2lzZSB0aGVyZSBpcyBubyBtYXNrXHJcbiAgICAgICAgLy8gTGFiZWxlZCB3aXRoIDxNQVNLPiBpbiBjb21tZW50cyBiZWxvd1xyXG4gICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgIT09ICcvJykge1xyXG4gICAgICAgICAgICBzZXJpYWxpemVyLmFkZCgtMSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXNrZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcvJykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbWFza2VkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZGVmaW5lZDogZmFsc2UsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSAhPT0gVG9rZW5DYXRlZ29yaWVzLk5VTUJFUikge1xyXG4gICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIFwiL1wiIG9yIG51bWJlcicsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRva2VuLnZhbHVlO1xyXG4gICAgICAgIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgIGVycm9yOiAnRXhwZWN0ZWQgXCIvXCInLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtYXNrZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGRlZmluZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZU1hcFBhcnNlciA9IGZ1bmN0aW9uIChzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgLy8gezxNQVNLPiA8TkFNRT46PFRZUEU+LCA8TkFNRT46PFRZUEU+LCA8TkFNRT46PFRZUEU+fVxyXG4gICAgICAgIHZhciBtYXNrID0gbWFza1BhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJzonKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICd9Jykge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hc2suZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTUFQX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5NQVBfTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFR5cGUoVHlwZUNhdGVnb3JpZXMuTUFQX1VOTUFTS0VELCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlICE9PSAnLCcpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdG9rZW4ucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIGFmdGVyIG1hcCBlbGVtZW50OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZVR1cGxlUGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyAoPE1BU0s+IDxUWVBFPiwgPFRZUEU+LCA8VFlQRT4pXHJcbiAgICAgICAgdmFyIG1hc2sgPSBtYXNrUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godHlwZVBhcnNlcihzZXJpYWxpemVyKSk7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgaWYgKHRva2VuLnZhbHVlID09PSAnKScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtYXNrLm1hc2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXNrLmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLlRVUExFX01BU0tFRCwgY2hpbGRyZW4sIG1hc2sudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5UVVBMRV9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5UVVBMRV9VTk1BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gJywnKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnVW5leHBlY3RlZCB0b2tlbiBhZnRlciB0dXBsZSBlbGVtZW50OiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHlwZUFycmF5UGFyc2VyID0gZnVuY3Rpb24gKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICAvLyBbPE1BU0s+IDxUWVBFPjo8TlVNQkVSPl1cclxuICAgICAgICB2YXIgbWFzayA9IG1hc2tQYXJzZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICBjb25zdW1lU3ltYm9sKHNlcmlhbGl6ZXIsICc6Jyk7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gbnVtYmVyUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJ10nKTtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgY291bnQ6IGNvdW50LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG1hc2subWFza2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrLmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQsIGNoaWxkcmVuLCBtYXNrLnZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9NQVNLRUQsIGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHlwZShUeXBlQ2F0ZWdvcmllcy5BUlJBWV9VTk1BU0tFRCwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHR5cGVQYXJzZXIgPSBmdW5jdGlvbiAoc2VyaWFsaXplcikge1xyXG4gICAgICAgIC8vIE9wdGlvbnM6XHJcbiAgICAgICAgLy8gLSA8TkFNRT5cclxuICAgICAgICAvLyAtIFR1cGxlXHJcbiAgICAgICAgLy8gLSBBcnJheVxyXG4gICAgICAgIC8vIC0gTWFwXHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVhZFRva2VuKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IC0xLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIGVuZCBvZiBzdHJpbmcnLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4uY2F0ZWdvcnkgPT09IFRva2VuQ2F0ZWdvcmllcy5OVU1CRVIpIHtcclxuICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHRva2VuLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIG51bWJlciwgdHlwZSBleHBlY3RlZCcsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi5jYXRlZ29yeSA9PT0gVG9rZW5DYXRlZ29yaWVzLk5BTUUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUeXBlKFR5cGVDYXRlZ29yaWVzLk5BTUVELCB0b2tlbi52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0b2tlbi52YWx1ZSA9PT0gJ3snKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlTWFwUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICdbJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZUFycmF5UGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9rZW4udmFsdWUgPT09ICcoJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZVR1cGxlUGFyc2VyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiB0b2tlbi5wb3NpdGlvbixcclxuICAgICAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHRva2VuIHdoZW4gZGVzY3JpYmluZyB0eXBlOiBcIicgKyB0b2tlbi52YWx1ZSArICdcIicsXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBhcnNlciA9IGZ1bmN0aW9uICh0b2tlbnMsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBzZXJpYWxpemVyID0gbmV3IGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5TZXJpYWxpemVyKHRva2Vucyk7XHJcbiAgICAgICAgdmFyIHN0cnVjdHVyZXMgPSBbXTtcclxuICAgICAgICB3aGlsZSAoc2VyaWFsaXplci5pbmRleCA8IHNlcmlhbGl6ZXIuZGF0YVZpZXcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmFtZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgaWYgKG5hbWVbMF0gIT09IG5hbWVbMF0udG9VcHBlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1N0cnVjdHVyZSBuYW1lcyBjYW5ub3Qgc3RhcnQgd2l0aCBsb3dlcmNhc2UgbGV0dGVycycsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN1bWVTeW1ib2woc2VyaWFsaXplciwgJz0nKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdHlwZVBhcnNlcihzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgY29uc3VtZVN5bWJvbChzZXJpYWxpemVyLCAnOycpO1xyXG4gICAgICAgICAgICBzdHJ1Y3R1cmVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHJ1Y3R1cmVzO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlSGFuZGxlcnMgPSBmdW5jdGlvbiAoc3RydWN0dXJlKSB7XHJcbiAgICAgICAgdmFyIGxpYnJhcnkgPSB7fTtcclxuICAgICAgICBzdHJ1Y3R1cmUuZm9yRWFjaChmdW5jdGlvbiAoZW50cnkpIHtcclxuICAgICAgICAgICAgbGlicmFyeVtlbnRyeS5uYW1lXSA9IGVudHJ5LnZhbHVlLmdlbmVyYXRlSGFuZGxlcihsaWJyYXJ5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlicmFyeTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBhcnNlID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSGFuZGxlcnMocGFyc2VyKGxleGVyKHRva2VuaXplcih0ZXh0KSwgdGV4dCksIHRleHQpKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVyci5lcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoIWdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbikge1xyXG4gICAgICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbiA9IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5fcGFyc2VyU3RlcHMgPSB7XHJcbiAgICAgICAgdG9rZW5pemVyOiB0b2tlbml6ZXIsXHJcbiAgICAgICAgbGV4ZXI6IGxleGVyLFxyXG4gICAgICAgIHBhcnNlcjogcGFyc2VyLFxyXG4gICAgICAgIFRva2VuQ2F0ZWdvcmllczogVG9rZW5DYXRlZ29yaWVzLFxyXG4gICAgICAgIFR5cGVDYXRlZ29yaWVzOiBUeXBlQ2F0ZWdvcmllcyxcclxuICAgICAgICBTdHJpbmdUb2tlbjogU3RyaW5nVG9rZW4sXHJcbiAgICAgICAgVG9rZW46IFRva2VuLFxyXG4gICAgICAgIFR5cGU6IFR5cGUsXHJcbiAgICB9O1xyXG5cclxuICAgIGdsb2JhbC5GbHlicml4U2VyaWFsaXphdGlvbi5wYXJzZSA9IHBhcnNlO1xyXG5cclxufSh0aGlzKSk7XHJcbiIsIihmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgZnVuY3Rpb24gU2VyaWFsaXplcihkYXRhVmlldykge1xyXG4gICAgICAgIHRoaXMuaW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuZGF0YVZpZXcgPSBkYXRhVmlldztcclxuICAgIH1cclxuXHJcbiAgICBTZXJpYWxpemVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoaW5jcmVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5pbmRleCArPSBpbmNyZW1lbnQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uKSB7XHJcbiAgICAgICAgZ2xvYmFsLkZseWJyaXhTZXJpYWxpemF0aW9uID0ge307XHJcbiAgICB9XHJcbiAgICBnbG9iYWwuRmx5YnJpeFNlcmlhbGl6YXRpb24uU2VyaWFsaXplciA9IFNlcmlhbGl6ZXI7XHJcblxyXG59KHRoaXMpKTtcclxuIl19
